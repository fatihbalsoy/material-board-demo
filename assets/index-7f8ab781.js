(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var As=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},W=(e,t,r)=>(As(e,t,"read from private field"),r?r.call(e):t.get(e)),te=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},fe=(e,t,r,s)=>(As(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),$e=(e,t,r)=>(As(e,t,"access private method"),r);if(typeof File>"u"){class e extends Blob{constructor(r,s,n){super(r);let o;n!=null&&n.lastModified&&(o=new Date),(!o||isNaN(o.getFullYear()))&&(o=new Date),this.lastModifiedDate=o,this.lastModified=o.getMilliseconds(),this.name=s||""}}global.File=e}function Eo(e){return new Promise(function(t,r){e.onload=e.onerror=function(s){e.onload=e.onerror=null,s.type==="load"?t(e.result):r(new Error("Failed to read the blob/file"))}})}typeof Blob.prototype.arrayBuffer>"u"&&(Blob.prototype.arrayBuffer=function(){const e=new FileReader;return e.readAsArrayBuffer(this),Eo(e)});typeof Blob.prototype.text>"u"&&(Blob.prototype.text=function(){const e=new FileReader;return e.readAsText(this),Eo(e)});function ea(){const e=new Uint8Array([1,2,3,4]),t=new File([e],"test").stream();try{return t.getReader({mode:"byob"}),t.getReader({mode:"byob"}),!0}catch{return!1}}(typeof Blob.prototype.stream>"u"||!ea())&&(Blob.prototype.stream=function(){let e=0;const t=this;return new ReadableStream({type:"bytes",autoAllocateChunkSize:512*1024,async pull(r){const s=r.byobRequest.view,n=await t.slice(e,e+s.byteLength).arrayBuffer(),o=new Uint8Array(n);new Uint8Array(s.buffer).set(o);const i=o.byteLength;r.byobRequest.respond(i),e+=i,e>=t.size&&r.close()}})});if(typeof CustomEvent>"u"){class e extends Event{constructor(r,s={}){super(r,s),this.detail=s.detail}initCustomEvent(){}}globalThis.CustomEvent=e}const Un=`<?php

function zipDir($root, $output, $options = array())
{
    $root = rtrim($root, '/');
    $additionalPaths = array_key_exists('additional_paths', $options) ? $options['additional_paths'] : array();
    $excludePaths = array_key_exists('exclude_paths', $options) ? $options['exclude_paths'] : array();
    $zip_root = array_key_exists('zip_root', $options) ? $options['zip_root'] : $root;

    $zip = new ZipArchive;
    $res = $zip->open($output, ZipArchive::CREATE);
    if ($res === TRUE) {
        $directories = array(
            $root . '/'
        );
        while (sizeof($directories)) {
            $current_dir = array_pop($directories);

            if ($handle = opendir($current_dir)) {
                while (false !== ($entry = readdir($handle))) {
                    if ($entry == '.' || $entry == '..') {
                        continue;
                    }

                    $entry = join_paths($current_dir, $entry);
                    if (in_array($entry, $excludePaths)) {
                        continue;
                    }

                    if (is_dir($entry)) {
                        $directory_path = $entry . '/';
                        array_push($directories, $directory_path);
                    } else if (is_file($entry)) {
                        $zip->addFile($entry, substr($entry, strlen($zip_root)));
                    }
                }
                closedir($handle);
            }
        }
        foreach ($additionalPaths as $disk_path => $zip_path) {
            $zip->addFile($disk_path, $zip_path);
        }
        $zip->close();
        chmod($output, 0777);
    }
}

function join_paths()
{
    $paths = array();

    foreach (func_get_args() as $arg) {
        if ($arg !== '') {
            $paths[] = $arg;
        }
    }

    return preg_replace('#/+#', '/', join('/', $paths));
}

function unzip($zipPath, $extractTo, $overwrite = true)
{
    if (!is_dir($extractTo)) {
        mkdir($extractTo, 0777, true);
    }
    $zip = new ZipArchive;
    $res = $zip->open($zipPath);
    if ($res === TRUE) {
        $zip->extractTo($extractTo);
        $zip->close();
        chmod($extractTo, 0777);
    }
}


function delTree($dir)
{
    $files = array_diff(scandir($dir), array('.', '..'));
    foreach ($files as $file) {
        (is_dir("$dir/$file")) ? delTree("$dir/$file") : unlink("$dir/$file");
    }
    return rmdir($dir);
}
`,So=["db.php","plugins/akismet","plugins/hello.php","plugins/wordpress-importer","plugins/sqlite-database-integration","mu-plugins/playground-includes","mu-plugins/export-wxz.php","mu-plugins/0-playground.php","themes/twentytwenty","themes/twentytwentyone","themes/twentytwentytwo","themes/twentytwentythree","themes/twentytwentyfour","themes/twentytwentyfive","themes/twentytwentysix"];function Qr(e){const t=e.split(".").shift().replace(/-/g," ");return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}async function rr(e,t,r){let s="";await e.fileExists(t)&&(s=await e.readFileAsText(t)),await e.writeFile(t,r(s))}async function ta(e){return new Uint8Array(await e.arrayBuffer())}async function ko(e,t){const r=await e.run({code:Un+t});if(r.exitCode!==0)throw console.log(Un+t),console.log(t+""),console.log(r.errors),r.errors;return r}const To=async(e,{pluginPath:t,pluginName:r},s)=>{s==null||s.tracker.setCaption(`Activating ${r||t}`);const n=[`${await e.documentRoot}/wp-load.php`,`${await e.documentRoot}/wp-admin/includes/plugin.php`];if(!n.every(o=>e.fileExists(o)))throw new Error(`Required WordPress files do not exist: ${n.join(", ")}`);if((await e.run({code:`<?php
define( 'WP_ADMIN', true );
${n.map(o=>`require_once( '${o}' );`).join(`
`)}
$plugin_path = '${t}';
if (!is_dir($plugin_path)) {
	activate_plugin($plugin_path);
	return;
}
// Find plugin entry file
foreach ( ( glob( $plugin_path . '/*.php' ) ?: array() ) as $file ) {
	$info = get_plugin_data( $file, false, false );
	if ( ! empty( $info['Name'] ) ) {
		activate_plugin( $file );
		return;
	}
}
echo 'NO_ENTRY_FILE';
`})).text.endsWith("NO_ENTRY_FILE"))throw new Error("Could not find plugin entry file.")},xo=async(e,{themeFolderName:t},r)=>{r==null||r.tracker.setCaption(`Activating ${t}`);const s=`${await e.documentRoot}/wp-load.php`;if(!e.fileExists(s))throw new Error(`Required WordPress file does not exist: ${s}`);await e.run({code:`<?php
define( 'WP_ADMIN', true );
require_once( '${s}' );
switch_theme( '${t}' );
`})},ir=async(e,{consts:t})=>{for(const r in t)await e.defineConstant(r,t[r])},ra=`<?php

/**
 * This transport delegates PHP HTTP requests to JavaScript synchronous XHR.
 *
 * This file isn't actually used. It's just here for reference and development. The actual
 * PHP code used in WordPress is hardcoded copy residing in wordpress.mjs in the _patchWordPressCode
 * function.
 * 
 * The reason for calling it Wp_Http_Fetch and not something more natural like
 * Requests_Transport_Fetch is the _get_first_available_transport(). It checks for
 * a class named "Wp_Http_" . $transport_name â€“ which means we must adhere to this
 * hardcoded pattern.
 */
class Wp_Http_Fetch implements Requests_Transport
{
	public $headers = '';

	public function __construct()
	{
	}

	public function __destruct()
	{
	}

	/**
	 * Delegates PHP HTTP requests to JavaScript synchronous XHR.
	 *
	 * @TODO Implement handling for more $options such as cookies, filename, auth, etc.
	 *
	 * @param $url
	 * @param $headers
	 * @param $data
	 * @param $options
	 *
	 * @return false|string
	 */
	public function request($url, $headers = array(), $data = array(), $options = array())
	{
		// Disable wp-cron requests that are extremely slow in node.js runtime environment.
		// @TODO: Make wp-cron requests faster.
		if (str_contains($url, '/wp-cron.php')) {
			return false;
		}

		if (!empty($data)) {
			$data_format = $options['data_format'];
			if ($data_format === 'query') {
				$url  = self::format_get($url, $data);
				$data = '';
			} elseif (!is_string($data)) {
				$data = http_build_query($data, null, '&');
			}
		}

		$request = json_encode(array(
			'type'    => 'request',
			'data'    => [
				'headers' => $headers,
				'data'    => $data,
				'url'     => $url,
				'method'  => $options['type'],
			]
		));

		$this->headers = post_message_to_js($request);

		// Store a file if the request specifies it.
		// Are we sure that \`$this->headers\` includes the body of the response?
		$before_response_body = strpos( $this->headers, "\\r\\n\\r\\n" );
		if ( isset( $options['filename'] ) && $options['filename'] && false !== $before_response_body ) {
			$response_body = substr( $this->headers, $before_response_body + 4 );
			file_put_contents($options['filename'], $response_body);
		}

		return $this->headers;
	}

	public function request_multiple($requests, $options)
	{
		$responses = array();
		$class     = get_class($this);
		foreach ($requests as $id => $request) {
			try {
				$handler          = new $class();
				$responses[$id] = $handler->request($request['url'], $request['headers'], $request['data'], $request['options']);
				$request['options']['hooks']->dispatch('transport.internal.parse_response', array(&$responses[$id], $request));
			} catch (Requests_Exception $e) {
				$responses[$id] = $e;
			}
			if (!is_string($responses[$id])) {
				$request['options']['hooks']->dispatch('multiple.request.complete', array(&$responses[$id], $id));
			}
		}

		return $responses;
	}

	protected static function format_get($url, $data)
	{
		if (!empty($data)) {
			$query     = '';
			$url_parts = parse_url($url);
			if (empty($url_parts['query'])) {
				$url_parts['query'] = '';
			} else {
				$query = $url_parts['query'];
			}
			$query .= '&' . http_build_query($data, null, '&');
			$query = trim($query, '&');
			if (empty($url_parts['query'])) {
				$url .= '?' . $query;
			} else {
				$url = str_replace($url_parts['query'], $query, $url);
			}
		}

		return $url;
	}

	public static function test($capabilities = array())
	{
		if (!function_exists('post_message_to_js')) {
			return false;
		}

		return true;
	}
}
`,sa=`<?php

/**
 * This transport does not perform any HTTP requests and only exists
 * to prevent the Requests class from complaining about not having any
 * transports.
 */
class Requests_Transport_Dummy implements Requests_Transport
{
	public $headers = '';

	public function __construct()
	{
	}

	public function __destruct()
	{
	}

	public function request($url, $headers = array(), $data = array(), $options = array())
	{
		return false;
	}

	public function request_multiple($requests, $options)
	{
		$responses = array();
		foreach ($requests as $id => $request) {
			$responses[] = false;
		}
		return $responses;
	}

	protected static function format_get($url, $data)
	{
		return $url;
	}

	public static function test($capabilities = array())
	{
		return true;
	}
}
`,na=`<?php
/**
 * Add a notice to wp-login.php offering the username and password.
 */
add_action(
	'login_message',
	function () {
		return <<<EOT
<div class="message info">
	<strong>username:</strong> <code>admin</code><br><strong>password</strong>: <code>password</code>
</div>
EOT;
	}
);

/**
 * Because the in-browser Playground doesn't have access to the internet, 
 * network-dependent features like directories don't work. Normally, you'll 
 * see a confusing message like "An unexpected error occurred." This mu-plugin
 * makes it more clear that the feature is not yet supported.
 * 
 * https://github.com/WordPress/wordpress-playground/issues/498
 */
add_filter('plugins_api_result', function ($res) {
	if ($res instanceof WP_Error) {
		$res = new WP_Error(
			'plugins_api_failed',
			'Enable networking support in Playground settings to access the Plugins directory. Network access is an <a href="https://github.com/WordPress/wordpress-playground/issues/85">experimental, opt-in feature</a>. If you don\\'t want to use it, you can still upload plugins or install them using the <a href="https://wordpress.github.io/wordpress-playground/query-api">Query API</a> (e.g. ?plugin=coblocks).'
		);
	}
	return $res;
});

add_filter('gettext', function ($translation) {
	// There is no better hook for swapping the error message
	// on the themes page, unfortunately.
	global $pagenow;

	// Only change the message on /wp-admin/theme-install.php
	if ('theme-install.php' !== $pagenow) {
		return $translation;
	}

	if ($translation === 'An unexpected error occurred. Something may be wrong with WordPress.org or this server&#8217;s configuration. If you continue to have problems, please try the <a href="%s">support forums</a>.') {
		return 'Enable networking support in Playground settings to access the Themes directory. Network access is an <a href="https://github.com/WordPress/wordpress-playground/issues/85">experimental, opt-in feature</a>. If you don\\'t want to use it, you can still upload themes or install them using the <a href="https://wordpress.github.io/wordpress-playground/query-api">Query API</a> (e.g. ?theme=pendant).';
	}
	return $translation;
});



/**
 * Links with target="top" don't work in the playground iframe because of
 * the sandbox attribute. What they really should be targeting is the
 * playground iframe itself (name="playground"). This mu-plugin rewrites
 * all target="_top" links to target="playground" instead.
 * 
 * https://github.com/WordPress/wordpress-playground/issues/266
 */
add_action('admin_print_scripts', function () {
	?>
	<script>
		document.addEventListener('click', function (event) {
			if (event.target.tagName === 'A' && ['_parent', '_top'].includes(event.target.target)) {
				event.target.target = 'wordpress-playground';
			}
		});
	<\/script>
	<?php
});

/**
 * Supports URL rewriting to remove \`index.php\` from permalinks.
 */
add_filter('got_url_rewrite', '__return_true');

/**
 * The default WordPress requests transports have been disabled
 * at this point. However, the Requests class requires at least
 * one working transport or else it throws warnings and acts up.
 * 
 * This mu-plugin provides that transport. It's one of the two:
 * 
 * * WP_Http_Fetch â€“ Sends requests using browser's fetch() function.
 *                   Only enabled when PHP was compiled with the VRZNO
 * 					 extension.
 * * Requests_Transport_Dummy â€“ Does not send any requests and only exists to keep
 * 								the Requests class happy.
 */
if (defined('USE_FETCH_FOR_REQUESTS') && USE_FETCH_FOR_REQUESTS) {
	require(__DIR__ . '/playground-includes/wp_http_fetch.php');
	Requests::add_transport('WP_Http_Fetch');

	/**
	 * Add Fetch transport to the list of transports that WordPress
	 * will test for in the _get_first_available_transport() function.
	 */
	add_filter('http_api_transports', function ($transports) {
		$transports[] = 'Fetch';
		return $transports;
	});
	/**
	 * Disable signature verification as it doesn't seem to work with
	 * fetch requests:
	 * 
	 * https://downloads.wordpress.org/plugin/classic-editor.zip returns no signature header.
	 * https://downloads.wordpress.org/plugin/classic-editor.zip.sig returns 404.
	 * 
	 * @TODO Investigate why.
	 */
	add_filter('wp_signature_hosts', function ($hosts) {
		return [];
	});

	add_filter('http_request_host_is_external', function ($arg) {
		return true;
	});
} else {
	require(__DIR__ . '/playground-includes/requests_transport_dummy.php');
	Requests::add_transport('Requests_Transport_Dummy');
}
`,oa=async(e,t)=>{const r=new ia(e,t.wordpressPath||"/wordpress",t.siteUrl);t.addPhpInfo===!0&&await r.addPhpInfo(),t.siteUrl&&await r.patchSiteUrl(),t.patchSecrets===!0&&await r.patchSecrets(),t.disableSiteHealth===!0&&await r.disableSiteHealth(),t.disableWpNewBlogNotification===!0&&await r.disableWpNewBlogNotification(),t.makeEditorFrameControlled===!0&&await Ro(e,r.wordpressPath,[`${r.wordpressPath}/wp-includes/js/dist/block-editor.js`,`${r.wordpressPath}/wp-includes/js/dist/block-editor.min.js`]),t.prepareForRunningInsideWebBrowser===!0&&await r.prepareForRunningInsideWebBrowser(),t.addFetchNetworkTransport===!0&&await r.addFetchNetworkTransport()};class ia{constructor(t,r,s){this.php=t,this.scopedSiteUrl=s,this.wordpressPath=r}async addPhpInfo(){await this.php.writeFile(`${this.wordpressPath}/phpinfo.php`,"<?php phpinfo(); ")}async patchSiteUrl(){await ir(this.php,{consts:{WP_HOME:this.scopedSiteUrl,WP_SITEURL:this.scopedSiteUrl}})}async patchSecrets(){await ir(this.php,{consts:{AUTH_KEY:Qe(40),SECURE_AUTH_KEY:Qe(40),LOGGED_IN_KEY:Qe(40),NONCE_KEY:Qe(40),AUTH_SALT:Qe(40),SECURE_AUTH_SALT:Qe(40),LOGGED_IN_SALT:Qe(40),NONCE_SALT:Qe(40)}}),await rr(this.php,`${this.wordpressPath}/wp-config.php`,t=>t.replaceAll(/',\s+'put your unique phrase here'/g,"__', ''"))}async disableSiteHealth(){await rr(this.php,`${this.wordpressPath}/wp-includes/default-filters.php`,t=>t.replace(/add_filter[^;]+wp_maybe_grant_site_health_caps[^;]+;/i,""))}async disableWpNewBlogNotification(){await rr(this.php,`${this.wordpressPath}/wp-config.php`,t=>`${t} function wp_new_blog_notification(...$args){} `)}async prepareForRunningInsideWebBrowser(){await this.php.mkdir(`${this.wordpressPath}/wp-content/mu-plugins`),await this.php.writeFile(`${this.wordpressPath}/wp-content/mu-plugins/0-playground.php`,na),await this.php.mkdir(`${this.wordpressPath}/wp-content/mu-plugins/playground-includes`),await this.php.writeFile(`${this.wordpressPath}/wp-content/mu-plugins/playground-includes/requests_transport_dummy.php`,sa)}async addFetchNetworkTransport(){await ir(this.php,{consts:{USE_FETCH_FOR_REQUESTS:!0}});const t=[`${this.wordpressPath}/wp-includes/Requests/Transport/fsockopen.php`,`${this.wordpressPath}/wp-includes/Requests/Transport/cURL.php`,`${this.wordpressPath}/wp-includes/Requests/src/Transport/Fsockopen.php`,`${this.wordpressPath}/wp-includes/Requests/src/Transport/Curl.php`];for(const r of t)await this.php.fileExists(r)&&await rr(this.php,r,s=>s.includes("public static function test2")?s:s.replace("public static function test","public static function test( $capabilities = array() ) { return false; } public static function test2"));await this.php.writeFile(`${this.wordpressPath}/wp-content/mu-plugins/playground-includes/wp_http_fetch.php`,ra),await this.php.mkdir(`${this.wordpressPath}/wp-content/fonts`)}}function Qe(e){const t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+=-[]/.,<>?";let r="";for(let s=e;s>0;--s)r+=t[Math.floor(Math.random()*t.length)];return r}async function Ro(e,t,r){const s=`
	/**
	 * A synchronous function to read a blob URL as text.
	 *
	 * @param {string} url
	 * @returns {string}
	 */
	const __playground_readBlobAsText = function (url) {
		try {
		  let xhr = new XMLHttpRequest();
		  xhr.open('GET', url, false);
		  xhr.overrideMimeType('text/plain;charset=utf-8');
		  xhr.send();
		  return xhr.responseText;
		} catch(e) {
		  return '';
		} finally {
		  URL.revokeObjectURL(url);
		}
	}

	window.__playground_ControlledIframe = window.wp.element.forwardRef(function (props, ref) {
		const source = window.wp.element.useMemo(function () {
			if (props.srcDoc) {
				// WordPress <= 6.2 uses a srcDoc that only contains a doctype.
				return '/wp-includes/empty.html';
			} else if (props.src && props.src.startsWith('blob:')) {
				// WordPress 6.3 uses a blob URL with doctype and a list of static assets.
				// Let's pass the document content to empty.html and render it there.
				return '/wp-includes/empty.html#' + encodeURIComponent(__playground_readBlobAsText(props.src));
			} else {
				// WordPress >= 6.4 uses a plain HTTPS URL that needs no correction.
				return props.src;
			}
		}, [props.src]);
		return (
			window.wp.element.createElement('iframe', {
				...props,
				ref: ref,
				src: source,
				// Make sure there's no srcDoc, as it would interfere with the src.
				srcDoc: undefined
			})
		)
	});`;for(const n of r)await e.fileExists(n)&&await rr(e,n,o=>`${s} ${o.replace(/\(\s*"iframe",/,"(__playground_ControlledIframe,")}`);await e.writeFile(`${t}/wp-includes/empty.html`,"<!doctype html><script>const hash = window.location.hash.substring(1); if ( hash ) document.write(decodeURIComponent(hash))<\/script>")}const aa=async(e,{code:t})=>await e.run({code:t}),ca=async(e,{options:t})=>await e.run(t),jo=async(e,{path:t})=>{await e.unlink(t)};class Ds{constructor({concurrency:t}){this._running=0,this.concurrency=t,this.queue=[]}get running(){return this._running}async acquire(){for(;;)if(this._running>=this.concurrency)await new Promise(t=>this.queue.push(t));else{this._running++;let t=!1;return()=>{t||(t=!0,this._running--,this.queue.length>0&&this.queue.shift()())}}}async run(t){const r=await this.acquire();try{return await t()}finally{r()}}}function ve(...e){let t=e.join("/");const r=t[0]==="/",s=t.substring(t.length-1)==="/";return t=No(t),!t&&!r&&(t="."),t&&s&&(t+="/"),t}function la(e){if(e==="/")return"/";e=No(e);const t=e.lastIndexOf("/");return t===-1?"":t===0?"/":e.substr(0,t)}function No(e){const t=e[0]==="/";return e=pa(e.split("/").filter(r=>!!r),!t).join("/"),(t?"/":"")+e.replace(/\/$/,"")}function pa(e,t){let r=0;for(let s=e.length-1;s>=0;s--){const n=e[s];n==="."?e.splice(s,1):n===".."?(e.splice(s,1),r++):r&&(e.splice(s,1),r--)}if(t)for(;r;r--)e.unshift("..");return e}function gr(e){return`json_decode(base64_decode('${ua(JSON.stringify(e))}'), true)`}function Ms(e){const t={};for(const r in e)t[r]=gr(e[r]);return t}function ua(e){return da(new TextEncoder().encode(e))}function da(e){const t=String.fromCodePoint(...e);return btoa(t)}const ha=async(e,{sql:t},r)=>{r==null||r.tracker.setCaption("Executing SQL Queries");const s=`/tmp/${crypto.randomUUID()}.sql`;await e.writeFile(s,new Uint8Array(await t.arrayBuffer()));const n=await e.documentRoot,o=Ms({docroot:n,sqlFilename:s}),i=await e.run({code:`<?php
		require_once ${o.docroot} . '/wp-load.php';

		$handle = fopen(${o.sqlFilename}, 'r');
		$buffer = '';

		global $wpdb;

		while ($bytes = fgets($handle)) {
			$buffer .= $bytes;

			if (!feof($handle) && substr($buffer, -1, 1) !== "
") {
				continue;
			}

			$wpdb->query($buffer);
			$buffer = '';
		}
	`});return await jo(e,{path:s}),i},fa=async(e,{key:t,value:r})=>{await e.setPhpIniEntry(t,r)},ma=async(e,{request:t})=>await e.request(t),ya=async(e,{fromPath:t,toPath:r})=>{await e.writeFile(r,await e.readFileAsBuffer(t))},ga=async(e,{fromPath:t,toPath:r})=>{await e.mv(t,r)},wa=async(e,{path:t})=>{await e.mkdir(t)},va=async(e,{path:t})=>{await e.rmdir(t)},Co=async(e,{path:t,data:r})=>{r instanceof File&&(r=await ta(r)),await e.writeFile(t,r)},$a=async(e,{siteUrl:t})=>{await ir(e,{consts:{WP_HOME:t,WP_SITEURL:t}})},_a=async(e,{file:t})=>{var r;const s=await e.request({url:"/wp-admin/admin.php?import=wordpress"}),n=(r=Ln(s).getElementById("import-upload-form"))==null?void 0:r.getAttribute("action"),o=await e.request({url:`/wp-admin/${n}`,method:"POST",files:{import:t}}),i=Ln(o).querySelector("#wpbody-content form");if(!i)throw console.log(o.text),new Error("Could not find an importer form in response. See the response text above for details.");const p=ba(i);p.fetch_attachments="1";for(const h in p)if(h.startsWith("user_map[")){const l="user_new["+h.slice(9,-1)+"]";p[l]="1"}await e.request({url:i.action,method:"POST",formData:p})};function Ln(e){return new DOMParser().parseFromString(e.text,"text/html")}function ba(e){return Object.fromEntries(new FormData(e).entries())}const Fs=async(e,{zipPath:t,extractToPath:r})=>{const s=Ms({zipPath:t,extractToPath:r});await ko(e,`unzip(${s.zipPath}, ${s.extractToPath});`)},Pa=async(e,{wordPressFilesZip:t,pathInZip:r=""})=>{const s="/import.zip";await e.writeFile(s,new Uint8Array(await t.arrayBuffer()));const n=await e.documentRoot;let o=ve("/tmp","import");await e.mkdir(o),await Fs(e,{zipPath:s,extractToPath:o}),await e.unlink(s),o=ve(o,r);const i=ve(o,"wp-content"),p=ve(n,"wp-content");for(const y of So){const w=ve(i,y);await Wn(e,w);const x=ve(p,y);await e.fileExists(x)&&(await e.mkdir(la(w)),await e.mv(x,w))}const h=ve(o,"wp-content","database");await e.fileExists(h)||await e.mv(ve(n,"wp-content","database"),h);const l=await e.listFiles(o);for(const y of l)await Wn(e,ve(n,y)),await e.mv(ve(o,y),ve(n,y));await e.rmdir(o);const d=gr(ve(n,"wp-admin","upgrade.php"));await e.run({code:`<?php
            $_GET['step'] = 'upgrade_db';
            require ${d};
            `})};async function Wn(e,t){await e.fileExists(t)&&(await e.isDir(t)?await e.rmdir(t):await e.unlink(t))}async function Ea(e){const t=await e.request({url:"/wp-admin/export.php?download=true&content=all"});return new File([t.bytes],"export.xml")}async function Sa(e){const t=await e.request({url:"/wp-admin/export.php?download=true&content=all&export_wxz=1"});return new File([t.bytes],"export.wxz")}async function Oo(e,{targetPath:t,zipFile:r}){const s=r.name,n=s.replace(/\.zip$/,""),o=`/tmp/assets/${n}`,i=`/tmp/${s}`,p=()=>e.rmdir(o,{recursive:!0});await e.fileExists(o)&&await p(),await Co(e,{path:i,data:r});const h=()=>Promise.all([p,()=>e.unlink(i)]);try{await Fs(e,{zipPath:i,extractToPath:o});const l=await e.listFiles(o,{prependPath:!0}),d=l.length===1&&await e.isDir(l[0]);let y,w="";d?(w=l[0],y=l[0].split("/").pop()):(w=o,y=n);const x=`${t}/${y}`;return await e.mv(w,x),await h(),{assetFolderPath:x,assetFolderName:y}}catch(l){throw await h(),l}}const ka=async(e,{pluginZipFile:t,options:r={}},s)=>{const n=t.name.split("/").pop()||"plugin.zip",o=Qr(n);s==null||s.tracker.setCaption(`Installing the ${o} plugin`);try{const{assetFolderPath:i}=await Oo(e,{zipFile:t,targetPath:`${await e.documentRoot}/wp-content/plugins`});(!("activate"in r)||r.activate)&&await To(e,{pluginPath:i,pluginName:o},s),await Ta(e)}catch(i){console.error(`Proceeding without the ${o} plugin. Could not install it in wp-admin. The original error was: ${i}`),console.error(i)}};async function Ta(e){await e.isDir("/wordpress/wp-content/plugins/gutenberg")&&!await e.fileExists("/wordpress/.gutenberg-patched")&&(await e.writeFile("/wordpress/.gutenberg-patched","1"),await Ro(e,"/wordpress",["/wordpress/wp-content/plugins/gutenberg/build/block-editor/index.js","/wordpress/wp-content/plugins/gutenberg/build/block-editor/index.min.js"]))}const xa=async(e,{themeZipFile:t,options:r={}},s)=>{const n=Qr(t.name);s==null||s.tracker.setCaption(`Installing the ${n} theme`);try{const{assetFolderName:o}=await Oo(e,{zipFile:t,targetPath:`${await e.documentRoot}/wp-content/themes`});(!("activate"in r)||r.activate)&&await xo(e,{themeFolderName:o},s)}catch(o){console.error(`Proceeding without the ${n} theme. Could not install it in wp-admin. The original error was: ${o}`),console.error(o)}},Ra=async(e,{username:t="admin",password:r="password"}={},s)=>{s==null||s.tracker.setCaption((s==null?void 0:s.initialCaption)||"Logging in"),await e.request({url:"/wp-login.php"}),await e.request({url:"/wp-login.php",method:"POST",formData:{log:t,pwd:r,rememberme:"forever"}})},ja=async(e,{options:t})=>{await e.request({url:"/wp-admin/install.php?step=2",method:"POST",formData:{language:"en",prefix:"wp_",weblog_title:"My WordPress Website",user_name:t.adminPassword||"admin",admin_password:t.adminPassword||"password",admin_password2:t.adminPassword||"password",Submit:"Install WordPress",pw_weak:"1",admin_email:"admin@localhost.com"}})},Na=async(e,{options:t})=>{const r=`<?php
	include 'wordpress/wp-load.php';
	$site_options = ${gr(t)};
	foreach($site_options as $name => $value) {
		update_option($name, $value);
	}
	echo "Success";
	`,s=await e.run({code:r});return Io(s),{code:r,result:s}},Ca=async(e,{meta:t,userId:r})=>{const s=`<?php
	include 'wordpress/wp-load.php';
	$meta = ${gr(t)};
	foreach($meta as $name => $value) {
		update_user_meta(${gr(r)}, $name, $value);
	}
	echo "Success";
	`,n=await e.run({code:s});return Io(n),{code:s,result:n}};async function Io(e){if(e.text!=="Success")throw console.log(e),new Error(`Failed to run code: ${e.text} ${e.errors}`)}const Oa=async(e,{selfContained:t=!1}={})=>{const r="/tmp/wordpress-playground.zip",s=await e.documentRoot,n=ve(s,"wp-content");let o=So;t&&(o=o.filter(h=>!h.startsWith("themes/twenty")).filter(h=>h!=="plugins/sqlite-database-integration"));const i=Ms({zipPath:r,wpContentPath:n,documentRoot:s,exceptPaths:o.map(h=>ve(s,"wp-content",h)),additionalPaths:t?{[ve(s,"wp-config.php")]:"wp-config.php"}:{}});await ko(e,`zipDir(${i.wpContentPath}, ${i.zipPath}, array(
			'exclude_paths' => ${i.exceptPaths},
			'zip_root'      => ${i.documentRoot},
			'additional_paths' => ${i.additionalPaths}
		));`);const p=await e.readFileAsBuffer(r);return e.unlink(r),p},Ia=Object.freeze(Object.defineProperty({__proto__:null,activatePlugin:To,activateTheme:xo,applyWordPressPatches:oa,cp:ya,defineSiteUrl:$a,defineWpConfigConsts:ir,exportWXR:Ea,exportWXZ:Sa,importFile:_a,importWordPressFiles:Pa,installPlugin:ka,installTheme:xa,login:Ra,mkdir:wa,mv:ga,request:ma,rm:jo,rmdir:va,runPHP:aa,runPHPWithOptions:ca,runSql:ha,runWpInstallationWizard:ja,setPhpIniEntry:fa,setSiteOptions:Na,unzip:Fs,updateUserMeta:Ca,writeFile:Co,zipWpContent:Oa},Symbol.toStringTag,{value:"Module"})),qa=5*1024*1024;function Aa(e,t){const r=e.headers.get("content-length")||"",s=parseInt(r,10)||qa;function n(o,i){t(new CustomEvent("progress",{detail:{loaded:o,total:i}}))}return new Response(new ReadableStream({async start(o){if(!e.body){o.close();return}const i=e.body.getReader();let p=0;for(;;)try{const{done:h,value:l}=await i.read();if(l&&(p+=l.byteLength),h){n(p,p),o.close();break}else n(p,s),o.enqueue(l)}catch(h){console.error({e:h}),o.error(h);break}}}),{status:e.status,statusText:e.statusText,headers:e.headers})}const os=1e-5;class Xr extends EventTarget{constructor({weight:t=1,caption:r="",fillTime:s=4}={}){super(),this._selfWeight=1,this._selfDone=!1,this._selfProgress=0,this._selfCaption="",this._isFilling=!1,this._subTrackers=[],this._weight=t,this._selfCaption=r,this._fillTime=s}stage(t,r=""){if(t||(t=this._selfWeight),this._selfWeight-t<-os)throw new Error(`Cannot add a stage with weight ${t} as the total weight of registered stages would exceed 1.`);this._selfWeight-=t;const s=new Xr({caption:r,weight:t,fillTime:this._fillTime});return this._subTrackers.push(s),s.addEventListener("progress",()=>this.notifyProgress()),s.addEventListener("done",()=>{this.done&&this.notifyDone()}),s}fillSlowly({stopBeforeFinishing:t=!0}={}){if(this._isFilling)return;this._isFilling=!0;const r=100,s=this._fillTime/r;this._fillInterval=setInterval(()=>{this.set(this._selfProgress+1),t&&this._selfProgress>=99&&clearInterval(this._fillInterval)},s)}set(t){this._selfProgress=Math.min(t,100),this.notifyProgress(),this._selfProgress+os>=100&&this.finish()}finish(){this._fillInterval&&clearInterval(this._fillInterval),this._selfDone=!0,this._selfProgress=100,this._isFilling=!1,this._fillInterval=void 0,this.notifyProgress(),this.notifyDone()}get caption(){for(let t=this._subTrackers.length-1;t>=0;t--)if(!this._subTrackers[t].done){const r=this._subTrackers[t].caption;if(r)return r}return this._selfCaption}setCaption(t){this._selfCaption=t,this.notifyProgress()}get done(){return this.progress+os>=100}get progress(){if(this._selfDone)return 100;const t=this._subTrackers.reduce((r,s)=>r+s.progress*s.weight,this._selfProgress*this._selfWeight);return Math.round(t*1e4)/1e4}get weight(){return this._weight}get observer(){return this._progressObserver||(this._progressObserver=t=>{this.set(t)}),this._progressObserver}get loadingListener(){return this._loadingListener||(this._loadingListener=t=>{this.set(t.detail.loaded/t.detail.total*100)}),this._loadingListener}pipe(t){t.setProgress({progress:this.progress,caption:this.caption}),this.addEventListener("progress",r=>{t.setProgress({progress:r.detail.progress,caption:r.detail.caption})}),this.addEventListener("done",()=>{t.setLoaded()})}addEventListener(t,r){super.addEventListener(t,r)}removeEventListener(t,r){super.removeEventListener(t,r)}notifyProgress(){const t=this;this.dispatchEvent(new CustomEvent("progress",{detail:{get progress(){return t.progress},get caption(){return t.caption}}}))}notifyDone(){this.dispatchEvent(new CustomEvent("done"))}}const zn=Symbol("error"),Hn=Symbol("message");class Us extends Event{constructor(t,r={}){super(t),this[zn]=r.error===void 0?null:r.error,this[Hn]=r.message===void 0?"":r.message}get error(){return this[zn]}get message(){return this[Hn]}}Object.defineProperty(Us.prototype,"error",{enumerable:!0});Object.defineProperty(Us.prototype,"message",{enumerable:!0});const Da=typeof globalThis.ErrorEvent=="function"?globalThis.ErrorEvent:Us;function Ma(e){return e instanceof Error?"exitCode"in e&&(e==null?void 0:e.exitCode)===0||(e==null?void 0:e.name)==="ExitStatus"&&"status"in e&&e.status===0:!1}class Fa extends EventTarget{constructor(){super(...arguments),this.listenersCount=0}addEventListener(t,r){++this.listenersCount,super.addEventListener(t,r)}removeEventListener(t,r){--this.listenersCount,super.removeEventListener(t,r)}hasListeners(){return this.listenersCount>0}}function Ua(e){e.asm={...e.asm};const t=new Fa;for(const r in e.asm)if(typeof e.asm[r]=="function"){const s=e.asm[r];e.asm[r]=function(...n){var o;try{return s(...n)}catch(i){if(!(i instanceof Error))throw i;const p=Wa(i,(o=e.lastAsyncifyStackSource)==null?void 0:o.stack);if(e.lastAsyncifyStackSource&&(i.cause=e.lastAsyncifyStackSource),t.hasListeners()){t.dispatchEvent(new Da("error",{error:i,message:p}));return}throw Ma(i)||Va(p),i}}}return t}let ds=[];function La(){return ds}function Wa(e,t){if(e.message==="unreachable"){let r=za;t||(r+=`

This stack trace is lacking. For a better one initialize 
the PHP runtime with { debug: true }, e.g. PHPNode.load('8.1', { debug: true }).

`),ds=Ba(t||e.stack||"");for(const s of ds)r+=`    * ${s}
`;return r}return e.message}const za=`
"unreachable" WASM instruction executed.

The typical reason is a PHP function missing from the ASYNCIFY_ONLY
list when building PHP.wasm.

You will need to file a new issue in the WordPress Playground repository
and paste this error message there:

https://github.com/WordPress/wordpress-playground/issues/new

If you're a core developer, the typical fix is to:

* Isolate a minimal reproduction of the error
* Add a reproduction of the error to php-asyncify.spec.ts in the WordPress Playground repository
* Run 'npm run fix-asyncify'
* Commit the changes, push to the repo, release updated NPM packages

Below is a list of all the PHP functions found in the stack trace to
help with the minimal reproduction. If they're all already listed in
the Dockerfile, you'll need to trigger this error again with long stack
traces enabled. In node.js, you can do it using the --stack-trace-limit=100
CLI option: 

`,Vn="\x1B[41m",Ha="\x1B[1m",Bn="\x1B[0m",Kn="\x1B[K";let Gn=!1;function Va(e){if(!Gn){Gn=!0,console.log(`${Vn}
${Kn}
${Ha}  WASM ERROR${Bn}${Vn}`);for(const t of e.split(`
`))console.log(`${Kn}  ${t} `);console.log(`${Bn}`)}}function Ba(e){try{const t=e.split(`
`).slice(1).map(r=>{const s=r.trim().substring(3).split(" ");return{fn:s.length>=2?s[0]:"<unknown>",isWasm:r.includes("wasm://")}}).filter(({fn:r,isWasm:s})=>s&&!r.startsWith("dynCall_")&&!r.startsWith("invoke_")).map(({fn:r})=>r);return Array.from(new Set(t))}catch{return[]}}class wt{constructor(t,r,s,n="",o=0){this.httpStatusCode=t,this.headers=r,this.bytes=s,this.exitCode=o,this.errors=n}static fromRawData(t){return new wt(t.httpStatusCode,t.headers,t.bytes,t.errors,t.exitCode)}toRawData(){return{headers:this.headers,bytes:this.bytes,errors:this.errors,exitCode:this.exitCode,httpStatusCode:this.httpStatusCode}}get json(){return JSON.parse(this.text)}get text(){return new TextDecoder().decode(this.bytes)}}const qo=["8.3","8.2","8.1","8.0","7.4","7.3","7.2","7.1","7.0"],Ka=qo[0],Ao=["iconv","mbstring","xml-bundle","gd"],Jn={"kitchen-sink":Ao};var It,sr;class Ga{constructor(t,r={}){te(this,It,void 0),te(this,sr,void 0),this.requestHandler=t,fe(this,It,{}),fe(this,sr,{handleRedirects:!1,maxRedirects:4,...r})}async request(t,r=0){const s=await this.requestHandler.request({...t,headers:{...t.headers,cookie:this.serializeCookies()}});if(s.headers["set-cookie"]&&this.setCookies(s.headers["set-cookie"]),W(this,sr).handleRedirects&&s.headers.location&&r<W(this,sr).maxRedirects){const n=new URL(s.headers.location[0],this.requestHandler.absoluteUrl);return this.request({url:n.toString(),method:"GET",headers:{}},r+1)}return s}pathToInternalUrl(t){return this.requestHandler.pathToInternalUrl(t)}internalUrlToPath(t){return this.requestHandler.internalUrlToPath(t)}get absoluteUrl(){return this.requestHandler.absoluteUrl}get documentRoot(){return this.requestHandler.documentRoot}setCookies(t){for(const r of t)try{if(!r.includes("="))continue;const s=r.indexOf("="),n=r.substring(0,s),o=r.substring(s+1).split(";")[0];W(this,It)[n]=o}catch(s){console.error(s)}}serializeCookies(){const t=[];for(const r in W(this,It))t.push(`${r}=${W(this,It)[r]}`);return t.join("; ")}}It=new WeakMap,sr=new WeakMap;const Ja="http://example.com";function Do(e){return e.toString().substring(e.origin.length)}function Mo(e,t){return!t||!e.startsWith(t)?e:e.substring(t.length)}function Za(e,t){return!t||e.startsWith(t)?e:t+e}var Je,ar,Ar,qt,cr,Ge,lr,pr,hs,Fo,fs,Uo,ms,Zn;class Ya{constructor(t,r={}){te(this,hs),te(this,fs),te(this,ms),te(this,Je,void 0),te(this,ar,void 0),te(this,Ar,void 0),te(this,qt,void 0),te(this,cr,void 0),te(this,Ge,void 0),te(this,lr,void 0),te(this,pr,void 0),fe(this,pr,new Ds({concurrency:1}));const{documentRoot:s="/www/",absoluteUrl:n=typeof location=="object"?location==null?void 0:location.href:""}=r;this.php=t,fe(this,Je,s);const o=new URL(n);fe(this,Ar,o.hostname),fe(this,qt,o.port?Number(o.port):o.protocol==="https:"?443:80),fe(this,ar,(o.protocol||"").replace(":",""));const i=W(this,qt)!==443&&W(this,qt)!==80;fe(this,cr,[W(this,Ar),i?`:${W(this,qt)}`:""].join("")),fe(this,Ge,o.pathname.replace(/\/+$/,"")),fe(this,lr,[`${W(this,ar)}://`,W(this,cr),W(this,Ge)].join(""))}pathToInternalUrl(t){return`${this.absoluteUrl}${t}`}internalUrlToPath(t){const r=new URL(t);return r.pathname.startsWith(W(this,Ge))&&(r.pathname=r.pathname.slice(W(this,Ge).length)),Do(r)}get isRequestRunning(){return W(this,pr).running>0}get absoluteUrl(){return W(this,lr)}get documentRoot(){return W(this,Je)}async request(t){const r=t.url.startsWith("http://")||t.url.startsWith("https://"),s=new URL(t.url,r?void 0:Ja),n=Mo(s.pathname,W(this,Ge)),o=`${W(this,Je)}${n}`;return ec(o)?await $e(this,fs,Uo).call(this,t,s):$e(this,hs,Fo).call(this,o)}}Je=new WeakMap,ar=new WeakMap,Ar=new WeakMap,qt=new WeakMap,cr=new WeakMap,Ge=new WeakMap,lr=new WeakMap,pr=new WeakMap,hs=new WeakSet,Fo=function(e){if(!this.php.fileExists(e))return new wt(404,{"x-file-type":["static"]},new TextEncoder().encode("404 File not found"));const t=this.php.readFileAsBuffer(e);return new wt(200,{"content-length":[`${t.byteLength}`],"content-type":[Xa(e)],"accept-ranges":["bytes"],"cache-control":["public, max-age=0"]},t)},fs=new WeakSet,Uo=async function(e,t){var r;const s=await W(this,pr).acquire();try{this.php.addServerGlobalEntry("DOCUMENT_ROOT",W(this,Je)),this.php.addServerGlobalEntry("HTTPS",W(this,lr).startsWith("https://")?"on":"");let n="GET";const o={host:W(this,cr),...Qo(e.headers||{})},i=[];if(e.files&&Object.keys(e.files).length){n="POST";for(const l in e.files){const d=e.files[l];i.push({key:l,name:d.name,type:d.type,data:new Uint8Array(await d.arrayBuffer())})}(r=o["content-type"])!=null&&r.startsWith("multipart/form-data")&&(e.formData=Qa(e.body||""),o["content-type"]="application/x-www-form-urlencoded",delete e.body)}let p;e.formData!==void 0?(n="POST",o["content-type"]=o["content-type"]||"application/x-www-form-urlencoded",p=new URLSearchParams(e.formData).toString()):p=e.body;let h;try{h=$e(this,ms,Zn).call(this,t.pathname)}catch{return new wt(404,{},new TextEncoder().encode("404 File not found"))}return await this.php.run({relativeUri:Za(Do(t),W(this,Ge)),protocol:W(this,ar),method:e.method||n,body:p,fileInfos:i,scriptPath:h,headers:o})}finally{s()}},ms=new WeakSet,Zn=function(e){let t=Mo(e,W(this,Ge));t.includes(".php")?t=t.split(".php")[0]+".php":(t.endsWith("/")||(t+="/"),t.endsWith("index.php")||(t+="index.php"));const r=`${W(this,Je)}${t}`;if(this.php.fileExists(r))return r;if(!this.php.fileExists(`${W(this,Je)}/index.php`))throw new Error(`File not found: ${r}`);return`${W(this,Je)}/index.php`};function Qa(e){const t={},r=e.match(/--(.*)\r\n/);if(!r)return t;const s=r[1],n=e.split(`--${s}`);return n.shift(),n.pop(),n.forEach(o=>{const i=o.indexOf(`\r
\r
`),p=o.substring(0,i).trim(),h=o.substring(i+4).trim(),l=p.match(/name="([^"]+)"/);if(l){const d=l[1];t[d]=h}}),t}function Xa(e){switch(e.split(".").pop()){case"css":return"text/css";case"js":return"application/javascript";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"gif":return"image/gif";case"svg":return"image/svg+xml";case"woff":return"font/woff";case"woff2":return"font/woff2";case"ttf":return"font/ttf";case"otf":return"font/otf";case"eot":return"font/eot";case"ico":return"image/x-icon";case"html":return"text/html";case"json":return"application/json";case"xml":return"application/xml";case"txt":case"md":return"text/plain";default:return"application-octet-stream"}}function ec(e){return tc(e)||rc(e)}function tc(e){return e.endsWith(".php")||e.includes(".php/")}function rc(e){return!e.split("/").pop().includes(".")}const Yn={0:"No error occurred. System call completed successfully.",1:"Argument list too long.",2:"Permission denied.",3:"Address in use.",4:"Address not available.",5:"Address family not supported.",6:"Resource unavailable, or operation would block.",7:"Connection already in progress.",8:"Bad file descriptor.",9:"Bad message.",10:"Device or resource busy.",11:"Operation canceled.",12:"No child processes.",13:"Connection aborted.",14:"Connection refused.",15:"Connection reset.",16:"Resource deadlock would occur.",17:"Destination address required.",18:"Mathematics argument out of domain of function.",19:"Reserved.",20:"File exists.",21:"Bad address.",22:"File too large.",23:"Host is unreachable.",24:"Identifier removed.",25:"Illegal byte sequence.",26:"Operation in progress.",27:"Interrupted function.",28:"Invalid argument.",29:"I/O error.",30:"Socket is connected.",31:"There is a directory under that path.",32:"Too many levels of symbolic links.",33:"File descriptor value too large.",34:"Too many links.",35:"Message too large.",36:"Reserved.",37:"Filename too long.",38:"Network is down.",39:"Connection aborted by network.",40:"Network unreachable.",41:"Too many files open in system.",42:"No buffer space available.",43:"No such device.",44:"There is no such file or directory OR the parent directory does not exist.",45:"Executable file format error.",46:"No locks available.",47:"Reserved.",48:"Not enough space.",49:"No message of the desired type.",50:"Protocol not available.",51:"No space left on device.",52:"Function not supported.",53:"The socket is not connected.",54:"Not a directory or a symbolic link to a directory.",55:"Directory not empty.",56:"State not recoverable.",57:"Not a socket.",58:"Not supported, or operation not supported on socket.",59:"Inappropriate I/O control operation.",60:"No such device or address.",61:"Value too large to be stored in data type.",62:"Previous owner died.",63:"Operation not permitted.",64:"Broken pipe.",65:"Protocol error.",66:"Protocol not supported.",67:"Protocol wrong type for socket.",68:"Result too large.",69:"Read-only file system.",70:"Invalid seek.",71:"No such process.",72:"Reserved.",73:"Connection timed out.",74:"Text file busy.",75:"Cross-device link.",76:"Extension: Capabilities insufficient."};function Ae(e=""){return function(t,r,s){const n=s.value;s.value=function(...o){try{return n.apply(this,o)}catch(i){const p=typeof i=="object"?i==null?void 0:i.errno:null;if(p in Yn){const h=Yn[p],l=typeof o[0]=="string"?o[0]:null,d=l!==null?e.replaceAll("{path}",l):e;throw new Error(`${d}: ${h}`,{cause:i})}throw i}}}}const sc=new Map;function nc(e){return sc.get(e)}(function(){var e;return typeof process<"u"&&((e=process.release)==null?void 0:e.name)==="node"?"NODE":typeof window<"u"?"WEB":typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?"WORKER":"NODE"})();var oc=Object.defineProperty,ic=Object.getOwnPropertyDescriptor,De=(e,t,r,s)=>{for(var n=s>1?void 0:s?ic(t,r):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(n=(s?i(t,r,n):i(n))||n);return s&&n&&oc(t,r,n),n};const ge="string",Nt="number",X=Symbol("__private__dont__use");var Mt,dt,Ft,gt,tt,nr,Dr,ys,Lo,gs,Qn,ws,Wo,vs,zo,$s,Ho,_s,Vo,bs,Bo,Ps,Ko,Es,Go,Ss,Jo,ks,Zo,Ts,Yo;class Me{constructor(t,r){te(this,ys),te(this,gs),te(this,ws),te(this,vs),te(this,$s),te(this,_s),te(this,bs),te(this,Ps),te(this,Es),te(this,Ss),te(this,ks),te(this,Ts),te(this,Mt,void 0),te(this,dt,void 0),te(this,Ft,void 0),te(this,gt,void 0),te(this,tt,void 0),te(this,nr,void 0),te(this,Dr,void 0),fe(this,Mt,[]),fe(this,dt,!1),fe(this,Ft,null),fe(this,gt,{}),fe(this,tt,new Map),fe(this,nr,[]),fe(this,Dr,new Ds({concurrency:1})),t!==void 0&&this.initializeRuntime(t),r&&(this.requestHandler=new Ga(new Ya(this,r)))}addEventListener(t,r){W(this,tt).has(t)||W(this,tt).set(t,new Set),W(this,tt).get(t).add(r)}removeEventListener(t,r){var s;(s=W(this,tt).get(t))==null||s.delete(r)}dispatchEvent(t){const r=W(this,tt).get(t.type);if(r)for(const s of r)s(t)}async onMessage(t){W(this,nr).push(t)}async setSpawnHandler(t){this[X].spawnProcess=t}get absoluteUrl(){return this.requestHandler.requestHandler.absoluteUrl}get documentRoot(){return this.requestHandler.requestHandler.documentRoot}pathToInternalUrl(t){return this.requestHandler.requestHandler.pathToInternalUrl(t)}internalUrlToPath(t){return this.requestHandler.requestHandler.internalUrlToPath(t)}initializeRuntime(t){if(this[X])throw new Error("PHP runtime already initialized.");const r=nc(t);if(!r)throw new Error("Invalid PHP runtime id.");this[X]=r,r.onMessage=async s=>{for(const n of W(this,nr)){const o=await n(s);if(o)return o}return""},fe(this,Ft,Ua(r))}setPhpIniPath(t){if(W(this,dt))throw new Error("Cannot set PHP ini path after calling run().");this[X].ccall("wasm_set_phpini_path",null,["string"],[t])}setPhpIniEntry(t,r){if(W(this,dt))throw new Error("Cannot set PHP ini entries after calling run().");W(this,Mt).push([t,r])}chdir(t){this[X].FS.chdir(t)}async request(t,r){if(!this.requestHandler)throw new Error("No request handler available.");return this.requestHandler.request(t,r)}async run(t){const r=await W(this,Dr).acquire();try{W(this,dt)||($e(this,ys,Lo).call(this),fe(this,dt,!0)),$e(this,Ps,Ko).call(this,t.scriptPath||""),$e(this,ws,Wo).call(this,t.relativeUri||""),$e(this,$s,Ho).call(this,t.method||"GET");const s=Qo(t.headers||{}),n=s.host||"example.com:443";if($e(this,vs,zo).call(this,n,t.protocol||"http"),$e(this,_s,Vo).call(this,s),t.body&&$e(this,bs,Bo).call(this,t.body),t.fileInfos)for(const o of t.fileInfos)$e(this,Ss,Jo).call(this,o);return t.code&&$e(this,ks,Zo).call(this," ?>"+t.code),$e(this,Es,Go).call(this),await $e(this,Ts,Yo).call(this)}finally{r(),this.dispatchEvent({type:"request.end"})}}addServerGlobalEntry(t,r){W(this,gt)[t]=r}defineConstant(t,r){let s={};try{s=JSON.parse(this.fileExists("/tmp/consts.json")&&this.readFileAsText("/tmp/consts.json")||"{}")}catch{}this.writeFile("/tmp/consts.json",JSON.stringify({...s,[t]:r}))}mkdir(t){this[X].FS.mkdirTree(t)}mkdirTree(t){this.mkdir(t)}readFileAsText(t){return new TextDecoder().decode(this.readFileAsBuffer(t))}readFileAsBuffer(t){return this[X].FS.readFile(t)}writeFile(t,r){this[X].FS.writeFile(t,r)}unlink(t){this[X].FS.unlink(t)}mv(t,r){this[X].FS.rename(t,r)}rmdir(t,r={recursive:!0}){r!=null&&r.recursive&&this.listFiles(t).forEach(s=>{const n=`${t}/${s}`;this.isDir(n)?this.rmdir(n,r):this.unlink(n)}),this[X].FS.rmdir(t)}listFiles(t,r={prependPath:!1}){if(!this.fileExists(t))return[];try{const s=this[X].FS.readdir(t).filter(n=>n!=="."&&n!=="..");if(r.prependPath){const n=t.replace(/\/$/,"");return s.map(o=>`${n}/${o}`)}return s}catch(s){return console.error(s,{path:t}),[]}}isDir(t){return this.fileExists(t)?this[X].FS.isDir(this[X].FS.lookupPath(t).node.mode):!1}fileExists(t){try{return this[X].FS.lookupPath(t),!0}catch{return!1}}exit(t=0){return this[X]._exit(t)}}Mt=new WeakMap,dt=new WeakMap,Ft=new WeakMap,gt=new WeakMap,tt=new WeakMap,nr=new WeakMap,Dr=new WeakMap,ys=new WeakSet,Lo=function(){if(this.setPhpIniEntry("auto_prepend_file","/tmp/consts.php"),this.fileExists("/tmp/consts.php")||this.writeFile("/tmp/consts.php",`<?php
				if(file_exists('/tmp/consts.json')) {
					$consts = json_decode(file_get_contents('/tmp/consts.json'), true);
					foreach ($consts as $const => $value) {
						if (!defined($const) && is_scalar($value)) {
							define($const, $value);
						}
					}
				}`),W(this,Mt).length>0){const e=W(this,Mt).map(([t,r])=>`${t}=${r}`).join(`
`)+`

`;this[X].ccall("wasm_set_phpini_entries",null,[ge],[e])}this[X].ccall("php_wasm_init",null,[],[])},gs=new WeakSet,Qn=function(){const e="/tmp/headers.json";if(!this.fileExists(e))throw new Error("SAPI Error: Could not find response headers file.");const t=JSON.parse(this.readFileAsText(e)),r={};for(const s of t.headers){if(!s.includes(": "))continue;const n=s.indexOf(": "),o=s.substring(0,n).toLowerCase(),i=s.substring(n+2);o in r||(r[o]=[]),r[o].push(i)}return{headers:r,httpStatusCode:t.status}},ws=new WeakSet,Wo=function(e){if(this[X].ccall("wasm_set_request_uri",null,[ge],[e]),e.includes("?")){const t=e.substring(e.indexOf("?")+1);this[X].ccall("wasm_set_query_string",null,[ge],[t])}},vs=new WeakSet,zo=function(e,t){this[X].ccall("wasm_set_request_host",null,[ge],[e]);let r;try{r=parseInt(new URL(e).port,10)}catch{}(!r||isNaN(r)||r===80)&&(r=t==="https"?443:80),this[X].ccall("wasm_set_request_port",null,[Nt],[r]),(t==="https"||!t&&r===443)&&this.addServerGlobalEntry("HTTPS","on")},$s=new WeakSet,Ho=function(e){this[X].ccall("wasm_set_request_method",null,[ge],[e])},_s=new WeakSet,Vo=function(e){e.cookie&&this[X].ccall("wasm_set_cookies",null,[ge],[e.cookie]),e["content-type"]&&this[X].ccall("wasm_set_content_type",null,[ge],[e["content-type"]]),e["content-length"]&&this[X].ccall("wasm_set_content_length",null,[Nt],[parseInt(e["content-length"],10)]);for(const t in e){let r="HTTP_";["content-type","content-length"].includes(t.toLowerCase())&&(r=""),this.addServerGlobalEntry(`${r}${t.toUpperCase().replace(/-/g,"_")}`,e[t])}},bs=new WeakSet,Bo=function(e){this[X].ccall("wasm_set_request_body",null,[ge],[e]),this[X].ccall("wasm_set_content_length",null,[Nt],[new TextEncoder().encode(e).length])},Ps=new WeakSet,Ko=function(e){this[X].ccall("wasm_set_path_translated",null,[ge],[e])},Es=new WeakSet,Go=function(){for(const e in W(this,gt))this[X].ccall("wasm_add_SERVER_entry",null,[ge,ge],[e,W(this,gt)[e]])},Ss=new WeakSet,Jo=function(e){const{key:t,name:r,type:s,data:n}=e,o=`/tmp/${Math.random().toFixed(20)}`;this.writeFile(o,n);const i=0;this[X].ccall("wasm_add_uploaded_file",null,[ge,ge,ge,ge,Nt,Nt],[t,r,s,o,i,n.byteLength])},ks=new WeakSet,Zo=function(e){this[X].ccall("wasm_set_php_code",null,[ge],[e])},Ts=new WeakSet,Yo=async function(){var e;let t,r;try{t=await new Promise((o,i)=>{var p;r=l=>{const d=new Error("Rethrown");d.cause=l.error,d.betterMessage=l.message,i(d)},(p=W(this,Ft))==null||p.addEventListener("error",r);const h=this[X].ccall("wasm_sapi_handle_request",Nt,[],[],{async:!0});return h instanceof Promise?h.then(o,i):o(h)})}catch(o){for(const l in this)typeof this[l]=="function"&&(this[l]=()=>{throw new Error("PHP runtime has crashed â€“ see the earlier error for details.")});this.functionsMaybeMissingFromAsyncify=La();const i=o,p="betterMessage"in i?i.betterMessage:i.message,h=new Error(p);throw h.cause=i,h}finally{(e=W(this,Ft))==null||e.removeEventListener("error",r),fe(this,gt,{})}const{headers:s,httpStatusCode:n}=$e(this,gs,Qn).call(this);return new wt(n,s,this.readFileAsBuffer("/tmp/stdout"),this.readFileAsText("/tmp/stderr"),t)};De([Ae('Could not create directory "{path}"')],Me.prototype,"mkdir",1);De([Ae('Could not create directory "{path}"')],Me.prototype,"mkdirTree",1);De([Ae('Could not read "{path}"')],Me.prototype,"readFileAsText",1);De([Ae('Could not read "{path}"')],Me.prototype,"readFileAsBuffer",1);De([Ae('Could not write to "{path}"')],Me.prototype,"writeFile",1);De([Ae('Could not unlink "{path}"')],Me.prototype,"unlink",1);De([Ae('Could not move "{path}"')],Me.prototype,"mv",1);De([Ae('Could not remove directory "{path}"')],Me.prototype,"rmdir",1);De([Ae('Could not list files in "{path}"')],Me.prototype,"listFiles",1);De([Ae('Could not stat "{path}"')],Me.prototype,"isDir",1);De([Ae('Could not stat "{path}"')],Me.prototype,"fileExists",1);function Qo(e){const t={};for(const r in e)t[r.toLowerCase()]=e[r];return t}const ac=["vfs","literal","wordpress.org/themes","wordpress.org/plugins","url"];function cc(e){return e&&typeof e=="object"&&typeof e.resource=="string"&&ac.includes(e.resource)}class _t{static create(t,{semaphore:r,progress:s}){let n;switch(t.resource){case"vfs":n=new lc(t,s);break;case"literal":n=new pc(t,s);break;case"wordpress.org/themes":n=new hc(t,s);break;case"wordpress.org/plugins":n=new fc(t,s);break;case"url":n=new dc(t,s);break;default:throw new Error(`Invalid resource: ${t}`)}return n=new mc(n),r&&(n=new yc(n,r)),n}setPlayground(t){this.playground=t}get isAsync(){return!1}}class lc extends _t{constructor(t,r){super(),this.resource=t,this.progress=r}async resolve(){var t;const r=await this.playground.readFileAsBuffer(this.resource.path);return(t=this.progress)==null||t.set(100),new File([r],this.name)}get name(){return this.resource.path.split("/").pop()||""}}class pc extends _t{constructor(t,r){super(),this.resource=t,this.progress=r}async resolve(){var t;return(t=this.progress)==null||t.set(100),new File([this.resource.contents],this.resource.name)}get name(){return this.resource.name}}class Ls extends _t{constructor(t){super(),this.progress=t}async resolve(){var t,r;(t=this.progress)==null||t.setCaption(this.caption);const s=this.getURL();let n=await fetch(s);if(n=await Aa(n,((r=this.progress)==null?void 0:r.loadingListener)??uc),n.status!==200)throw new Error(`Could not download "${s}"`);return new File([await n.blob()],this.name)}get caption(){return`Downloading ${this.name}`}get name(){try{return new URL(this.getURL(),"http://example.com").pathname.split("/").pop()}catch{return this.getURL()}}get isAsync(){return!0}}const uc=()=>{};class dc extends Ls{constructor(t,r){super(r),this.resource=t}getURL(){return this.resource.url}get caption(){return this.resource.caption??super.caption}}class hc extends Ls{constructor(t,r){super(r),this.resource=t}get name(){return Qr(this.resource.slug)}getURL(){return`https://downloads.wordpress.org/theme/${Xo(this.resource.slug)}`}}class fc extends Ls{constructor(t,r){super(r),this.resource=t}get name(){return Qr(this.resource.slug)}getURL(){return`https://downloads.wordpress.org/plugin/${Xo(this.resource.slug)}`}}function Xo(e){return!e||e.endsWith(".zip")?e:e+".latest-stable.zip"}class ei extends _t{constructor(t){super(),this.resource=t}async resolve(){return this.resource.resolve()}async setPlayground(t){return this.resource.setPlayground(t)}get progress(){return this.resource.progress}set progress(t){this.resource.progress=t}get name(){return this.resource.name}get isAsync(){return this.resource.isAsync}}class mc extends ei{async resolve(){return this.promise||(this.promise=super.resolve()),this.promise}}class yc extends ei{constructor(t,r){super(t),this.semaphore=r}async resolve(){return this.isAsync?this.semaphore.run(()=>super.resolve()):super.resolve()}}var gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xs={exports:{}},ti={},qe={},Lt={},vr={},K={},wr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(E){if(super(),!e.IDENTIFIER.test(E))throw new Error("CodeGen: name must be a valid identifier");this.str=E}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class s extends t{constructor(E){super(),this._items=typeof E=="string"?[E]:E}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const E=this._items[0];return E===""||E==='""'}get str(){var E;return(E=this._str)!==null&&E!==void 0?E:this._str=this._items.reduce((T,C)=>`${T}${C}`,"")}get names(){var E;return(E=this._names)!==null&&E!==void 0?E:this._names=this._items.reduce((T,C)=>(C instanceof r&&(T[C.str]=(T[C.str]||0)+1),T),{})}}e._Code=s,e.nil=new s("");function n(g,...E){const T=[g[0]];let C=0;for(;C<E.length;)p(T,E[C]),T.push(g[++C]);return new s(T)}e._=n;const o=new s("+");function i(g,...E){const T=[x(g[0])];let C=0;for(;C<E.length;)T.push(o),p(T,E[C]),T.push(o,x(g[++C]));return h(T),new s(T)}e.str=i;function p(g,E){E instanceof s?g.push(...E._items):E instanceof r?g.push(E):g.push(y(E))}e.addCodeArg=p;function h(g){let E=1;for(;E<g.length-1;){if(g[E]===o){const T=l(g[E-1],g[E+1]);if(T!==void 0){g.splice(E-1,3,T);continue}g[E++]="+"}E++}}function l(g,E){if(E==='""')return g;if(g==='""')return E;if(typeof g=="string")return E instanceof r||g[g.length-1]!=='"'?void 0:typeof E!="string"?`${g.slice(0,-1)}${E}"`:E[0]==='"'?g.slice(0,-1)+E.slice(1):void 0;if(typeof E=="string"&&E[0]==='"'&&!(g instanceof r))return`"${g}${E.slice(1)}`}function d(g,E){return E.emptyStr()?g:g.emptyStr()?E:i`${g}${E}`}e.strConcat=d;function y(g){return typeof g=="number"||typeof g=="boolean"||g===null?g:x(Array.isArray(g)?g.join(","):g)}function w(g){return new s(x(g))}e.stringify=w;function x(g){return JSON.stringify(g).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=x;function _(g){return typeof g=="string"&&e.IDENTIFIER.test(g)?new s(`.${g}`):n`[${g}]`}e.getProperty=_;function S(g){if(typeof g=="string"&&e.IDENTIFIER.test(g))return new s(`${g}`);throw new Error(`CodeGen: invalid export name: ${g}, use explicit $id name mapping`)}e.getEsmExportName=S;function v(g){return new s(g.toString())}e.regexpCode=v})(wr);var Rs={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=wr;class r extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var s;(function(h){h[h.Started=0]="Started",h[h.Completed=1]="Completed"})(s=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class n{constructor({prefixes:l,parent:d}={}){this._names={},this._prefixes=l,this._parent=d}toName(l){return l instanceof t.Name?l:this.name(l)}name(l){return new t.Name(this._newName(l))}_newName(l){const d=this._names[l]||this._nameGroup(l);return`${l}${d.index++}`}_nameGroup(l){var d,y;if(!((y=(d=this._parent)===null||d===void 0?void 0:d._prefixes)===null||y===void 0)&&y.has(l)||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}e.Scope=n;class o extends t.Name{constructor(l,d){super(d),this.prefix=l}setValue(l,{property:d,itemIndex:y}){this.value=l,this.scopePath=(0,t._)`.${new t.Name(d)}[${y}]`}}e.ValueScopeName=o;const i=(0,t._)`\n`;class p extends n{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts={...l,_n:l.lines?i:t.nil}}get(){return this._scope}name(l){return new o(l,this._newName(l))}value(l,d){var y;if(d.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const w=this.toName(l),{prefix:x}=w,_=(y=d.key)!==null&&y!==void 0?y:d.ref;let S=this._values[x];if(S){const E=S.get(_);if(E)return E}else S=this._values[x]=new Map;S.set(_,w);const v=this._scope[x]||(this._scope[x]=[]),g=v.length;return v[g]=d.ref,w.setValue(d,{property:x,itemIndex:g}),w}getValue(l,d){const y=this._values[l];if(y)return y.get(d)}scopeRefs(l,d=this._values){return this._reduceValues(d,y=>{if(y.scopePath===void 0)throw new Error(`CodeGen: name "${y}" has no value`);return(0,t._)`${l}${y.scopePath}`})}scopeCode(l=this._values,d,y){return this._reduceValues(l,w=>{if(w.value===void 0)throw new Error(`CodeGen: name "${w}" has no value`);return w.value.code},d,y)}_reduceValues(l,d,y={},w){let x=t.nil;for(const _ in l){const S=l[_];if(!S)continue;const v=y[_]=y[_]||new Map;S.forEach(g=>{if(v.has(g))return;v.set(g,s.Started);let E=d(g);if(E){const T=this.opts.es5?e.varKinds.var:e.varKinds.const;x=(0,t._)`${x}${T} ${g} = ${E};${this.opts._n}`}else if(E=w==null?void 0:w(g))x=(0,t._)`${x}${E}${this.opts._n}`;else throw new r(g);v.set(g,s.Completed)})}return x}}e.ValueScope=p})(Rs);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=wr,r=Rs;var s=wr;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return s._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return s.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return s.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return s.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return s.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return s.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return s.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return s.Name}});var n=Rs;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return n.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return n.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return n.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return n.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(c,m){return this}}class i extends o{constructor(c,m,j){super(),this.varKind=c,this.name=m,this.rhs=j}render({es5:c,_n:m}){const j=c?r.varKinds.var:this.varKind,D=this.rhs===void 0?"":` = ${this.rhs}`;return`${j} ${this.name}${D};`+m}optimizeNames(c,m){if(c[this.name.str])return this.rhs&&(this.rhs=ue(this.rhs,c,m)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class p extends o{constructor(c,m,j){super(),this.lhs=c,this.rhs=m,this.sideEffects=j}render({_n:c}){return`${this.lhs} = ${this.rhs};`+c}optimizeNames(c,m){if(!(this.lhs instanceof t.Name&&!c[this.lhs.str]&&!this.sideEffects))return this.rhs=ue(this.rhs,c,m),this}get names(){const c=this.lhs instanceof t.Name?{}:{...this.lhs.names};return ke(c,this.rhs)}}class h extends p{constructor(c,m,j,D){super(c,j,D),this.op=m}render({_n:c}){return`${this.lhs} ${this.op}= ${this.rhs};`+c}}class l extends o{constructor(c){super(),this.label=c,this.names={}}render({_n:c}){return`${this.label}:`+c}}class d extends o{constructor(c){super(),this.label=c,this.names={}}render({_n:c}){return`break${this.label?` ${this.label}`:""};`+c}}class y extends o{constructor(c){super(),this.error=c}render({_n:c}){return`throw ${this.error};`+c}get names(){return this.error.names}}class w extends o{constructor(c){super(),this.code=c}render({_n:c}){return`${this.code};`+c}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(c,m){return this.code=ue(this.code,c,m),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class x extends o{constructor(c=[]){super(),this.nodes=c}render(c){return this.nodes.reduce((m,j)=>m+j.render(c),"")}optimizeNodes(){const{nodes:c}=this;let m=c.length;for(;m--;){const j=c[m].optimizeNodes();Array.isArray(j)?c.splice(m,1,...j):j?c[m]=j:c.splice(m,1)}return c.length>0?this:void 0}optimizeNames(c,m){const{nodes:j}=this;let D=j.length;for(;D--;){const M=j[D];M.optimizeNames(c,m)||(nt(c,M.names),j.splice(D,1))}return j.length>0?this:void 0}get names(){return this.nodes.reduce((c,m)=>Y(c,m.names),{})}}class _ extends x{render(c){return"{"+c._n+super.render(c)+"}"+c._n}}class S extends x{}class v extends _{}v.kind="else";class g extends _{constructor(c,m){super(m),this.condition=c}render(c){let m=`if(${this.condition})`+super.render(c);return this.else&&(m+="else "+this.else.render(c)),m}optimizeNodes(){super.optimizeNodes();const c=this.condition;if(c===!0)return this.nodes;let m=this.else;if(m){const j=m.optimizeNodes();m=this.else=Array.isArray(j)?new v(j):j}if(m)return c===!1?m instanceof g?m:m.nodes:this.nodes.length?this:new g(ot(c),m instanceof g?[m]:m.nodes);if(!(c===!1||!this.nodes.length))return this}optimizeNames(c,m){var j;if(this.else=(j=this.else)===null||j===void 0?void 0:j.optimizeNames(c,m),!!(super.optimizeNames(c,m)||this.else))return this.condition=ue(this.condition,c,m),this}get names(){const c=super.names;return ke(c,this.condition),this.else&&Y(c,this.else.names),c}}g.kind="if";class E extends _{}E.kind="for";class T extends E{constructor(c){super(),this.iteration=c}render(c){return`for(${this.iteration})`+super.render(c)}optimizeNames(c,m){if(super.optimizeNames(c,m))return this.iteration=ue(this.iteration,c,m),this}get names(){return Y(super.names,this.iteration.names)}}class C extends E{constructor(c,m,j,D){super(),this.varKind=c,this.name=m,this.from=j,this.to=D}render(c){const m=c.es5?r.varKinds.var:this.varKind,{name:j,from:D,to:M}=this;return`for(${m} ${j}=${D}; ${j}<${M}; ${j}++)`+super.render(c)}get names(){const c=ke(super.names,this.from);return ke(c,this.to)}}class q extends E{constructor(c,m,j,D){super(),this.loop=c,this.varKind=m,this.name=j,this.iterable=D}render(c){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(c)}optimizeNames(c,m){if(super.optimizeNames(c,m))return this.iterable=ue(this.iterable,c,m),this}get names(){return Y(super.names,this.iterable.names)}}class b extends _{constructor(c,m,j){super(),this.name=c,this.args=m,this.async=j}render(c){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(c)}}b.kind="func";class k extends x{render(c){return"return "+super.render(c)}}k.kind="return";class I extends _{render(c){let m="try"+super.render(c);return this.catch&&(m+=this.catch.render(c)),this.finally&&(m+=this.finally.render(c)),m}optimizeNodes(){var c,m;return super.optimizeNodes(),(c=this.catch)===null||c===void 0||c.optimizeNodes(),(m=this.finally)===null||m===void 0||m.optimizeNodes(),this}optimizeNames(c,m){var j,D;return super.optimizeNames(c,m),(j=this.catch)===null||j===void 0||j.optimizeNames(c,m),(D=this.finally)===null||D===void 0||D.optimizeNames(c,m),this}get names(){const c=super.names;return this.catch&&Y(c,this.catch.names),this.finally&&Y(c,this.finally.names),c}}class H extends _{constructor(c){super(),this.error=c}render(c){return`catch(${this.error})`+super.render(c)}}H.kind="catch";class G extends _{render(c){return"finally"+super.render(c)}}G.kind="finally";class ae{constructor(c,m={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...m,_n:m.lines?`
`:""},this._extScope=c,this._scope=new r.Scope({parent:c}),this._nodes=[new S]}toString(){return this._root.render(this.opts)}name(c){return this._scope.name(c)}scopeName(c){return this._extScope.name(c)}scopeValue(c,m){const j=this._extScope.value(c,m);return(this._values[j.prefix]||(this._values[j.prefix]=new Set)).add(j),j}getScopeValue(c,m){return this._extScope.getValue(c,m)}scopeRefs(c){return this._extScope.scopeRefs(c,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(c,m,j,D){const M=this._scope.toName(m);return j!==void 0&&D&&(this._constants[M.str]=j),this._leafNode(new i(c,M,j)),M}const(c,m,j){return this._def(r.varKinds.const,c,m,j)}let(c,m,j){return this._def(r.varKinds.let,c,m,j)}var(c,m,j){return this._def(r.varKinds.var,c,m,j)}assign(c,m,j){return this._leafNode(new p(c,m,j))}add(c,m){return this._leafNode(new h(c,e.operators.ADD,m))}code(c){return typeof c=="function"?c():c!==t.nil&&this._leafNode(new w(c)),this}object(...c){const m=["{"];for(const[j,D]of c)m.length>1&&m.push(","),m.push(j),(j!==D||this.opts.es5)&&(m.push(":"),(0,t.addCodeArg)(m,D));return m.push("}"),new t._Code(m)}if(c,m,j){if(this._blockNode(new g(c)),m&&j)this.code(m).else().code(j).endIf();else if(m)this.code(m).endIf();else if(j)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(c){return this._elseNode(new g(c))}else(){return this._elseNode(new v)}endIf(){return this._endBlockNode(g,v)}_for(c,m){return this._blockNode(c),m&&this.code(m).endFor(),this}for(c,m){return this._for(new T(c),m)}forRange(c,m,j,D,M=this.opts.es5?r.varKinds.var:r.varKinds.let){const J=this._scope.toName(c);return this._for(new C(M,J,m,j),()=>D(J))}forOf(c,m,j,D=r.varKinds.const){const M=this._scope.toName(c);if(this.opts.es5){const J=m instanceof t.Name?m:this.var("_arr",m);return this.forRange("_i",0,(0,t._)`${J}.length`,Z=>{this.var(M,(0,t._)`${J}[${Z}]`),j(M)})}return this._for(new q("of",D,M,m),()=>j(M))}forIn(c,m,j,D=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(c,(0,t._)`Object.keys(${m})`,j);const M=this._scope.toName(c);return this._for(new q("in",D,M,m),()=>j(M))}endFor(){return this._endBlockNode(E)}label(c){return this._leafNode(new l(c))}break(c){return this._leafNode(new d(c))}return(c){const m=new k;if(this._blockNode(m),this.code(c),m.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(k)}try(c,m,j){if(!m&&!j)throw new Error('CodeGen: "try" without "catch" and "finally"');const D=new I;if(this._blockNode(D),this.code(c),m){const M=this.name("e");this._currNode=D.catch=new H(M),m(M)}return j&&(this._currNode=D.finally=new G,this.code(j)),this._endBlockNode(H,G)}throw(c){return this._leafNode(new y(c))}block(c,m){return this._blockStarts.push(this._nodes.length),c&&this.code(c).endBlock(m),this}endBlock(c){const m=this._blockStarts.pop();if(m===void 0)throw new Error("CodeGen: not in self-balancing block");const j=this._nodes.length-m;if(j<0||c!==void 0&&j!==c)throw new Error(`CodeGen: wrong number of nodes: ${j} vs ${c} expected`);return this._nodes.length=m,this}func(c,m=t.nil,j,D){return this._blockNode(new b(c,m,j)),D&&this.code(D).endFunc(),this}endFunc(){return this._endBlockNode(b)}optimize(c=1){for(;c-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(c){return this._currNode.nodes.push(c),this}_blockNode(c){this._currNode.nodes.push(c),this._nodes.push(c)}_endBlockNode(c,m){const j=this._currNode;if(j instanceof c||m&&j instanceof m)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${m?`${c.kind}/${m.kind}`:c.kind}"`)}_elseNode(c){const m=this._currNode;if(!(m instanceof g))throw new Error('CodeGen: "else" without "if"');return this._currNode=m.else=c,this}get _root(){return this._nodes[0]}get _currNode(){const c=this._nodes;return c[c.length-1]}set _currNode(c){const m=this._nodes;m[m.length-1]=c}}e.CodeGen=ae;function Y(P,c){for(const m in c)P[m]=(P[m]||0)+(c[m]||0);return P}function ke(P,c){return c instanceof t._CodeOrName?Y(P,c.names):P}function ue(P,c,m){if(P instanceof t.Name)return j(P);if(!D(P))return P;return new t._Code(P._items.reduce((M,J)=>(J instanceof t.Name&&(J=j(J)),J instanceof t._Code?M.push(...J._items):M.push(J),M),[]));function j(M){const J=m[M.str];return J===void 0||c[M.str]!==1?M:(delete c[M.str],J)}function D(M){return M instanceof t._Code&&M._items.some(J=>J instanceof t.Name&&c[J.str]===1&&m[J.str]!==void 0)}}function nt(P,c){for(const m in c)P[m]=(P[m]||0)-(c[m]||0)}function ot(P){return typeof P=="boolean"||typeof P=="number"||P===null?!P:(0,t._)`!${O(P)}`}e.not=ot;const bt=$(e.operators.AND);function Vt(...P){return P.reduce(bt)}e.and=Vt;const Pt=$(e.operators.OR);function A(...P){return P.reduce(Pt)}e.or=A;function $(P){return(c,m)=>c===t.nil?m:m===t.nil?c:(0,t._)`${O(c)} ${P} ${O(m)}`}function O(P){return P instanceof t.Name?P:(0,t._)`(${P})`}})(K);var ee={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=K,r=wr;function s(b){const k={};for(const I of b)k[I]=!0;return k}e.toHash=s;function n(b,k){return typeof k=="boolean"?k:Object.keys(k).length===0?!0:(o(b,k),!i(k,b.self.RULES.all))}e.alwaysValidSchema=n;function o(b,k=b.schema){const{opts:I,self:H}=b;if(!I.strictSchema||typeof k=="boolean")return;const G=H.RULES.keywords;for(const ae in k)G[ae]||q(b,`unknown keyword: "${ae}"`)}e.checkUnknownRules=o;function i(b,k){if(typeof b=="boolean")return!b;for(const I in b)if(k[I])return!0;return!1}e.schemaHasRules=i;function p(b,k){if(typeof b=="boolean")return!b;for(const I in b)if(I!=="$ref"&&k.all[I])return!0;return!1}e.schemaHasRulesButRef=p;function h({topSchemaRef:b,schemaPath:k},I,H,G){if(!G){if(typeof I=="number"||typeof I=="boolean")return I;if(typeof I=="string")return(0,t._)`${I}`}return(0,t._)`${b}${k}${(0,t.getProperty)(H)}`}e.schemaRefOrVal=h;function l(b){return w(decodeURIComponent(b))}e.unescapeFragment=l;function d(b){return encodeURIComponent(y(b))}e.escapeFragment=d;function y(b){return typeof b=="number"?`${b}`:b.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=y;function w(b){return b.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=w;function x(b,k){if(Array.isArray(b))for(const I of b)k(I);else k(b)}e.eachItem=x;function _({mergeNames:b,mergeToName:k,mergeValues:I,resultToName:H}){return(G,ae,Y,ke)=>{const ue=Y===void 0?ae:Y instanceof t.Name?(ae instanceof t.Name?b(G,ae,Y):k(G,ae,Y),Y):ae instanceof t.Name?(k(G,Y,ae),ae):I(ae,Y);return ke===t.Name&&!(ue instanceof t.Name)?H(G,ue):ue}}e.mergeEvaluated={props:_({mergeNames:(b,k,I)=>b.if((0,t._)`${I} !== true && ${k} !== undefined`,()=>{b.if((0,t._)`${k} === true`,()=>b.assign(I,!0),()=>b.assign(I,(0,t._)`${I} || {}`).code((0,t._)`Object.assign(${I}, ${k})`))}),mergeToName:(b,k,I)=>b.if((0,t._)`${I} !== true`,()=>{k===!0?b.assign(I,!0):(b.assign(I,(0,t._)`${I} || {}`),v(b,I,k))}),mergeValues:(b,k)=>b===!0?!0:{...b,...k},resultToName:S}),items:_({mergeNames:(b,k,I)=>b.if((0,t._)`${I} !== true && ${k} !== undefined`,()=>b.assign(I,(0,t._)`${k} === true ? true : ${I} > ${k} ? ${I} : ${k}`)),mergeToName:(b,k,I)=>b.if((0,t._)`${I} !== true`,()=>b.assign(I,k===!0?!0:(0,t._)`${I} > ${k} ? ${I} : ${k}`)),mergeValues:(b,k)=>b===!0?!0:Math.max(b,k),resultToName:(b,k)=>b.var("items",k)})};function S(b,k){if(k===!0)return b.var("props",!0);const I=b.var("props",(0,t._)`{}`);return k!==void 0&&v(b,I,k),I}e.evaluatedPropsToName=S;function v(b,k,I){Object.keys(I).forEach(H=>b.assign((0,t._)`${k}${(0,t.getProperty)(H)}`,!0))}e.setEvaluated=v;const g={};function E(b,k){return b.scopeValue("func",{ref:k,code:g[k.code]||(g[k.code]=new r._Code(k.code))})}e.useFunc=E;var T;(function(b){b[b.Num=0]="Num",b[b.Str=1]="Str"})(T=e.Type||(e.Type={}));function C(b,k,I){if(b instanceof t.Name){const H=k===T.Num;return I?H?(0,t._)`"[" + ${b} + "]"`:(0,t._)`"['" + ${b} + "']"`:H?(0,t._)`"/" + ${b}`:(0,t._)`"/" + ${b}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return I?(0,t.getProperty)(b).toString():"/"+y(b)}e.getErrorPath=C;function q(b,k,I=b.opts.strictSchema){if(I){if(k=`strict mode: ${k}`,I===!0)throw new Error(k);b.self.logger.warn(k)}}e.checkStrictMode=q})(ee);var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0});const we=K,vc={data:new we.Name("data"),valCxt:new we.Name("valCxt"),instancePath:new we.Name("instancePath"),parentData:new we.Name("parentData"),parentDataProperty:new we.Name("parentDataProperty"),rootData:new we.Name("rootData"),dynamicAnchors:new we.Name("dynamicAnchors"),vErrors:new we.Name("vErrors"),errors:new we.Name("errors"),this:new we.Name("this"),self:new we.Name("self"),scope:new we.Name("scope"),json:new we.Name("json"),jsonPos:new we.Name("jsonPos"),jsonLen:new we.Name("jsonLen"),jsonPart:new we.Name("jsonPart")};Ve.default=vc;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=K,r=ee,s=Ve;e.keywordError={message:({keyword:v})=>(0,t.str)`must pass "${v}" keyword validation`},e.keyword$DataError={message:({keyword:v,schemaType:g})=>g?(0,t.str)`"${v}" keyword must be ${g} ($data)`:(0,t.str)`"${v}" keyword is invalid ($data)`};function n(v,g=e.keywordError,E,T){const{it:C}=v,{gen:q,compositeRule:b,allErrors:k}=C,I=y(v,g,E);T??(b||k)?h(q,I):l(C,(0,t._)`[${I}]`)}e.reportError=n;function o(v,g=e.keywordError,E){const{it:T}=v,{gen:C,compositeRule:q,allErrors:b}=T,k=y(v,g,E);h(C,k),q||b||l(T,s.default.vErrors)}e.reportExtraError=o;function i(v,g){v.assign(s.default.errors,g),v.if((0,t._)`${s.default.vErrors} !== null`,()=>v.if(g,()=>v.assign((0,t._)`${s.default.vErrors}.length`,g),()=>v.assign(s.default.vErrors,null)))}e.resetErrorsCount=i;function p({gen:v,keyword:g,schemaValue:E,data:T,errsCount:C,it:q}){if(C===void 0)throw new Error("ajv implementation error");const b=v.name("err");v.forRange("i",C,s.default.errors,k=>{v.const(b,(0,t._)`${s.default.vErrors}[${k}]`),v.if((0,t._)`${b}.instancePath === undefined`,()=>v.assign((0,t._)`${b}.instancePath`,(0,t.strConcat)(s.default.instancePath,q.errorPath))),v.assign((0,t._)`${b}.schemaPath`,(0,t.str)`${q.errSchemaPath}/${g}`),q.opts.verbose&&(v.assign((0,t._)`${b}.schema`,E),v.assign((0,t._)`${b}.data`,T))})}e.extendErrors=p;function h(v,g){const E=v.const("err",g);v.if((0,t._)`${s.default.vErrors} === null`,()=>v.assign(s.default.vErrors,(0,t._)`[${E}]`),(0,t._)`${s.default.vErrors}.push(${E})`),v.code((0,t._)`${s.default.errors}++`)}function l(v,g){const{gen:E,validateName:T,schemaEnv:C}=v;C.$async?E.throw((0,t._)`new ${v.ValidationError}(${g})`):(E.assign((0,t._)`${T}.errors`,g),E.return(!1))}const d={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function y(v,g,E){const{createErrors:T}=v.it;return T===!1?(0,t._)`{}`:w(v,g,E)}function w(v,g,E={}){const{gen:T,it:C}=v,q=[x(C,E),_(v,E)];return S(v,g,q),T.object(...q)}function x({errorPath:v},{instancePath:g}){const E=g?(0,t.str)`${v}${(0,r.getErrorPath)(g,r.Type.Str)}`:v;return[s.default.instancePath,(0,t.strConcat)(s.default.instancePath,E)]}function _({keyword:v,it:{errSchemaPath:g}},{schemaPath:E,parentSchema:T}){let C=T?g:(0,t.str)`${g}/${v}`;return E&&(C=(0,t.str)`${C}${(0,r.getErrorPath)(E,r.Type.Str)}`),[d.schemaPath,C]}function S(v,{params:g,message:E},T){const{keyword:C,data:q,schemaValue:b,it:k}=v,{opts:I,propertyName:H,topSchemaRef:G,schemaPath:ae}=k;T.push([d.keyword,C],[d.params,typeof g=="function"?g(v):g||(0,t._)`{}`]),I.messages&&T.push([d.message,typeof E=="function"?E(v):E]),I.verbose&&T.push([d.schema,b],[d.parentSchema,(0,t._)`${G}${ae}`],[s.default.data,q]),H&&T.push([d.propertyName,H])}})(vr);Object.defineProperty(Lt,"__esModule",{value:!0});Lt.boolOrEmptySchema=Lt.topBoolOrEmptySchema=void 0;const $c=vr,_c=K,bc=Ve,Pc={message:"boolean schema is false"};function Ec(e){const{gen:t,schema:r,validateName:s}=e;r===!1?ri(e,!1):typeof r=="object"&&r.$async===!0?t.return(bc.default.data):(t.assign((0,_c._)`${s}.errors`,null),t.return(!0))}Lt.topBoolOrEmptySchema=Ec;function Sc(e,t){const{gen:r,schema:s}=e;s===!1?(r.var(t,!1),ri(e)):r.var(t,!0)}Lt.boolOrEmptySchema=Sc;function ri(e,t){const{gen:r,data:s}=e,n={gen:r,keyword:"false schema",data:s,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,$c.reportError)(n,Pc,void 0,t)}var $r={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.getRules=vt.isJSONType=void 0;const kc=["string","number","integer","boolean","null","object","array"],Tc=new Set(kc);function xc(e){return typeof e=="string"&&Tc.has(e)}vt.isJSONType=xc;function Rc(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}vt.getRules=Rc;var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.shouldUseRule=Ze.shouldUseGroup=Ze.schemaHasRulesForType=void 0;function jc({schema:e,self:t},r){const s=t.RULES.types[r];return s&&s!==!0&&si(e,s)}Ze.schemaHasRulesForType=jc;function si(e,t){return t.rules.some(r=>ni(e,r))}Ze.shouldUseGroup=si;function ni(e,t){var r;return e[t.keyword]!==void 0||((r=t.definition.implements)===null||r===void 0?void 0:r.some(s=>e[s]!==void 0))}Ze.shouldUseRule=ni;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=vt,r=Ze,s=vr,n=K,o=ee;var i;(function(T){T[T.Correct=0]="Correct",T[T.Wrong=1]="Wrong"})(i=e.DataType||(e.DataType={}));function p(T){const C=h(T.type);if(C.includes("null")){if(T.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!C.length&&T.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');T.nullable===!0&&C.push("null")}return C}e.getSchemaTypes=p;function h(T){const C=Array.isArray(T)?T:T?[T]:[];if(C.every(t.isJSONType))return C;throw new Error("type must be JSONType or JSONType[]: "+C.join(","))}e.getJSONTypes=h;function l(T,C){const{gen:q,data:b,opts:k}=T,I=y(C,k.coerceTypes),H=C.length>0&&!(I.length===0&&C.length===1&&(0,r.schemaHasRulesForType)(T,C[0]));if(H){const G=S(C,b,k.strictNumbers,i.Wrong);q.if(G,()=>{I.length?w(T,C,I):g(T)})}return H}e.coerceAndCheckDataType=l;const d=new Set(["string","number","integer","boolean","null"]);function y(T,C){return C?T.filter(q=>d.has(q)||C==="array"&&q==="array"):[]}function w(T,C,q){const{gen:b,data:k,opts:I}=T,H=b.let("dataType",(0,n._)`typeof ${k}`),G=b.let("coerced",(0,n._)`undefined`);I.coerceTypes==="array"&&b.if((0,n._)`${H} == 'object' && Array.isArray(${k}) && ${k}.length == 1`,()=>b.assign(k,(0,n._)`${k}[0]`).assign(H,(0,n._)`typeof ${k}`).if(S(C,k,I.strictNumbers),()=>b.assign(G,k))),b.if((0,n._)`${G} !== undefined`);for(const Y of q)(d.has(Y)||Y==="array"&&I.coerceTypes==="array")&&ae(Y);b.else(),g(T),b.endIf(),b.if((0,n._)`${G} !== undefined`,()=>{b.assign(k,G),x(T,G)});function ae(Y){switch(Y){case"string":b.elseIf((0,n._)`${H} == "number" || ${H} == "boolean"`).assign(G,(0,n._)`"" + ${k}`).elseIf((0,n._)`${k} === null`).assign(G,(0,n._)`""`);return;case"number":b.elseIf((0,n._)`${H} == "boolean" || ${k} === null
              || (${H} == "string" && ${k} && ${k} == +${k})`).assign(G,(0,n._)`+${k}`);return;case"integer":b.elseIf((0,n._)`${H} === "boolean" || ${k} === null
              || (${H} === "string" && ${k} && ${k} == +${k} && !(${k} % 1))`).assign(G,(0,n._)`+${k}`);return;case"boolean":b.elseIf((0,n._)`${k} === "false" || ${k} === 0 || ${k} === null`).assign(G,!1).elseIf((0,n._)`${k} === "true" || ${k} === 1`).assign(G,!0);return;case"null":b.elseIf((0,n._)`${k} === "" || ${k} === 0 || ${k} === false`),b.assign(G,null);return;case"array":b.elseIf((0,n._)`${H} === "string" || ${H} === "number"
              || ${H} === "boolean" || ${k} === null`).assign(G,(0,n._)`[${k}]`)}}}function x({gen:T,parentData:C,parentDataProperty:q},b){T.if((0,n._)`${C} !== undefined`,()=>T.assign((0,n._)`${C}[${q}]`,b))}function _(T,C,q,b=i.Correct){const k=b===i.Correct?n.operators.EQ:n.operators.NEQ;let I;switch(T){case"null":return(0,n._)`${C} ${k} null`;case"array":I=(0,n._)`Array.isArray(${C})`;break;case"object":I=(0,n._)`${C} && typeof ${C} == "object" && !Array.isArray(${C})`;break;case"integer":I=H((0,n._)`!(${C} % 1) && !isNaN(${C})`);break;case"number":I=H();break;default:return(0,n._)`typeof ${C} ${k} ${T}`}return b===i.Correct?I:(0,n.not)(I);function H(G=n.nil){return(0,n.and)((0,n._)`typeof ${C} == "number"`,G,q?(0,n._)`isFinite(${C})`:n.nil)}}e.checkDataType=_;function S(T,C,q,b){if(T.length===1)return _(T[0],C,q,b);let k;const I=(0,o.toHash)(T);if(I.array&&I.object){const H=(0,n._)`typeof ${C} != "object"`;k=I.null?H:(0,n._)`!${C} || ${H}`,delete I.null,delete I.array,delete I.object}else k=n.nil;I.number&&delete I.integer;for(const H in I)k=(0,n.and)(k,_(H,C,q,b));return k}e.checkDataTypes=S;const v={message:({schema:T})=>`must be ${T}`,params:({schema:T,schemaValue:C})=>typeof T=="string"?(0,n._)`{type: ${T}}`:(0,n._)`{type: ${C}}`};function g(T){const C=E(T);(0,s.reportError)(C,v)}e.reportTypeError=g;function E(T){const{gen:C,data:q,schema:b}=T,k=(0,o.schemaRefOrVal)(T,b,"type");return{gen:C,keyword:"type",data:q,schema:b.type,schemaCode:k,schemaValue:k,parentSchema:b,params:{},it:T}}})($r);var es={};Object.defineProperty(es,"__esModule",{value:!0});es.assignDefaults=void 0;const Ct=K,Nc=ee;function Cc(e,t){const{properties:r,items:s}=e.schema;if(t==="object"&&r)for(const n in r)Xn(e,n,r[n].default);else t==="array"&&Array.isArray(s)&&s.forEach((n,o)=>Xn(e,o,n.default))}es.assignDefaults=Cc;function Xn(e,t,r){const{gen:s,compositeRule:n,data:o,opts:i}=e;if(r===void 0)return;const p=(0,Ct._)`${o}${(0,Ct.getProperty)(t)}`;if(n){(0,Nc.checkStrictMode)(e,`default is ignored for: ${p}`);return}let h=(0,Ct._)`${p} === undefined`;i.useDefaults==="empty"&&(h=(0,Ct._)`${h} || ${p} === null || ${p} === ""`),s.if(h,(0,Ct._)`${p} = ${(0,Ct.stringify)(r)}`)}var He={},B={};Object.defineProperty(B,"__esModule",{value:!0});B.validateUnion=B.validateArray=B.usePattern=B.callValidateCode=B.schemaProperties=B.allSchemaProperties=B.noPropertyInData=B.propertyInData=B.isOwnProperty=B.hasPropFunc=B.reportMissingProp=B.checkMissingProp=B.checkReportMissingProp=void 0;const ie=K,Ws=ee,Xe=Ve,Oc=ee;function Ic(e,t){const{gen:r,data:s,it:n}=e;r.if(Hs(r,s,t,n.opts.ownProperties),()=>{e.setParams({missingProperty:(0,ie._)`${t}`},!0),e.error()})}B.checkReportMissingProp=Ic;function qc({gen:e,data:t,it:{opts:r}},s,n){return(0,ie.or)(...s.map(o=>(0,ie.and)(Hs(e,t,o,r.ownProperties),(0,ie._)`${n} = ${o}`)))}B.checkMissingProp=qc;function Ac(e,t){e.setParams({missingProperty:t},!0),e.error()}B.reportMissingProp=Ac;function oi(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,ie._)`Object.prototype.hasOwnProperty`})}B.hasPropFunc=oi;function zs(e,t,r){return(0,ie._)`${oi(e)}.call(${t}, ${r})`}B.isOwnProperty=zs;function Dc(e,t,r,s){const n=(0,ie._)`${t}${(0,ie.getProperty)(r)} !== undefined`;return s?(0,ie._)`${n} && ${zs(e,t,r)}`:n}B.propertyInData=Dc;function Hs(e,t,r,s){const n=(0,ie._)`${t}${(0,ie.getProperty)(r)} === undefined`;return s?(0,ie.or)(n,(0,ie.not)(zs(e,t,r))):n}B.noPropertyInData=Hs;function ii(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}B.allSchemaProperties=ii;function Mc(e,t){return ii(t).filter(r=>!(0,Ws.alwaysValidSchema)(e,t[r]))}B.schemaProperties=Mc;function Fc({schemaCode:e,data:t,it:{gen:r,topSchemaRef:s,schemaPath:n,errorPath:o},it:i},p,h,l){const d=l?(0,ie._)`${e}, ${t}, ${s}${n}`:t,y=[[Xe.default.instancePath,(0,ie.strConcat)(Xe.default.instancePath,o)],[Xe.default.parentData,i.parentData],[Xe.default.parentDataProperty,i.parentDataProperty],[Xe.default.rootData,Xe.default.rootData]];i.opts.dynamicRef&&y.push([Xe.default.dynamicAnchors,Xe.default.dynamicAnchors]);const w=(0,ie._)`${d}, ${r.object(...y)}`;return h!==ie.nil?(0,ie._)`${p}.call(${h}, ${w})`:(0,ie._)`${p}(${w})`}B.callValidateCode=Fc;const Uc=(0,ie._)`new RegExp`;function Lc({gen:e,it:{opts:t}},r){const s=t.unicodeRegExp?"u":"",{regExp:n}=t.code,o=n(r,s);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,ie._)`${n.code==="new RegExp"?Uc:(0,Oc.useFunc)(e,n)}(${r}, ${s})`})}B.usePattern=Lc;function Wc(e){const{gen:t,data:r,keyword:s,it:n}=e,o=t.name("valid");if(n.allErrors){const p=t.let("valid",!0);return i(()=>t.assign(p,!1)),p}return t.var(o,!0),i(()=>t.break()),o;function i(p){const h=t.const("len",(0,ie._)`${r}.length`);t.forRange("i",0,h,l=>{e.subschema({keyword:s,dataProp:l,dataPropType:Ws.Type.Num},o),t.if((0,ie.not)(o),p)})}}B.validateArray=Wc;function zc(e){const{gen:t,schema:r,keyword:s,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(p=>(0,Ws.alwaysValidSchema)(n,p))&&!n.opts.unevaluated)return;const o=t.let("valid",!1),i=t.name("_valid");t.block(()=>r.forEach((p,h)=>{const l=e.subschema({keyword:s,schemaProp:h,compositeRule:!0},i);t.assign(o,(0,ie._)`${o} || ${i}`),e.mergeValidEvaluated(l,i)||t.if((0,ie.not)(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))}B.validateUnion=zc;Object.defineProperty(He,"__esModule",{value:!0});He.validateKeywordUsage=He.validSchemaType=He.funcKeywordCode=He.macroKeywordCode=void 0;const _e=K,ht=Ve,Hc=B,Vc=vr;function Bc(e,t){const{gen:r,keyword:s,schema:n,parentSchema:o,it:i}=e,p=t.macro.call(i.self,n,o,i),h=ai(r,s,p);i.opts.validateSchema!==!1&&i.self.validateSchema(p,!0);const l=r.name("valid");e.subschema({schema:p,schemaPath:_e.nil,errSchemaPath:`${i.errSchemaPath}/${s}`,topSchemaRef:h,compositeRule:!0},l),e.pass(l,()=>e.error(!0))}He.macroKeywordCode=Bc;function Kc(e,t){var r;const{gen:s,keyword:n,schema:o,parentSchema:i,$data:p,it:h}=e;Jc(h,t);const l=!p&&t.compile?t.compile.call(h.self,o,i,h):t.validate,d=ai(s,n,l),y=s.let("valid");e.block$data(y,w),e.ok((r=t.valid)!==null&&r!==void 0?r:y);function w(){if(t.errors===!1)S(),t.modifying&&eo(e),v(()=>e.error());else{const g=t.async?x():_();t.modifying&&eo(e),v(()=>Gc(e,g))}}function x(){const g=s.let("ruleErrs",null);return s.try(()=>S((0,_e._)`await `),E=>s.assign(y,!1).if((0,_e._)`${E} instanceof ${h.ValidationError}`,()=>s.assign(g,(0,_e._)`${E}.errors`),()=>s.throw(E))),g}function _(){const g=(0,_e._)`${d}.errors`;return s.assign(g,null),S(_e.nil),g}function S(g=t.async?(0,_e._)`await `:_e.nil){const E=h.opts.passContext?ht.default.this:ht.default.self,T=!("compile"in t&&!p||t.schema===!1);s.assign(y,(0,_e._)`${g}${(0,Hc.callValidateCode)(e,d,E,T)}`,t.modifying)}function v(g){var E;s.if((0,_e.not)((E=t.valid)!==null&&E!==void 0?E:y),g)}}He.funcKeywordCode=Kc;function eo(e){const{gen:t,data:r,it:s}=e;t.if(s.parentData,()=>t.assign(r,(0,_e._)`${s.parentData}[${s.parentDataProperty}]`))}function Gc(e,t){const{gen:r}=e;r.if((0,_e._)`Array.isArray(${t})`,()=>{r.assign(ht.default.vErrors,(0,_e._)`${ht.default.vErrors} === null ? ${t} : ${ht.default.vErrors}.concat(${t})`).assign(ht.default.errors,(0,_e._)`${ht.default.vErrors}.length`),(0,Vc.extendErrors)(e)},()=>e.error())}function Jc({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function ai(e,t,r){if(r===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,_e.stringify)(r)})}function Zc(e,t,r=!1){return!t.length||t.some(s=>s==="array"?Array.isArray(e):s==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==s||r&&typeof e>"u")}He.validSchemaType=Zc;function Yc({schema:e,opts:t,self:r,errSchemaPath:s},n,o){if(Array.isArray(n.keyword)?!n.keyword.includes(o):n.keyword!==o)throw new Error("ajv implementation error");const i=n.dependencies;if(i!=null&&i.some(p=>!Object.prototype.hasOwnProperty.call(e,p)))throw new Error(`parent schema must have dependencies of ${o}: ${i.join(",")}`);if(n.validateSchema&&!n.validateSchema(e[o])){const p=`keyword "${o}" value is invalid at path "${s}": `+r.errorsText(n.validateSchema.errors);if(t.validateSchema==="log")r.logger.error(p);else throw new Error(p)}}He.validateKeywordUsage=Yc;var st={};Object.defineProperty(st,"__esModule",{value:!0});st.extendSubschemaMode=st.extendSubschemaData=st.getSubschema=void 0;const ze=K,ci=ee;function Qc(e,{keyword:t,schemaProp:r,schema:s,schemaPath:n,errSchemaPath:o,topSchemaRef:i}){if(t!==void 0&&s!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const p=e.schema[t];return r===void 0?{schema:p,schemaPath:(0,ze._)`${e.schemaPath}${(0,ze.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:p[r],schemaPath:(0,ze._)`${e.schemaPath}${(0,ze.getProperty)(t)}${(0,ze.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,ci.escapeFragment)(r)}`}}if(s!==void 0){if(n===void 0||o===void 0||i===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:s,schemaPath:n,topSchemaRef:i,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}st.getSubschema=Qc;function Xc(e,t,{dataProp:r,dataPropType:s,data:n,dataTypes:o,propertyName:i}){if(n!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:p}=t;if(r!==void 0){const{errorPath:l,dataPathArr:d,opts:y}=t,w=p.let("data",(0,ze._)`${t.data}${(0,ze.getProperty)(r)}`,!0);h(w),e.errorPath=(0,ze.str)`${l}${(0,ci.getErrorPath)(r,s,y.jsPropertySyntax)}`,e.parentDataProperty=(0,ze._)`${r}`,e.dataPathArr=[...d,e.parentDataProperty]}if(n!==void 0){const l=n instanceof ze.Name?n:p.let("data",n,!0);h(l),i!==void 0&&(e.propertyName=i)}o&&(e.dataTypes=o);function h(l){e.data=l,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,l]}}st.extendSubschemaData=Xc;function el(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:s,createErrors:n,allErrors:o}){s!==void 0&&(e.compositeRule=s),n!==void 0&&(e.createErrors=n),o!==void 0&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r}st.extendSubschemaMode=el;var ye={},li=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var s,n,o;if(Array.isArray(t)){if(s=t.length,s!=r.length)return!1;for(n=s;n--!==0;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(o=Object.keys(t),s=o.length,s!==Object.keys(r).length)return!1;for(n=s;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=s;n--!==0;){var i=o[n];if(!e(t[i],r[i]))return!1}return!0}return t!==t&&r!==r},pi={exports:{}},rt=pi.exports=function(e,t,r){typeof t=="function"&&(r=t,t={}),r=t.cb||r;var s=typeof r=="function"?r:r.pre||function(){},n=r.post||function(){};Mr(t,s,n,e,"",e)};rt.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};rt.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};rt.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};rt.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Mr(e,t,r,s,n,o,i,p,h,l){if(s&&typeof s=="object"&&!Array.isArray(s)){t(s,n,o,i,p,h,l);for(var d in s){var y=s[d];if(Array.isArray(y)){if(d in rt.arrayKeywords)for(var w=0;w<y.length;w++)Mr(e,t,r,y[w],n+"/"+d+"/"+w,o,n,d,s,w)}else if(d in rt.propsKeywords){if(y&&typeof y=="object")for(var x in y)Mr(e,t,r,y[x],n+"/"+d+"/"+tl(x),o,n,d,s,x)}else(d in rt.keywords||e.allKeys&&!(d in rt.skipKeywords))&&Mr(e,t,r,y,n+"/"+d,o,n,d,s)}r(s,n,o,i,p,h,l)}}function tl(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}var rl=pi.exports;Object.defineProperty(ye,"__esModule",{value:!0});ye.getSchemaRefs=ye.resolveUrl=ye.normalizeId=ye._getFullPath=ye.getFullPath=ye.inlineRef=void 0;const sl=ee,nl=li,ol=rl,il=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function al(e,t=!0){return typeof e=="boolean"?!0:t===!0?!js(e):t?ui(e)<=t:!1}ye.inlineRef=al;const cl=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function js(e){for(const t in e){if(cl.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(js)||typeof r=="object"&&js(r))return!0}return!1}function ui(e){let t=0;for(const r in e)if(r==="$ref"||(t++,!il.has(r)&&(typeof e[r]=="object"&&(0,sl.eachItem)(e[r],s=>t+=ui(s)),t===1/0)))return 1/0;return t}function di(e,t="",r){r!==!1&&(t=Ut(t));const s=e.parse(t);return hi(e,s)}ye.getFullPath=di;function hi(e,t){return e.serialize(t).split("#")[0]+"#"}ye._getFullPath=hi;const ll=/#\/?$/;function Ut(e){return e?e.replace(ll,""):""}ye.normalizeId=Ut;function pl(e,t,r){return r=Ut(r),e.resolve(t,r)}ye.resolveUrl=pl;const ul=/^[a-z_][-a-z0-9._]*$/i;function dl(e,t){if(typeof e=="boolean")return{};const{schemaId:r,uriResolver:s}=this.opts,n=Ut(e[r]||t),o={"":n},i=di(s,n,!1),p={},h=new Set;return ol(e,{allKeys:!0},(y,w,x,_)=>{if(_===void 0)return;const S=i+w;let v=o[_];typeof y[r]=="string"&&(v=g.call(this,y[r])),E.call(this,y.$anchor),E.call(this,y.$dynamicAnchor),o[w]=v;function g(T){const C=this.opts.uriResolver.resolve;if(T=Ut(v?C(v,T):T),h.has(T))throw d(T);h.add(T);let q=this.refs[T];return typeof q=="string"&&(q=this.refs[q]),typeof q=="object"?l(y,q.schema,T):T!==Ut(S)&&(T[0]==="#"?(l(y,p[T],T),p[T]=y):this.refs[T]=S),T}function E(T){if(typeof T=="string"){if(!ul.test(T))throw new Error(`invalid anchor "${T}"`);g.call(this,`#${T}`)}}}),p;function l(y,w,x){if(w!==void 0&&!nl(y,w))throw d(x)}function d(y){return new Error(`reference "${y}" resolves to more than one schema`)}}ye.getSchemaRefs=dl;Object.defineProperty(qe,"__esModule",{value:!0});qe.getData=qe.KeywordCxt=qe.validateFunctionCode=void 0;const fi=Lt,to=$r,Vs=Ze,Hr=$r,hl=es,ur=He,is=st,F=K,z=Ve,fl=ye,Ye=ee,er=vr;function ml(e){if(gi(e)&&(wi(e),yi(e))){wl(e);return}mi(e,()=>(0,fi.topBoolOrEmptySchema)(e))}qe.validateFunctionCode=ml;function mi({gen:e,validateName:t,schema:r,schemaEnv:s,opts:n},o){n.code.es5?e.func(t,(0,F._)`${z.default.data}, ${z.default.valCxt}`,s.$async,()=>{e.code((0,F._)`"use strict"; ${ro(r,n)}`),gl(e,n),e.code(o)}):e.func(t,(0,F._)`${z.default.data}, ${yl(n)}`,s.$async,()=>e.code(ro(r,n)).code(o))}function yl(e){return(0,F._)`{${z.default.instancePath}="", ${z.default.parentData}, ${z.default.parentDataProperty}, ${z.default.rootData}=${z.default.data}${e.dynamicRef?(0,F._)`, ${z.default.dynamicAnchors}={}`:F.nil}}={}`}function gl(e,t){e.if(z.default.valCxt,()=>{e.var(z.default.instancePath,(0,F._)`${z.default.valCxt}.${z.default.instancePath}`),e.var(z.default.parentData,(0,F._)`${z.default.valCxt}.${z.default.parentData}`),e.var(z.default.parentDataProperty,(0,F._)`${z.default.valCxt}.${z.default.parentDataProperty}`),e.var(z.default.rootData,(0,F._)`${z.default.valCxt}.${z.default.rootData}`),t.dynamicRef&&e.var(z.default.dynamicAnchors,(0,F._)`${z.default.valCxt}.${z.default.dynamicAnchors}`)},()=>{e.var(z.default.instancePath,(0,F._)`""`),e.var(z.default.parentData,(0,F._)`undefined`),e.var(z.default.parentDataProperty,(0,F._)`undefined`),e.var(z.default.rootData,z.default.data),t.dynamicRef&&e.var(z.default.dynamicAnchors,(0,F._)`{}`)})}function wl(e){const{schema:t,opts:r,gen:s}=e;mi(e,()=>{r.$comment&&t.$comment&&$i(e),Pl(e),s.let(z.default.vErrors,null),s.let(z.default.errors,0),r.unevaluated&&vl(e),vi(e),kl(e)})}function vl(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",(0,F._)`${r}.evaluated`),t.if((0,F._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,F._)`${e.evaluated}.props`,(0,F._)`undefined`)),t.if((0,F._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,F._)`${e.evaluated}.items`,(0,F._)`undefined`))}function ro(e,t){const r=typeof e=="object"&&e[t.schemaId];return r&&(t.code.source||t.code.process)?(0,F._)`/*# sourceURL=${r} */`:F.nil}function $l(e,t){if(gi(e)&&(wi(e),yi(e))){_l(e,t);return}(0,fi.boolOrEmptySchema)(e,t)}function yi({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function gi(e){return typeof e.schema!="boolean"}function _l(e,t){const{schema:r,gen:s,opts:n}=e;n.$comment&&r.$comment&&$i(e),El(e),Sl(e);const o=s.const("_errs",z.default.errors);vi(e,o),s.var(t,(0,F._)`${o} === ${z.default.errors}`)}function wi(e){(0,Ye.checkUnknownRules)(e),bl(e)}function vi(e,t){if(e.opts.jtd)return so(e,[],!1,t);const r=(0,to.getSchemaTypes)(e.schema),s=(0,to.coerceAndCheckDataType)(e,r);so(e,r,!s,t)}function bl(e){const{schema:t,errSchemaPath:r,opts:s,self:n}=e;t.$ref&&s.ignoreKeywordsWithRef&&(0,Ye.schemaHasRulesButRef)(t,n.RULES)&&n.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function Pl(e){const{schema:t,opts:r}=e;t.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Ye.checkStrictMode)(e,"default is ignored in the schema root")}function El(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,fl.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function Sl(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function $i({gen:e,schemaEnv:t,schema:r,errSchemaPath:s,opts:n}){const o=r.$comment;if(n.$comment===!0)e.code((0,F._)`${z.default.self}.logger.log(${o})`);else if(typeof n.$comment=="function"){const i=(0,F.str)`${s}/$comment`,p=e.scopeValue("root",{ref:t.root});e.code((0,F._)`${z.default.self}.opts.$comment(${o}, ${i}, ${p}.schema)`)}}function kl(e){const{gen:t,schemaEnv:r,validateName:s,ValidationError:n,opts:o}=e;r.$async?t.if((0,F._)`${z.default.errors} === 0`,()=>t.return(z.default.data),()=>t.throw((0,F._)`new ${n}(${z.default.vErrors})`)):(t.assign((0,F._)`${s}.errors`,z.default.vErrors),o.unevaluated&&Tl(e),t.return((0,F._)`${z.default.errors} === 0`))}function Tl({gen:e,evaluated:t,props:r,items:s}){r instanceof F.Name&&e.assign((0,F._)`${t}.props`,r),s instanceof F.Name&&e.assign((0,F._)`${t}.items`,s)}function so(e,t,r,s){const{gen:n,schema:o,data:i,allErrors:p,opts:h,self:l}=e,{RULES:d}=l;if(o.$ref&&(h.ignoreKeywordsWithRef||!(0,Ye.schemaHasRulesButRef)(o,d))){n.block(()=>Pi(e,"$ref",d.all.$ref.definition));return}h.jtd||xl(e,t),n.block(()=>{for(const w of d.rules)y(w);y(d.post)});function y(w){(0,Vs.shouldUseGroup)(o,w)&&(w.type?(n.if((0,Hr.checkDataType)(w.type,i,h.strictNumbers)),no(e,w),t.length===1&&t[0]===w.type&&r&&(n.else(),(0,Hr.reportTypeError)(e)),n.endIf()):no(e,w),p||n.if((0,F._)`${z.default.errors} === ${s||0}`))}}function no(e,t){const{gen:r,schema:s,opts:{useDefaults:n}}=e;n&&(0,hl.assignDefaults)(e,t.type),r.block(()=>{for(const o of t.rules)(0,Vs.shouldUseRule)(s,o)&&Pi(e,o.keyword,o.definition,t.type)})}function xl(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(Rl(e,t),e.opts.allowUnionTypes||jl(e,t),Nl(e,e.dataTypes))}function Rl(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(r=>{_i(e.dataTypes,r)||Bs(e,`type "${r}" not allowed by context "${e.dataTypes.join(",")}"`)}),Ol(e,t)}}function jl(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&Bs(e,"use allowUnionTypes to allow union type keyword")}function Nl(e,t){const r=e.self.RULES.all;for(const s in r){const n=r[s];if(typeof n=="object"&&(0,Vs.shouldUseRule)(e.schema,n)){const{type:o}=n.definition;o.length&&!o.some(i=>Cl(t,i))&&Bs(e,`missing type "${o.join(",")}" for keyword "${s}"`)}}}function Cl(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function _i(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function Ol(e,t){const r=[];for(const s of e.dataTypes)_i(t,s)?r.push(s):t.includes("integer")&&s==="number"&&r.push("integer");e.dataTypes=r}function Bs(e,t){const r=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${r}" (strictTypes)`,(0,Ye.checkStrictMode)(e,t,e.opts.strictTypes)}class bi{constructor(t,r,s){if((0,ur.validateKeywordUsage)(t,r,s),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=s,this.data=t.data,this.schema=t.schema[s],this.$data=r.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Ye.schemaRefOrVal)(t,this.schema,s,this.$data),this.schemaType=r.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=r,this.$data)this.schemaCode=t.gen.const("vSchema",Ei(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,ur.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${s} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=t.gen.const("_errs",z.default.errors))}result(t,r,s){this.failResult((0,F.not)(t),r,s)}failResult(t,r,s){this.gen.if(t),s?s():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,r){this.failResult((0,F.not)(t),void 0,r)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:r}=this;this.fail((0,F._)`${r} !== undefined && (${(0,F.or)(this.invalid$data(),t)})`)}error(t,r,s){if(r){this.setParams(r),this._error(t,s),this.setParams({});return}this._error(t,s)}_error(t,r){(t?er.reportExtraError:er.reportError)(this,this.def.error,r)}$dataError(){(0,er.reportError)(this,this.def.$dataError||er.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,er.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,r){r?Object.assign(this.params,t):this.params=t}block$data(t,r,s=F.nil){this.gen.block(()=>{this.check$data(t,s),r()})}check$data(t=F.nil,r=F.nil){if(!this.$data)return;const{gen:s,schemaCode:n,schemaType:o,def:i}=this;s.if((0,F.or)((0,F._)`${n} === undefined`,r)),t!==F.nil&&s.assign(t,!0),(o.length||i.validateSchema)&&(s.elseIf(this.invalid$data()),this.$dataError(),t!==F.nil&&s.assign(t,!1)),s.else()}invalid$data(){const{gen:t,schemaCode:r,schemaType:s,def:n,it:o}=this;return(0,F.or)(i(),p());function i(){if(s.length){if(!(r instanceof F.Name))throw new Error("ajv implementation error");const h=Array.isArray(s)?s:[s];return(0,F._)`${(0,Hr.checkDataTypes)(h,r,o.opts.strictNumbers,Hr.DataType.Wrong)}`}return F.nil}function p(){if(n.validateSchema){const h=t.scopeValue("validate$data",{ref:n.validateSchema});return(0,F._)`!${h}(${r})`}return F.nil}}subschema(t,r){const s=(0,is.getSubschema)(this.it,t);(0,is.extendSubschemaData)(s,this.it,t),(0,is.extendSubschemaMode)(s,t);const n={...this.it,...s,items:void 0,props:void 0};return $l(n,r),n}mergeEvaluated(t,r){const{it:s,gen:n}=this;s.opts.unevaluated&&(s.props!==!0&&t.props!==void 0&&(s.props=Ye.mergeEvaluated.props(n,t.props,s.props,r)),s.items!==!0&&t.items!==void 0&&(s.items=Ye.mergeEvaluated.items(n,t.items,s.items,r)))}mergeValidEvaluated(t,r){const{it:s,gen:n}=this;if(s.opts.unevaluated&&(s.props!==!0||s.items!==!0))return n.if(r,()=>this.mergeEvaluated(t,F.Name)),!0}}qe.KeywordCxt=bi;function Pi(e,t,r,s){const n=new bi(e,r,t);"code"in r?r.code(n,s):n.$data&&r.validate?(0,ur.funcKeywordCode)(n,r):"macro"in r?(0,ur.macroKeywordCode)(n,r):(r.compile||r.validate)&&(0,ur.funcKeywordCode)(n,r)}const Il=/^\/(?:[^~]|~0|~1)*$/,ql=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Ei(e,{dataLevel:t,dataNames:r,dataPathArr:s}){let n,o;if(e==="")return z.default.rootData;if(e[0]==="/"){if(!Il.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);n=e,o=z.default.rootData}else{const l=ql.exec(e);if(!l)throw new Error(`Invalid JSON-pointer: ${e}`);const d=+l[1];if(n=l[2],n==="#"){if(d>=t)throw new Error(h("property/index",d));return s[t-d]}if(d>t)throw new Error(h("data",d));if(o=r[t-d],!n)return o}let i=o;const p=n.split("/");for(const l of p)l&&(o=(0,F._)`${o}${(0,F.getProperty)((0,Ye.unescapeJsonPointer)(l))}`,i=(0,F._)`${i} && ${o}`);return i;function h(l,d){return`Cannot access ${l} ${d} levels up, current level is ${t}`}}qe.getData=Ei;var _r={};Object.defineProperty(_r,"__esModule",{value:!0});class Al extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}_r.default=Al;var br={};Object.defineProperty(br,"__esModule",{value:!0});const as=ye;class Dl extends Error{constructor(t,r,s,n){super(n||`can't resolve reference ${s} from id ${r}`),this.missingRef=(0,as.resolveUrl)(t,r,s),this.missingSchema=(0,as.normalizeId)((0,as.getFullPath)(t,this.missingRef))}}br.default=Dl;var Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.resolveSchema=Ee.getCompilingSchema=Ee.resolveRef=Ee.compileSchema=Ee.SchemaEnv=void 0;const Ce=K,Ml=_r,ut=Ve,Ie=ye,oo=ee,Fl=qe;class ts{constructor(t){var r;this.refs={},this.dynamicAnchors={};let s;typeof t.schema=="object"&&(s=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(r=t.baseId)!==null&&r!==void 0?r:(0,Ie.normalizeId)(s==null?void 0:s[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=s==null?void 0:s.$async,this.refs={}}}Ee.SchemaEnv=ts;function Ks(e){const t=Si.call(this,e);if(t)return t;const r=(0,Ie.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:s,lines:n}=this.opts.code,{ownProperties:o}=this.opts,i=new Ce.CodeGen(this.scope,{es5:s,lines:n,ownProperties:o});let p;e.$async&&(p=i.scopeValue("Error",{ref:Ml.default,code:(0,Ce._)`require("ajv/dist/runtime/validation_error").default`}));const h=i.scopeName("validate");e.validateName=h;const l={gen:i,allErrors:this.opts.allErrors,data:ut.default.data,parentData:ut.default.parentData,parentDataProperty:ut.default.parentDataProperty,dataNames:[ut.default.data],dataPathArr:[Ce.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:i.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Ce.stringify)(e.schema)}:{ref:e.schema}),validateName:h,ValidationError:p,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:Ce.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Ce._)`""`,opts:this.opts,self:this};let d;try{this._compilations.add(e),(0,Fl.validateFunctionCode)(l),i.optimize(this.opts.code.optimize);const y=i.toString();d=`${i.scopeRefs(ut.default.scope)}return ${y}`,this.opts.code.process&&(d=this.opts.code.process(d,e));const w=new Function(`${ut.default.self}`,`${ut.default.scope}`,d)(this,this.scope.get());if(this.scope.value(h,{ref:w}),w.errors=null,w.schema=e.schema,w.schemaEnv=e,e.$async&&(w.$async=!0),this.opts.code.source===!0&&(w.source={validateName:h,validateCode:y,scopeValues:i._values}),this.opts.unevaluated){const{props:x,items:_}=l;w.evaluated={props:x instanceof Ce.Name?void 0:x,items:_ instanceof Ce.Name?void 0:_,dynamicProps:x instanceof Ce.Name,dynamicItems:_ instanceof Ce.Name},w.source&&(w.source.evaluated=(0,Ce.stringify)(w.evaluated))}return e.validate=w,e}catch(y){throw delete e.validate,delete e.validateName,d&&this.logger.error("Error compiling schema, function code:",d),y}finally{this._compilations.delete(e)}}Ee.compileSchema=Ks;function Ul(e,t,r){var s;r=(0,Ie.resolveUrl)(this.opts.uriResolver,t,r);const n=e.refs[r];if(n)return n;let o=zl.call(this,e,r);if(o===void 0){const i=(s=e.localRefs)===null||s===void 0?void 0:s[r],{schemaId:p}=this.opts;i&&(o=new ts({schema:i,schemaId:p,root:e,baseId:t}))}if(o!==void 0)return e.refs[r]=Ll.call(this,o)}Ee.resolveRef=Ul;function Ll(e){return(0,Ie.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Ks.call(this,e)}function Si(e){for(const t of this._compilations)if(Wl(t,e))return t}Ee.getCompilingSchema=Si;function Wl(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function zl(e,t){let r;for(;typeof(r=this.refs[t])=="string";)t=r;return r||this.schemas[t]||rs.call(this,e,t)}function rs(e,t){const r=this.opts.uriResolver.parse(t),s=(0,Ie._getFullPath)(this.opts.uriResolver,r);let n=(0,Ie.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&s===n)return cs.call(this,r,e);const o=(0,Ie.normalizeId)(s),i=this.refs[o]||this.schemas[o];if(typeof i=="string"){const p=rs.call(this,e,i);return typeof(p==null?void 0:p.schema)!="object"?void 0:cs.call(this,r,p)}if(typeof(i==null?void 0:i.schema)=="object"){if(i.validate||Ks.call(this,i),o===(0,Ie.normalizeId)(t)){const{schema:p}=i,{schemaId:h}=this.opts,l=p[h];return l&&(n=(0,Ie.resolveUrl)(this.opts.uriResolver,n,l)),new ts({schema:p,schemaId:h,root:e,baseId:n})}return cs.call(this,r,i)}}Ee.resolveSchema=rs;const Hl=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function cs(e,{baseId:t,schema:r,root:s}){var n;if(((n=e.fragment)===null||n===void 0?void 0:n[0])!=="/")return;for(const p of e.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const h=r[(0,oo.unescapeFragment)(p)];if(h===void 0)return;r=h;const l=typeof r=="object"&&r[this.opts.schemaId];!Hl.has(p)&&l&&(t=(0,Ie.resolveUrl)(this.opts.uriResolver,t,l))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,oo.schemaHasRulesButRef)(r,this.RULES)){const p=(0,Ie.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=rs.call(this,s,p)}const{schemaId:i}=this.opts;if(o=o||new ts({schema:r,schemaId:i,root:s,baseId:t}),o.schema!==o.root.schema)return o}const Vl="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Bl="Meta-schema for $data reference (JSON AnySchema extension proposal)",Kl="object",Gl=["$data"],Jl={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Zl=!1,Yl={$id:Vl,description:Bl,type:Kl,required:Gl,properties:Jl,additionalProperties:Zl};var Gs={},Ns={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(r,s){s(t)})(gc,function(r){function s(){for(var a=arguments.length,u=Array(a),f=0;f<a;f++)u[f]=arguments[f];if(u.length>1){u[0]=u[0].slice(0,-1);for(var R=u.length-1,N=1;N<R;++N)u[N]=u[N].slice(1,-1);return u[R]=u[R].slice(1),u.join("")}else return u[0]}function n(a){return"(?:"+a+")"}function o(a){return a===void 0?"undefined":a===null?"null":Object.prototype.toString.call(a).split(" ").pop().split("]").shift().toLowerCase()}function i(a){return a.toUpperCase()}function p(a){return a!=null?a instanceof Array?a:typeof a.length!="number"||a.split||a.setInterval||a.call?[a]:Array.prototype.slice.call(a):[]}function h(a,u){var f=a;if(u)for(var R in u)f[R]=u[R];return f}function l(a){var u="[A-Za-z]",f="[0-9]",R=s(f,"[A-Fa-f]"),N=n(n("%[EFef]"+R+"%"+R+R+"%"+R+R)+"|"+n("%[89A-Fa-f]"+R+"%"+R+R)+"|"+n("%"+R+R)),L="[\\:\\/\\?\\#\\[\\]\\@]",U="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",re=s(L,U),de=a?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",se=a?"[\\uE000-\\uF8FF]":"[]",Q=s(u,f,"[\\-\\.\\_\\~]",de);n(u+s(u,f,"[\\+\\-\\.]")+"*"),n(n(N+"|"+s(Q,U,"[\\:]"))+"*");var oe=n(n("25[0-5]")+"|"+n("2[0-4]"+f)+"|"+n("1"+f+f)+"|"+n("0?[1-9]"+f)+"|0?0?"+f),le=n(oe+"\\."+oe+"\\."+oe+"\\."+oe),V=n(R+"{1,4}"),he=n(n(V+"\\:"+V)+"|"+le),ne=n(n(V+"\\:")+"{6}"+he),xe=n("\\:\\:"+n(V+"\\:")+"{5}"+he),jt=n(n(V)+"?\\:\\:"+n(V+"\\:")+"{4}"+he),Ne=n(n(n(V+"\\:")+"{0,1}"+V)+"?\\:\\:"+n(V+"\\:")+"{3}"+he),Be=n(n(n(V+"\\:")+"{0,2}"+V)+"?\\:\\:"+n(V+"\\:")+"{2}"+he),ct=n(n(n(V+"\\:")+"{0,3}"+V)+"?\\:\\:"+V+"\\:"+he),lt=n(n(n(V+"\\:")+"{0,4}"+V)+"?\\:\\:"+he),Re=n(n(n(V+"\\:")+"{0,5}"+V)+"?\\:\\:"+V),Ke=n(n(n(V+"\\:")+"{0,6}"+V)+"?\\:\\:"),pt=n([ne,xe,jt,Ne,Be,ct,lt,Re,Ke].join("|")),We=n(n(Q+"|"+N)+"+");n("[vV]"+R+"+\\."+s(Q,U,"[\\:]")+"+"),n(n(N+"|"+s(Q,U))+"*");var Sr=n(N+"|"+s(Q,U,"[\\:\\@]"));return n(n(N+"|"+s(Q,U,"[\\@]"))+"+"),n(n(Sr+"|"+s("[\\/\\?]",se))+"*"),{NOT_SCHEME:new RegExp(s("[^]",u,f,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(s("[^\\%\\:]",Q,U),"g"),NOT_HOST:new RegExp(s("[^\\%\\[\\]\\:]",Q,U),"g"),NOT_PATH:new RegExp(s("[^\\%\\/\\:\\@]",Q,U),"g"),NOT_PATH_NOSCHEME:new RegExp(s("[^\\%\\/\\@]",Q,U),"g"),NOT_QUERY:new RegExp(s("[^\\%]",Q,U,"[\\:\\@\\/\\?]",se),"g"),NOT_FRAGMENT:new RegExp(s("[^\\%]",Q,U,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(s("[^]",Q,U),"g"),UNRESERVED:new RegExp(Q,"g"),OTHER_CHARS:new RegExp(s("[^\\%]",Q,re),"g"),PCT_ENCODED:new RegExp(N,"g"),IPV4ADDRESS:new RegExp("^("+le+")$"),IPV6ADDRESS:new RegExp("^\\[?("+pt+")"+n(n("\\%25|\\%(?!"+R+"{2})")+"("+We+")")+"?\\]?$")}}var d=l(!1),y=l(!0),w=function(){function a(u,f){var R=[],N=!0,L=!1,U=void 0;try{for(var re=u[Symbol.iterator](),de;!(N=(de=re.next()).done)&&(R.push(de.value),!(f&&R.length===f));N=!0);}catch(se){L=!0,U=se}finally{try{!N&&re.return&&re.return()}finally{if(L)throw U}}return R}return function(u,f){if(Array.isArray(u))return u;if(Symbol.iterator in Object(u))return a(u,f);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),x=function(a){if(Array.isArray(a)){for(var u=0,f=Array(a.length);u<a.length;u++)f[u]=a[u];return f}else return Array.from(a)},_=2147483647,S=36,v=1,g=26,E=38,T=700,C=72,q=128,b="-",k=/^xn--/,I=/[^\0-\x7E]/,H=/[\x2E\u3002\uFF0E\uFF61]/g,G={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},ae=S-v,Y=Math.floor,ke=String.fromCharCode;function ue(a){throw new RangeError(G[a])}function nt(a,u){for(var f=[],R=a.length;R--;)f[R]=u(a[R]);return f}function ot(a,u){var f=a.split("@"),R="";f.length>1&&(R=f[0]+"@",a=f[1]),a=a.replace(H,".");var N=a.split("."),L=nt(N,u).join(".");return R+L}function bt(a){for(var u=[],f=0,R=a.length;f<R;){var N=a.charCodeAt(f++);if(N>=55296&&N<=56319&&f<R){var L=a.charCodeAt(f++);(L&64512)==56320?u.push(((N&1023)<<10)+(L&1023)+65536):(u.push(N),f--)}else u.push(N)}return u}var Vt=function(a){return String.fromCodePoint.apply(String,x(a))},Pt=function(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:S},A=function(a,u){return a+22+75*(a<26)-((u!=0)<<5)},$=function(a,u,f){var R=0;for(a=f?Y(a/T):a>>1,a+=Y(a/u);a>ae*g>>1;R+=S)a=Y(a/ae);return Y(R+(ae+1)*a/(a+E))},O=function(a){var u=[],f=a.length,R=0,N=q,L=C,U=a.lastIndexOf(b);U<0&&(U=0);for(var re=0;re<U;++re)a.charCodeAt(re)>=128&&ue("not-basic"),u.push(a.charCodeAt(re));for(var de=U>0?U+1:0;de<f;){for(var se=R,Q=1,oe=S;;oe+=S){de>=f&&ue("invalid-input");var le=Pt(a.charCodeAt(de++));(le>=S||le>Y((_-R)/Q))&&ue("overflow"),R+=le*Q;var V=oe<=L?v:oe>=L+g?g:oe-L;if(le<V)break;var he=S-V;Q>Y(_/he)&&ue("overflow"),Q*=he}var ne=u.length+1;L=$(R-se,ne,se==0),Y(R/ne)>_-N&&ue("overflow"),N+=Y(R/ne),R%=ne,u.splice(R++,0,N)}return String.fromCodePoint.apply(String,u)},P=function(a){var u=[];a=bt(a);var f=a.length,R=q,N=0,L=C,U=!0,re=!1,de=void 0;try{for(var se=a[Symbol.iterator](),Q;!(U=(Q=se.next()).done);U=!0){var oe=Q.value;oe<128&&u.push(ke(oe))}}catch(Xt){re=!0,de=Xt}finally{try{!U&&se.return&&se.return()}finally{if(re)throw de}}var le=u.length,V=le;for(le&&u.push(b);V<f;){var he=_,ne=!0,xe=!1,jt=void 0;try{for(var Ne=a[Symbol.iterator](),Be;!(ne=(Be=Ne.next()).done);ne=!0){var ct=Be.value;ct>=R&&ct<he&&(he=ct)}}catch(Xt){xe=!0,jt=Xt}finally{try{!ne&&Ne.return&&Ne.return()}finally{if(xe)throw jt}}var lt=V+1;he-R>Y((_-N)/lt)&&ue("overflow"),N+=(he-R)*lt,R=he;var Re=!0,Ke=!1,pt=void 0;try{for(var We=a[Symbol.iterator](),Sr;!(Re=(Sr=We.next()).done);Re=!0){var Dn=Sr.value;if(Dn<R&&++N>_&&ue("overflow"),Dn==R){for(var kr=N,Tr=S;;Tr+=S){var xr=Tr<=L?v:Tr>=L+g?g:Tr-L;if(kr<xr)break;var Mn=kr-xr,Fn=S-xr;u.push(ke(A(xr+Mn%Fn,0))),kr=Y(Mn/Fn)}u.push(ke(A(kr,0))),L=$(N,lt,V==le),N=0,++V}}}catch(Xt){Ke=!0,pt=Xt}finally{try{!Re&&We.return&&We.return()}finally{if(Ke)throw pt}}++N,++R}return u.join("")},c=function(a){return ot(a,function(u){return k.test(u)?O(u.slice(4).toLowerCase()):u})},m=function(a){return ot(a,function(u){return I.test(u)?"xn--"+P(u):u})},j={version:"2.1.0",ucs2:{decode:bt,encode:Vt},decode:O,encode:P,toASCII:m,toUnicode:c},D={};function M(a){var u=a.charCodeAt(0),f=void 0;return u<16?f="%0"+u.toString(16).toUpperCase():u<128?f="%"+u.toString(16).toUpperCase():u<2048?f="%"+(u>>6|192).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase():f="%"+(u>>12|224).toString(16).toUpperCase()+"%"+(u>>6&63|128).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase(),f}function J(a){for(var u="",f=0,R=a.length;f<R;){var N=parseInt(a.substr(f+1,2),16);if(N<128)u+=String.fromCharCode(N),f+=3;else if(N>=194&&N<224){if(R-f>=6){var L=parseInt(a.substr(f+4,2),16);u+=String.fromCharCode((N&31)<<6|L&63)}else u+=a.substr(f,6);f+=6}else if(N>=224){if(R-f>=9){var U=parseInt(a.substr(f+4,2),16),re=parseInt(a.substr(f+7,2),16);u+=String.fromCharCode((N&15)<<12|(U&63)<<6|re&63)}else u+=a.substr(f,9);f+=9}else u+=a.substr(f,3),f+=3}return u}function Z(a,u){function f(R){var N=J(R);return N.match(u.UNRESERVED)?N:R}return a.scheme&&(a.scheme=String(a.scheme).replace(u.PCT_ENCODED,f).toLowerCase().replace(u.NOT_SCHEME,"")),a.userinfo!==void 0&&(a.userinfo=String(a.userinfo).replace(u.PCT_ENCODED,f).replace(u.NOT_USERINFO,M).replace(u.PCT_ENCODED,i)),a.host!==void 0&&(a.host=String(a.host).replace(u.PCT_ENCODED,f).toLowerCase().replace(u.NOT_HOST,M).replace(u.PCT_ENCODED,i)),a.path!==void 0&&(a.path=String(a.path).replace(u.PCT_ENCODED,f).replace(a.scheme?u.NOT_PATH:u.NOT_PATH_NOSCHEME,M).replace(u.PCT_ENCODED,i)),a.query!==void 0&&(a.query=String(a.query).replace(u.PCT_ENCODED,f).replace(u.NOT_QUERY,M).replace(u.PCT_ENCODED,i)),a.fragment!==void 0&&(a.fragment=String(a.fragment).replace(u.PCT_ENCODED,f).replace(u.NOT_FRAGMENT,M).replace(u.PCT_ENCODED,i)),a}function ce(a){return a.replace(/^0*(.*)/,"$1")||"0"}function Fe(a,u){var f=a.match(u.IPV4ADDRESS)||[],R=w(f,2),N=R[1];return N?N.split(".").map(ce).join("."):a}function Et(a,u){var f=a.match(u.IPV6ADDRESS)||[],R=w(f,3),N=R[1],L=R[2];if(N){for(var U=N.toLowerCase().split("::").reverse(),re=w(U,2),de=re[0],se=re[1],Q=se?se.split(":").map(ce):[],oe=de.split(":").map(ce),le=u.IPV4ADDRESS.test(oe[oe.length-1]),V=le?7:8,he=oe.length-V,ne=Array(V),xe=0;xe<V;++xe)ne[xe]=Q[xe]||oe[he+xe]||"";le&&(ne[V-1]=Fe(ne[V-1],u));var jt=ne.reduce(function(Re,Ke,pt){if(!Ke||Ke==="0"){var We=Re[Re.length-1];We&&We.index+We.length===pt?We.length++:Re.push({index:pt,length:1})}return Re},[]),Ne=jt.sort(function(Re,Ke){return Ke.length-Re.length})[0],Be=void 0;if(Ne&&Ne.length>1){var ct=ne.slice(0,Ne.index),lt=ne.slice(Ne.index+Ne.length);Be=ct.join(":")+"::"+lt.join(":")}else Be=ne.join(":");return L&&(Be+="%"+L),Be}else return a}var Bt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Kt="".match(/(){0}/)[1]===void 0;function Se(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f={},R=u.iri!==!1?y:d;u.reference==="suffix"&&(a=(u.scheme?u.scheme+":":"")+"//"+a);var N=a.match(Bt);if(N){Kt?(f.scheme=N[1],f.userinfo=N[3],f.host=N[4],f.port=parseInt(N[5],10),f.path=N[6]||"",f.query=N[7],f.fragment=N[8],isNaN(f.port)&&(f.port=N[5])):(f.scheme=N[1]||void 0,f.userinfo=a.indexOf("@")!==-1?N[3]:void 0,f.host=a.indexOf("//")!==-1?N[4]:void 0,f.port=parseInt(N[5],10),f.path=N[6]||"",f.query=a.indexOf("?")!==-1?N[7]:void 0,f.fragment=a.indexOf("#")!==-1?N[8]:void 0,isNaN(f.port)&&(f.port=a.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?N[4]:void 0)),f.host&&(f.host=Et(Fe(f.host,R),R)),f.scheme===void 0&&f.userinfo===void 0&&f.host===void 0&&f.port===void 0&&!f.path&&f.query===void 0?f.reference="same-document":f.scheme===void 0?f.reference="relative":f.fragment===void 0?f.reference="absolute":f.reference="uri",u.reference&&u.reference!=="suffix"&&u.reference!==f.reference&&(f.error=f.error||"URI is not a "+u.reference+" reference.");var L=D[(u.scheme||f.scheme||"").toLowerCase()];if(!u.unicodeSupport&&(!L||!L.unicodeSupport)){if(f.host&&(u.domainHost||L&&L.domainHost))try{f.host=j.toASCII(f.host.replace(R.PCT_ENCODED,J).toLowerCase())}catch(U){f.error=f.error||"Host's domain name can not be converted to ASCII via punycode: "+U}Z(f,d)}else Z(f,R);L&&L.parse&&L.parse(f,u)}else f.error=f.error||"URI can not be parsed.";return f}function Gt(a,u){var f=u.iri!==!1?y:d,R=[];return a.userinfo!==void 0&&(R.push(a.userinfo),R.push("@")),a.host!==void 0&&R.push(Et(Fe(String(a.host),f),f).replace(f.IPV6ADDRESS,function(N,L,U){return"["+L+(U?"%25"+U:"")+"]"})),(typeof a.port=="number"||typeof a.port=="string")&&(R.push(":"),R.push(String(a.port))),R.length?R.join(""):void 0}var St=/^\.\.?\//,kt=/^\/\.(\/|$)/,Tt=/^\/\.\.(\/|$)/,Jt=/^\/?(?:.|\n)*?(?=\/|$)/;function Ue(a){for(var u=[];a.length;)if(a.match(St))a=a.replace(St,"");else if(a.match(kt))a=a.replace(kt,"/");else if(a.match(Tt))a=a.replace(Tt,"/"),u.pop();else if(a==="."||a==="..")a="";else{var f=a.match(Jt);if(f){var R=f[0];a=a.slice(R.length),u.push(R)}else throw new Error("Unexpected dot segment condition")}return u.join("")}function be(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=u.iri?y:d,R=[],N=D[(u.scheme||a.scheme||"").toLowerCase()];if(N&&N.serialize&&N.serialize(a,u),a.host&&!f.IPV6ADDRESS.test(a.host)&&(u.domainHost||N&&N.domainHost))try{a.host=u.iri?j.toUnicode(a.host):j.toASCII(a.host.replace(f.PCT_ENCODED,J).toLowerCase())}catch(re){a.error=a.error||"Host's domain name can not be converted to "+(u.iri?"Unicode":"ASCII")+" via punycode: "+re}Z(a,f),u.reference!=="suffix"&&a.scheme&&(R.push(a.scheme),R.push(":"));var L=Gt(a,u);if(L!==void 0&&(u.reference!=="suffix"&&R.push("//"),R.push(L),a.path&&a.path.charAt(0)!=="/"&&R.push("/")),a.path!==void 0){var U=a.path;!u.absolutePath&&(!N||!N.absolutePath)&&(U=Ue(U)),L===void 0&&(U=U.replace(/^\/\//,"/%2F")),R.push(U)}return a.query!==void 0&&(R.push("?"),R.push(a.query)),a.fragment!==void 0&&(R.push("#"),R.push(a.fragment)),R.join("")}function xt(a,u){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},R=arguments[3],N={};return R||(a=Se(be(a,f),f),u=Se(be(u,f),f)),f=f||{},!f.tolerant&&u.scheme?(N.scheme=u.scheme,N.userinfo=u.userinfo,N.host=u.host,N.port=u.port,N.path=Ue(u.path||""),N.query=u.query):(u.userinfo!==void 0||u.host!==void 0||u.port!==void 0?(N.userinfo=u.userinfo,N.host=u.host,N.port=u.port,N.path=Ue(u.path||""),N.query=u.query):(u.path?(u.path.charAt(0)==="/"?N.path=Ue(u.path):((a.userinfo!==void 0||a.host!==void 0||a.port!==void 0)&&!a.path?N.path="/"+u.path:a.path?N.path=a.path.slice(0,a.path.lastIndexOf("/")+1)+u.path:N.path=u.path,N.path=Ue(N.path)),N.query=u.query):(N.path=a.path,u.query!==void 0?N.query=u.query:N.query=a.query),N.userinfo=a.userinfo,N.host=a.host,N.port=a.port),N.scheme=a.scheme),N.fragment=u.fragment,N}function Zt(a,u,f){var R=h({scheme:"null"},f);return be(xt(Se(a,R),Se(u,R),R,!0),R)}function it(a,u){return typeof a=="string"?a=be(Se(a,u),u):o(a)==="object"&&(a=Se(be(a,u),u)),a}function Yt(a,u,f){return typeof a=="string"?a=be(Se(a,f),f):o(a)==="object"&&(a=be(a,f)),typeof u=="string"?u=be(Se(u,f),f):o(u)==="object"&&(u=be(u,f)),a===u}function Er(a,u){return a&&a.toString().replace(!u||!u.iri?d.ESCAPE:y.ESCAPE,M)}function Te(a,u){return a&&a.toString().replace(!u||!u.iri?d.PCT_ENCODED:y.PCT_ENCODED,J)}var at={scheme:"http",domainHost:!0,parse:function(a,u){return a.host||(a.error=a.error||"HTTP URIs must have a host."),a},serialize:function(a,u){var f=String(a.scheme).toLowerCase()==="https";return(a.port===(f?443:80)||a.port==="")&&(a.port=void 0),a.path||(a.path="/"),a}},Rn={scheme:"https",domainHost:at.domainHost,parse:at.parse,serialize:at.serialize};function jn(a){return typeof a.secure=="boolean"?a.secure:String(a.scheme).toLowerCase()==="wss"}var Qt={scheme:"ws",domainHost:!0,parse:function(a,u){var f=a;return f.secure=jn(f),f.resourceName=(f.path||"/")+(f.query?"?"+f.query:""),f.path=void 0,f.query=void 0,f},serialize:function(a,u){if((a.port===(jn(a)?443:80)||a.port==="")&&(a.port=void 0),typeof a.secure=="boolean"&&(a.scheme=a.secure?"wss":"ws",a.secure=void 0),a.resourceName){var f=a.resourceName.split("?"),R=w(f,2),N=R[0],L=R[1];a.path=N&&N!=="/"?N:void 0,a.query=L,a.resourceName=void 0}return a.fragment=void 0,a}},Nn={scheme:"wss",domainHost:Qt.domainHost,parse:Qt.parse,serialize:Qt.serialize},zi={},Cn="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Le="[0-9A-Fa-f]",Hi=n(n("%[EFef]"+Le+"%"+Le+Le+"%"+Le+Le)+"|"+n("%[89A-Fa-f]"+Le+"%"+Le+Le)+"|"+n("%"+Le+Le)),Vi="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Bi="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Ki=s(Bi,'[\\"\\\\]'),Gi="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Ji=new RegExp(Cn,"g"),Rt=new RegExp(Hi,"g"),Zi=new RegExp(s("[^]",Vi,"[\\.]",'[\\"]',Ki),"g"),On=new RegExp(s("[^]",Cn,Gi),"g"),Yi=On;function ns(a){var u=J(a);return u.match(Ji)?u:a}var In={scheme:"mailto",parse:function(a,u){var f=a,R=f.to=f.path?f.path.split(","):[];if(f.path=void 0,f.query){for(var N=!1,L={},U=f.query.split("&"),re=0,de=U.length;re<de;++re){var se=U[re].split("=");switch(se[0]){case"to":for(var Q=se[1].split(","),oe=0,le=Q.length;oe<le;++oe)R.push(Q[oe]);break;case"subject":f.subject=Te(se[1],u);break;case"body":f.body=Te(se[1],u);break;default:N=!0,L[Te(se[0],u)]=Te(se[1],u);break}}N&&(f.headers=L)}f.query=void 0;for(var V=0,he=R.length;V<he;++V){var ne=R[V].split("@");if(ne[0]=Te(ne[0]),u.unicodeSupport)ne[1]=Te(ne[1],u).toLowerCase();else try{ne[1]=j.toASCII(Te(ne[1],u).toLowerCase())}catch(xe){f.error=f.error||"Email address's domain name can not be converted to ASCII via punycode: "+xe}R[V]=ne.join("@")}return f},serialize:function(a,u){var f=a,R=p(a.to);if(R){for(var N=0,L=R.length;N<L;++N){var U=String(R[N]),re=U.lastIndexOf("@"),de=U.slice(0,re).replace(Rt,ns).replace(Rt,i).replace(Zi,M),se=U.slice(re+1);try{se=u.iri?j.toUnicode(se):j.toASCII(Te(se,u).toLowerCase())}catch(V){f.error=f.error||"Email address's domain name can not be converted to "+(u.iri?"Unicode":"ASCII")+" via punycode: "+V}R[N]=de+"@"+se}f.path=R.join(",")}var Q=a.headers=a.headers||{};a.subject&&(Q.subject=a.subject),a.body&&(Q.body=a.body);var oe=[];for(var le in Q)Q[le]!==zi[le]&&oe.push(le.replace(Rt,ns).replace(Rt,i).replace(On,M)+"="+Q[le].replace(Rt,ns).replace(Rt,i).replace(Yi,M));return oe.length&&(f.query=oe.join("&")),f}},Qi=/^([^\:]+)\:(.*)/,qn={scheme:"urn",parse:function(a,u){var f=a.path&&a.path.match(Qi),R=a;if(f){var N=u.scheme||R.scheme||"urn",L=f[1].toLowerCase(),U=f[2],re=N+":"+(u.nid||L),de=D[re];R.nid=L,R.nss=U,R.path=void 0,de&&(R=de.parse(R,u))}else R.error=R.error||"URN can not be parsed.";return R},serialize:function(a,u){var f=u.scheme||a.scheme||"urn",R=a.nid,N=f+":"+(u.nid||R),L=D[N];L&&(a=L.serialize(a,u));var U=a,re=a.nss;return U.path=(R||u.nid)+":"+re,U}},Xi=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,An={scheme:"urn:uuid",parse:function(a,u){var f=a;return f.uuid=f.nss,f.nss=void 0,!u.tolerant&&(!f.uuid||!f.uuid.match(Xi))&&(f.error=f.error||"UUID is not valid."),f},serialize:function(a,u){var f=a;return f.nss=(a.uuid||"").toLowerCase(),f}};D[at.scheme]=at,D[Rn.scheme]=Rn,D[Qt.scheme]=Qt,D[Nn.scheme]=Nn,D[In.scheme]=In,D[qn.scheme]=qn,D[An.scheme]=An,r.SCHEMES=D,r.pctEncChar=M,r.pctDecChars=J,r.parse=Se,r.removeDotSegments=Ue,r.serialize=be,r.resolveComponents=xt,r.resolve=Zt,r.normalize=it,r.equal=Yt,r.escapeComponent=Er,r.unescapeComponent=Te,Object.defineProperty(r,"__esModule",{value:!0})})})(Ns,Ns.exports);var Ql=Ns.exports;Object.defineProperty(Gs,"__esModule",{value:!0});const ki=Ql;ki.code='require("ajv/dist/runtime/uri").default';Gs.default=ki;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=qe;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=K;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const s=_r,n=br,o=vt,i=Ee,p=K,h=ye,l=$r,d=ee,y=Yl,w=Gs,x=(A,$)=>new RegExp(A,$);x.code="new RegExp";const _=["removeAdditional","useDefaults","coerceTypes"],S=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),v={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},E=200;function T(A){var $,O,P,c,m,j,D,M,J,Z,ce,Fe,Et,Bt,Kt,Se,Gt,St,kt,Tt,Jt,Ue,be,xt,Zt;const it=A.strict,Yt=($=A.code)===null||$===void 0?void 0:$.optimize,Er=Yt===!0||Yt===void 0?1:Yt||0,Te=(P=(O=A.code)===null||O===void 0?void 0:O.regExp)!==null&&P!==void 0?P:x,at=(c=A.uriResolver)!==null&&c!==void 0?c:w.default;return{strictSchema:(j=(m=A.strictSchema)!==null&&m!==void 0?m:it)!==null&&j!==void 0?j:!0,strictNumbers:(M=(D=A.strictNumbers)!==null&&D!==void 0?D:it)!==null&&M!==void 0?M:!0,strictTypes:(Z=(J=A.strictTypes)!==null&&J!==void 0?J:it)!==null&&Z!==void 0?Z:"log",strictTuples:(Fe=(ce=A.strictTuples)!==null&&ce!==void 0?ce:it)!==null&&Fe!==void 0?Fe:"log",strictRequired:(Bt=(Et=A.strictRequired)!==null&&Et!==void 0?Et:it)!==null&&Bt!==void 0?Bt:!1,code:A.code?{...A.code,optimize:Er,regExp:Te}:{optimize:Er,regExp:Te},loopRequired:(Kt=A.loopRequired)!==null&&Kt!==void 0?Kt:E,loopEnum:(Se=A.loopEnum)!==null&&Se!==void 0?Se:E,meta:(Gt=A.meta)!==null&&Gt!==void 0?Gt:!0,messages:(St=A.messages)!==null&&St!==void 0?St:!0,inlineRefs:(kt=A.inlineRefs)!==null&&kt!==void 0?kt:!0,schemaId:(Tt=A.schemaId)!==null&&Tt!==void 0?Tt:"$id",addUsedSchema:(Jt=A.addUsedSchema)!==null&&Jt!==void 0?Jt:!0,validateSchema:(Ue=A.validateSchema)!==null&&Ue!==void 0?Ue:!0,validateFormats:(be=A.validateFormats)!==null&&be!==void 0?be:!0,unicodeRegExp:(xt=A.unicodeRegExp)!==null&&xt!==void 0?xt:!0,int32range:(Zt=A.int32range)!==null&&Zt!==void 0?Zt:!0,uriResolver:at}}class C{constructor($={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,$=this.opts={...$,...T($)};const{es5:O,lines:P}=this.opts.code;this.scope=new p.ValueScope({scope:{},prefixes:S,es5:O,lines:P}),this.logger=Y($.logger);const c=$.validateFormats;$.validateFormats=!1,this.RULES=(0,o.getRules)(),q.call(this,v,$,"NOT SUPPORTED"),q.call(this,g,$,"DEPRECATED","warn"),this._metaOpts=G.call(this),$.formats&&I.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),$.keywords&&H.call(this,$.keywords),typeof $.meta=="object"&&this.addMetaSchema($.meta),k.call(this),$.validateFormats=c}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$,meta:O,schemaId:P}=this.opts;let c=y;P==="id"&&(c={...y},c.id=c.$id,delete c.$id),O&&$&&this.addMetaSchema(c,c[P],!1)}defaultMeta(){const{meta:$,schemaId:O}=this.opts;return this.opts.defaultMeta=typeof $=="object"?$[O]||$:void 0}validate($,O){let P;if(typeof $=="string"){if(P=this.getSchema($),!P)throw new Error(`no schema with key or ref "${$}"`)}else P=this.compile($);const c=P(O);return"$async"in P||(this.errors=P.errors),c}compile($,O){const P=this._addSchema($,O);return P.validate||this._compileSchemaEnv(P)}compileAsync($,O){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:P}=this.opts;return c.call(this,$,O);async function c(Z,ce){await m.call(this,Z.$schema);const Fe=this._addSchema(Z,ce);return Fe.validate||j.call(this,Fe)}async function m(Z){Z&&!this.getSchema(Z)&&await c.call(this,{$ref:Z},!0)}async function j(Z){try{return this._compileSchemaEnv(Z)}catch(ce){if(!(ce instanceof n.default))throw ce;return D.call(this,ce),await M.call(this,ce.missingSchema),j.call(this,Z)}}function D({missingSchema:Z,missingRef:ce}){if(this.refs[Z])throw new Error(`AnySchema ${Z} is loaded but ${ce} cannot be resolved`)}async function M(Z){const ce=await J.call(this,Z);this.refs[Z]||await m.call(this,ce.$schema),this.refs[Z]||this.addSchema(ce,Z,O)}async function J(Z){const ce=this._loading[Z];if(ce)return ce;try{return await(this._loading[Z]=P(Z))}finally{delete this._loading[Z]}}}addSchema($,O,P,c=this.opts.validateSchema){if(Array.isArray($)){for(const j of $)this.addSchema(j,void 0,P,c);return this}let m;if(typeof $=="object"){const{schemaId:j}=this.opts;if(m=$[j],m!==void 0&&typeof m!="string")throw new Error(`schema ${j} must be string`)}return O=(0,h.normalizeId)(O||m),this._checkUnique(O),this.schemas[O]=this._addSchema($,P,O,c,!0),this}addMetaSchema($,O,P=this.opts.validateSchema){return this.addSchema($,O,!0,P),this}validateSchema($,O){if(typeof $=="boolean")return!0;let P;if(P=$.$schema,P!==void 0&&typeof P!="string")throw new Error("$schema must be a string");if(P=P||this.opts.defaultMeta||this.defaultMeta(),!P)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const c=this.validate(P,$);if(!c&&O){const m="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(m);else throw new Error(m)}return c}getSchema($){let O;for(;typeof(O=b.call(this,$))=="string";)$=O;if(O===void 0){const{schemaId:P}=this.opts,c=new i.SchemaEnv({schema:{},schemaId:P});if(O=i.resolveSchema.call(this,c,$),!O)return;this.refs[$]=O}return O.validate||this._compileSchemaEnv(O)}removeSchema($){if($ instanceof RegExp)return this._removeAllSchemas(this.schemas,$),this._removeAllSchemas(this.refs,$),this;switch(typeof $){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const O=b.call(this,$);return typeof O=="object"&&this._cache.delete(O.schema),delete this.schemas[$],delete this.refs[$],this}case"object":{const O=$;this._cache.delete(O);let P=$[this.opts.schemaId];return P&&(P=(0,h.normalizeId)(P),delete this.schemas[P],delete this.refs[P]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary($){for(const O of $)this.addKeyword(O);return this}addKeyword($,O){let P;if(typeof $=="string")P=$,typeof O=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),O.keyword=P);else if(typeof $=="object"&&O===void 0){if(O=$,P=O.keyword,Array.isArray(P)&&!P.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(ue.call(this,P,O),!O)return(0,d.eachItem)(P,m=>nt.call(this,m)),this;bt.call(this,O);const c={...O,type:(0,l.getJSONTypes)(O.type),schemaType:(0,l.getJSONTypes)(O.schemaType)};return(0,d.eachItem)(P,c.type.length===0?m=>nt.call(this,m,c):m=>c.type.forEach(j=>nt.call(this,m,c,j))),this}getKeyword($){const O=this.RULES.all[$];return typeof O=="object"?O.definition:!!O}removeKeyword($){const{RULES:O}=this;delete O.keywords[$],delete O.all[$];for(const P of O.rules){const c=P.rules.findIndex(m=>m.keyword===$);c>=0&&P.rules.splice(c,1)}return this}addFormat($,O){return typeof O=="string"&&(O=new RegExp(O)),this.formats[$]=O,this}errorsText($=this.errors,{separator:O=", ",dataVar:P="data"}={}){return!$||$.length===0?"No errors":$.map(c=>`${P}${c.instancePath} ${c.message}`).reduce((c,m)=>c+O+m)}$dataMetaSchema($,O){const P=this.RULES.all;$=JSON.parse(JSON.stringify($));for(const c of O){const m=c.split("/").slice(1);let j=$;for(const D of m)j=j[D];for(const D in P){const M=P[D];if(typeof M!="object")continue;const{$data:J}=M.definition,Z=j[D];J&&Z&&(j[D]=Pt(Z))}}return $}_removeAllSchemas($,O){for(const P in $){const c=$[P];(!O||O.test(P))&&(typeof c=="string"?delete $[P]:c&&!c.meta&&(this._cache.delete(c.schema),delete $[P]))}}_addSchema($,O,P,c=this.opts.validateSchema,m=this.opts.addUsedSchema){let j;const{schemaId:D}=this.opts;if(typeof $=="object")j=$[D];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof $!="boolean")throw new Error("schema must be object or boolean")}let M=this._cache.get($);if(M!==void 0)return M;P=(0,h.normalizeId)(j||P);const J=h.getSchemaRefs.call(this,$,P);return M=new i.SchemaEnv({schema:$,schemaId:D,meta:O,baseId:P,localRefs:J}),this._cache.set(M.schema,M),m&&!P.startsWith("#")&&(P&&this._checkUnique(P),this.refs[P]=M),c&&this.validateSchema($,!0),M}_checkUnique($){if(this.schemas[$]||this.refs[$])throw new Error(`schema with key or id "${$}" already exists`)}_compileSchemaEnv($){if($.meta?this._compileMetaSchema($):i.compileSchema.call(this,$),!$.validate)throw new Error("ajv implementation error");return $.validate}_compileMetaSchema($){const O=this.opts;this.opts=this._metaOpts;try{i.compileSchema.call(this,$)}finally{this.opts=O}}}e.default=C,C.ValidationError=s.default,C.MissingRefError=n.default;function q(A,$,O,P="error"){for(const c in A){const m=c;m in $&&this.logger[P](`${O}: option ${c}. ${A[m]}`)}}function b(A){return A=(0,h.normalizeId)(A),this.schemas[A]||this.refs[A]}function k(){const A=this.opts.schemas;if(A)if(Array.isArray(A))this.addSchema(A);else for(const $ in A)this.addSchema(A[$],$)}function I(){for(const A in this.opts.formats){const $=this.opts.formats[A];$&&this.addFormat(A,$)}}function H(A){if(Array.isArray(A)){this.addVocabulary(A);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const $ in A){const O=A[$];O.keyword||(O.keyword=$),this.addKeyword(O)}}function G(){const A={...this.opts};for(const $ of _)delete A[$];return A}const ae={log(){},warn(){},error(){}};function Y(A){if(A===!1)return ae;if(A===void 0)return console;if(A.log&&A.warn&&A.error)return A;throw new Error("logger must implement log, warn and error methods")}const ke=/^[a-z_$][a-z0-9_$:-]*$/i;function ue(A,$){const{RULES:O}=this;if((0,d.eachItem)(A,P=>{if(O.keywords[P])throw new Error(`Keyword ${P} is already defined`);if(!ke.test(P))throw new Error(`Keyword ${P} has invalid name`)}),!!$&&$.$data&&!("code"in $||"validate"in $))throw new Error('$data keyword must have "code" or "validate" function')}function nt(A,$,O){var P;const c=$==null?void 0:$.post;if(O&&c)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:m}=this;let j=c?m.post:m.rules.find(({type:M})=>M===O);if(j||(j={type:O,rules:[]},m.rules.push(j)),m.keywords[A]=!0,!$)return;const D={keyword:A,definition:{...$,type:(0,l.getJSONTypes)($.type),schemaType:(0,l.getJSONTypes)($.schemaType)}};$.before?ot.call(this,j,D,$.before):j.rules.push(D),m.all[A]=D,(P=$.implements)===null||P===void 0||P.forEach(M=>this.addKeyword(M))}function ot(A,$,O){const P=A.rules.findIndex(c=>c.keyword===O);P>=0?A.rules.splice(P,0,$):(A.rules.push($),this.logger.warn(`rule ${O} is not defined`))}function bt(A){let{metaSchema:$}=A;$!==void 0&&(A.$data&&this.opts.$data&&($=Pt($)),A.validateSchema=this.compile($,!0))}const Vt={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Pt(A){return{anyOf:[A,Vt]}}})(ti);var Js={},Zs={},Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});const Xl={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Ys.default=Xl;var $t={};Object.defineProperty($t,"__esModule",{value:!0});$t.callRef=$t.getValidate=void 0;const ep=br,io=B,Pe=K,Ot=Ve,ao=Ee,Rr=ee,tp={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:s}=e,{baseId:n,schemaEnv:o,validateName:i,opts:p,self:h}=s,{root:l}=o;if((r==="#"||r==="#/")&&n===l.baseId)return y();const d=ao.resolveRef.call(h,l,n,r);if(d===void 0)throw new ep.default(s.opts.uriResolver,n,r);if(d instanceof ao.SchemaEnv)return w(d);return x(d);function y(){if(o===l)return Fr(e,i,o,o.$async);const _=t.scopeValue("root",{ref:l});return Fr(e,(0,Pe._)`${_}.validate`,l,l.$async)}function w(_){const S=Ti(e,_);Fr(e,S,_,_.$async)}function x(_){const S=t.scopeValue("schema",p.code.source===!0?{ref:_,code:(0,Pe.stringify)(_)}:{ref:_}),v=t.name("valid"),g=e.subschema({schema:_,dataTypes:[],schemaPath:Pe.nil,topSchemaRef:S,errSchemaPath:r},v);e.mergeEvaluated(g),e.ok(v)}}};function Ti(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):(0,Pe._)`${r.scopeValue("wrapper",{ref:t})}.validate`}$t.getValidate=Ti;function Fr(e,t,r,s){const{gen:n,it:o}=e,{allErrors:i,schemaEnv:p,opts:h}=o,l=h.passContext?Ot.default.this:Pe.nil;s?d():y();function d(){if(!p.$async)throw new Error("async schema referenced by sync schema");const _=n.let("valid");n.try(()=>{n.code((0,Pe._)`await ${(0,io.callValidateCode)(e,t,l)}`),x(t),i||n.assign(_,!0)},S=>{n.if((0,Pe._)`!(${S} instanceof ${o.ValidationError})`,()=>n.throw(S)),w(S),i||n.assign(_,!1)}),e.ok(_)}function y(){e.result((0,io.callValidateCode)(e,t,l),()=>x(t),()=>w(t))}function w(_){const S=(0,Pe._)`${_}.errors`;n.assign(Ot.default.vErrors,(0,Pe._)`${Ot.default.vErrors} === null ? ${S} : ${Ot.default.vErrors}.concat(${S})`),n.assign(Ot.default.errors,(0,Pe._)`${Ot.default.vErrors}.length`)}function x(_){var S;if(!o.opts.unevaluated)return;const v=(S=r==null?void 0:r.validate)===null||S===void 0?void 0:S.evaluated;if(o.props!==!0)if(v&&!v.dynamicProps)v.props!==void 0&&(o.props=Rr.mergeEvaluated.props(n,v.props,o.props));else{const g=n.var("props",(0,Pe._)`${_}.evaluated.props`);o.props=Rr.mergeEvaluated.props(n,g,o.props,Pe.Name)}if(o.items!==!0)if(v&&!v.dynamicItems)v.items!==void 0&&(o.items=Rr.mergeEvaluated.items(n,v.items,o.items));else{const g=n.var("items",(0,Pe._)`${_}.evaluated.items`);o.items=Rr.mergeEvaluated.items(n,g,o.items,Pe.Name)}}}$t.callRef=Fr;$t.default=tp;Object.defineProperty(Zs,"__esModule",{value:!0});const rp=Ys,sp=$t,np=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",rp.default,sp.default];Zs.default=np;var Qs={},Xs={};Object.defineProperty(Xs,"__esModule",{value:!0});const Vr=K,et=Vr.operators,Br={maximum:{okStr:"<=",ok:et.LTE,fail:et.GT},minimum:{okStr:">=",ok:et.GTE,fail:et.LT},exclusiveMaximum:{okStr:"<",ok:et.LT,fail:et.GTE},exclusiveMinimum:{okStr:">",ok:et.GT,fail:et.LTE}},op={message:({keyword:e,schemaCode:t})=>(0,Vr.str)`must be ${Br[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,Vr._)`{comparison: ${Br[e].okStr}, limit: ${t}}`},ip={keyword:Object.keys(Br),type:"number",schemaType:"number",$data:!0,error:op,code(e){const{keyword:t,data:r,schemaCode:s}=e;e.fail$data((0,Vr._)`${r} ${Br[t].fail} ${s} || isNaN(${r})`)}};Xs.default=ip;var en={};Object.defineProperty(en,"__esModule",{value:!0});const dr=K,ap={message:({schemaCode:e})=>(0,dr.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,dr._)`{multipleOf: ${e}}`},cp={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:ap,code(e){const{gen:t,data:r,schemaCode:s,it:n}=e,o=n.opts.multipleOfPrecision,i=t.let("res"),p=o?(0,dr._)`Math.abs(Math.round(${i}) - ${i}) > 1e-${o}`:(0,dr._)`${i} !== parseInt(${i})`;e.fail$data((0,dr._)`(${s} === 0 || (${i} = ${r}/${s}, ${p}))`)}};en.default=cp;var tn={},rn={};Object.defineProperty(rn,"__esModule",{value:!0});function xi(e){const t=e.length;let r=0,s=0,n;for(;s<t;)r++,n=e.charCodeAt(s++),n>=55296&&n<=56319&&s<t&&(n=e.charCodeAt(s),(n&64512)===56320&&s++);return r}rn.default=xi;xi.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(tn,"__esModule",{value:!0});const ft=K,lp=ee,pp=rn,up={message({keyword:e,schemaCode:t}){const r=e==="maxLength"?"more":"fewer";return(0,ft.str)`must NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>(0,ft._)`{limit: ${e}}`},dp={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:up,code(e){const{keyword:t,data:r,schemaCode:s,it:n}=e,o=t==="maxLength"?ft.operators.GT:ft.operators.LT,i=n.opts.unicode===!1?(0,ft._)`${r}.length`:(0,ft._)`${(0,lp.useFunc)(e.gen,pp.default)}(${r})`;e.fail$data((0,ft._)`${i} ${o} ${s}`)}};tn.default=dp;var sn={};Object.defineProperty(sn,"__esModule",{value:!0});const hp=B,Kr=K,fp={message:({schemaCode:e})=>(0,Kr.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,Kr._)`{pattern: ${e}}`},mp={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:fp,code(e){const{data:t,$data:r,schema:s,schemaCode:n,it:o}=e,i=o.opts.unicodeRegExp?"u":"",p=r?(0,Kr._)`(new RegExp(${n}, ${i}))`:(0,hp.usePattern)(e,s);e.fail$data((0,Kr._)`!${p}.test(${t})`)}};sn.default=mp;var nn={};Object.defineProperty(nn,"__esModule",{value:!0});const hr=K,yp={message({keyword:e,schemaCode:t}){const r=e==="maxProperties"?"more":"fewer";return(0,hr.str)`must NOT have ${r} than ${t} properties`},params:({schemaCode:e})=>(0,hr._)`{limit: ${e}}`},gp={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:yp,code(e){const{keyword:t,data:r,schemaCode:s}=e,n=t==="maxProperties"?hr.operators.GT:hr.operators.LT;e.fail$data((0,hr._)`Object.keys(${r}).length ${n} ${s}`)}};nn.default=gp;var on={};Object.defineProperty(on,"__esModule",{value:!0});const tr=B,fr=K,wp=ee,vp={message:({params:{missingProperty:e}})=>(0,fr.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,fr._)`{missingProperty: ${e}}`},$p={keyword:"required",type:"object",schemaType:"array",$data:!0,error:vp,code(e){const{gen:t,schema:r,schemaCode:s,data:n,$data:o,it:i}=e,{opts:p}=i;if(!o&&r.length===0)return;const h=r.length>=p.loopRequired;if(i.allErrors?l():d(),p.strictRequired){const x=e.parentSchema.properties,{definedProperties:_}=e.it;for(const S of r)if((x==null?void 0:x[S])===void 0&&!_.has(S)){const v=i.schemaEnv.baseId+i.errSchemaPath,g=`required property "${S}" is not defined at "${v}" (strictRequired)`;(0,wp.checkStrictMode)(i,g,i.opts.strictRequired)}}function l(){if(h||o)e.block$data(fr.nil,y);else for(const x of r)(0,tr.checkReportMissingProp)(e,x)}function d(){const x=t.let("missing");if(h||o){const _=t.let("valid",!0);e.block$data(_,()=>w(x,_)),e.ok(_)}else t.if((0,tr.checkMissingProp)(e,r,x)),(0,tr.reportMissingProp)(e,x),t.else()}function y(){t.forOf("prop",s,x=>{e.setParams({missingProperty:x}),t.if((0,tr.noPropertyInData)(t,n,x,p.ownProperties),()=>e.error())})}function w(x,_){e.setParams({missingProperty:x}),t.forOf(x,s,()=>{t.assign(_,(0,tr.propertyInData)(t,n,x,p.ownProperties)),t.if((0,fr.not)(_),()=>{e.error(),t.break()})},fr.nil)}}};on.default=$p;var an={};Object.defineProperty(an,"__esModule",{value:!0});const mr=K,_p={message({keyword:e,schemaCode:t}){const r=e==="maxItems"?"more":"fewer";return(0,mr.str)`must NOT have ${r} than ${t} items`},params:({schemaCode:e})=>(0,mr._)`{limit: ${e}}`},bp={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:_p,code(e){const{keyword:t,data:r,schemaCode:s}=e,n=t==="maxItems"?mr.operators.GT:mr.operators.LT;e.fail$data((0,mr._)`${r}.length ${n} ${s}`)}};an.default=bp;var cn={},Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});const Ri=li;Ri.code='require("ajv/dist/runtime/equal").default';Pr.default=Ri;Object.defineProperty(cn,"__esModule",{value:!0});const ls=$r,me=K,Pp=ee,Ep=Pr,Sp={message:({params:{i:e,j:t}})=>(0,me.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,me._)`{i: ${e}, j: ${t}}`},kp={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:Sp,code(e){const{gen:t,data:r,$data:s,schema:n,parentSchema:o,schemaCode:i,it:p}=e;if(!s&&!n)return;const h=t.let("valid"),l=o.items?(0,ls.getSchemaTypes)(o.items):[];e.block$data(h,d,(0,me._)`${i} === false`),e.ok(h);function d(){const _=t.let("i",(0,me._)`${r}.length`),S=t.let("j");e.setParams({i:_,j:S}),t.assign(h,!0),t.if((0,me._)`${_} > 1`,()=>(y()?w:x)(_,S))}function y(){return l.length>0&&!l.some(_=>_==="object"||_==="array")}function w(_,S){const v=t.name("item"),g=(0,ls.checkDataTypes)(l,v,p.opts.strictNumbers,ls.DataType.Wrong),E=t.const("indices",(0,me._)`{}`);t.for((0,me._)`;${_}--;`,()=>{t.let(v,(0,me._)`${r}[${_}]`),t.if(g,(0,me._)`continue`),l.length>1&&t.if((0,me._)`typeof ${v} == "string"`,(0,me._)`${v} += "_"`),t.if((0,me._)`typeof ${E}[${v}] == "number"`,()=>{t.assign(S,(0,me._)`${E}[${v}]`),e.error(),t.assign(h,!1).break()}).code((0,me._)`${E}[${v}] = ${_}`)})}function x(_,S){const v=(0,Pp.useFunc)(t,Ep.default),g=t.name("outer");t.label(g).for((0,me._)`;${_}--;`,()=>t.for((0,me._)`${S} = ${_}; ${S}--;`,()=>t.if((0,me._)`${v}(${r}[${_}], ${r}[${S}])`,()=>{e.error(),t.assign(h,!1).break(g)})))}}};cn.default=kp;var ln={};Object.defineProperty(ln,"__esModule",{value:!0});const Cs=K,Tp=ee,xp=Pr,Rp={message:"must be equal to constant",params:({schemaCode:e})=>(0,Cs._)`{allowedValue: ${e}}`},jp={keyword:"const",$data:!0,error:Rp,code(e){const{gen:t,data:r,$data:s,schemaCode:n,schema:o}=e;s||o&&typeof o=="object"?e.fail$data((0,Cs._)`!${(0,Tp.useFunc)(t,xp.default)}(${r}, ${n})`):e.fail((0,Cs._)`${o} !== ${r}`)}};ln.default=jp;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});const or=K,Np=ee,Cp=Pr,Op={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,or._)`{allowedValues: ${e}}`},Ip={keyword:"enum",schemaType:"array",$data:!0,error:Op,code(e){const{gen:t,data:r,$data:s,schema:n,schemaCode:o,it:i}=e;if(!s&&n.length===0)throw new Error("enum must have non-empty array");const p=n.length>=i.opts.loopEnum;let h;const l=()=>h??(h=(0,Np.useFunc)(t,Cp.default));let d;if(p||s)d=t.let("valid"),e.block$data(d,y);else{if(!Array.isArray(n))throw new Error("ajv implementation error");const x=t.const("vSchema",o);d=(0,or.or)(...n.map((_,S)=>w(x,S)))}e.pass(d);function y(){t.assign(d,!1),t.forOf("v",o,x=>t.if((0,or._)`${l()}(${r}, ${x})`,()=>t.assign(d,!0).break()))}function w(x,_){const S=n[_];return typeof S=="object"&&S!==null?(0,or._)`${l()}(${r}, ${x}[${_}])`:(0,or._)`${r} === ${S}`}}};pn.default=Ip;Object.defineProperty(Qs,"__esModule",{value:!0});const qp=Xs,Ap=en,Dp=tn,Mp=sn,Fp=nn,Up=on,Lp=an,Wp=cn,zp=ln,Hp=pn,Vp=[qp.default,Ap.default,Dp.default,Mp.default,Fp.default,Up.default,Lp.default,Wp.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},zp.default,Hp.default];Qs.default=Vp;var un={},zt={};Object.defineProperty(zt,"__esModule",{value:!0});zt.validateAdditionalItems=void 0;const mt=K,Os=ee,Bp={message:({params:{len:e}})=>(0,mt.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,mt._)`{limit: ${e}}`},Kp={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Bp,code(e){const{parentSchema:t,it:r}=e,{items:s}=t;if(!Array.isArray(s)){(0,Os.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}ji(e,s)}};function ji(e,t){const{gen:r,schema:s,data:n,keyword:o,it:i}=e;i.items=!0;const p=r.const("len",(0,mt._)`${n}.length`);if(s===!1)e.setParams({len:t.length}),e.pass((0,mt._)`${p} <= ${t.length}`);else if(typeof s=="object"&&!(0,Os.alwaysValidSchema)(i,s)){const l=r.var("valid",(0,mt._)`${p} <= ${t.length}`);r.if((0,mt.not)(l),()=>h(l)),e.ok(l)}function h(l){r.forRange("i",t.length,p,d=>{e.subschema({keyword:o,dataProp:d,dataPropType:Os.Type.Num},l),i.allErrors||r.if((0,mt.not)(l),()=>r.break())})}}zt.validateAdditionalItems=ji;zt.default=Kp;var dn={},Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.validateTuple=void 0;const co=K,Ur=ee,Gp=B,Jp={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return Ni(e,"additionalItems",t);r.items=!0,!(0,Ur.alwaysValidSchema)(r,t)&&e.ok((0,Gp.validateArray)(e))}};function Ni(e,t,r=e.schema){const{gen:s,parentSchema:n,data:o,keyword:i,it:p}=e;d(n),p.opts.unevaluated&&r.length&&p.items!==!0&&(p.items=Ur.mergeEvaluated.items(s,r.length,p.items));const h=s.name("valid"),l=s.const("len",(0,co._)`${o}.length`);r.forEach((y,w)=>{(0,Ur.alwaysValidSchema)(p,y)||(s.if((0,co._)`${l} > ${w}`,()=>e.subschema({keyword:i,schemaProp:w,dataProp:w},h)),e.ok(h))});function d(y){const{opts:w,errSchemaPath:x}=p,_=r.length,S=_===y.minItems&&(_===y.maxItems||y[t]===!1);if(w.strictTuples&&!S){const v=`"${i}" is ${_}-tuple, but minItems or maxItems/${t} are not specified or different at path "${x}"`;(0,Ur.checkStrictMode)(p,v,w.strictTuples)}}}Ht.validateTuple=Ni;Ht.default=Jp;Object.defineProperty(dn,"__esModule",{value:!0});const Zp=Ht,Yp={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Zp.validateTuple)(e,"items")};dn.default=Yp;var hn={};Object.defineProperty(hn,"__esModule",{value:!0});const lo=K,Qp=ee,Xp=B,eu=zt,tu={message:({params:{len:e}})=>(0,lo.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,lo._)`{limit: ${e}}`},ru={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:tu,code(e){const{schema:t,parentSchema:r,it:s}=e,{prefixItems:n}=r;s.items=!0,!(0,Qp.alwaysValidSchema)(s,t)&&(n?(0,eu.validateAdditionalItems)(e,n):e.ok((0,Xp.validateArray)(e)))}};hn.default=ru;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});const je=K,jr=ee,su={message:({params:{min:e,max:t}})=>t===void 0?(0,je.str)`must contain at least ${e} valid item(s)`:(0,je.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,je._)`{minContains: ${e}}`:(0,je._)`{minContains: ${e}, maxContains: ${t}}`},nu={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:su,code(e){const{gen:t,schema:r,parentSchema:s,data:n,it:o}=e;let i,p;const{minContains:h,maxContains:l}=s;o.opts.next?(i=h===void 0?1:h,p=l):i=1;const d=t.const("len",(0,je._)`${n}.length`);if(e.setParams({min:i,max:p}),p===void 0&&i===0){(0,jr.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(p!==void 0&&i>p){(0,jr.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,jr.alwaysValidSchema)(o,r)){let S=(0,je._)`${d} >= ${i}`;p!==void 0&&(S=(0,je._)`${S} && ${d} <= ${p}`),e.pass(S);return}o.items=!0;const y=t.name("valid");p===void 0&&i===1?x(y,()=>t.if(y,()=>t.break())):i===0?(t.let(y,!0),p!==void 0&&t.if((0,je._)`${n}.length > 0`,w)):(t.let(y,!1),w()),e.result(y,()=>e.reset());function w(){const S=t.name("_valid"),v=t.let("count",0);x(S,()=>t.if(S,()=>_(v)))}function x(S,v){t.forRange("i",0,d,g=>{e.subschema({keyword:"contains",dataProp:g,dataPropType:jr.Type.Num,compositeRule:!0},S),v()})}function _(S){t.code((0,je._)`${S}++`),p===void 0?t.if((0,je._)`${S} >= ${i}`,()=>t.assign(y,!0).break()):(t.if((0,je._)`${S} > ${p}`,()=>t.assign(y,!1).break()),i===1?t.assign(y,!0):t.if((0,je._)`${S} >= ${i}`,()=>t.assign(y,!0)))}}};fn.default=nu;var Ci={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=K,r=ee,s=B;e.error={message:({params:{property:h,depsCount:l,deps:d}})=>{const y=l===1?"property":"properties";return(0,t.str)`must have ${y} ${d} when property ${h} is present`},params:({params:{property:h,depsCount:l,deps:d,missingProperty:y}})=>(0,t._)`{property: ${h},
    missingProperty: ${y},
    depsCount: ${l},
    deps: ${d}}`};const n={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(h){const[l,d]=o(h);i(h,l),p(h,d)}};function o({schema:h}){const l={},d={};for(const y in h){if(y==="__proto__")continue;const w=Array.isArray(h[y])?l:d;w[y]=h[y]}return[l,d]}function i(h,l=h.schema){const{gen:d,data:y,it:w}=h;if(Object.keys(l).length===0)return;const x=d.let("missing");for(const _ in l){const S=l[_];if(S.length===0)continue;const v=(0,s.propertyInData)(d,y,_,w.opts.ownProperties);h.setParams({property:_,depsCount:S.length,deps:S.join(", ")}),w.allErrors?d.if(v,()=>{for(const g of S)(0,s.checkReportMissingProp)(h,g)}):(d.if((0,t._)`${v} && (${(0,s.checkMissingProp)(h,S,x)})`),(0,s.reportMissingProp)(h,x),d.else())}}e.validatePropertyDeps=i;function p(h,l=h.schema){const{gen:d,data:y,keyword:w,it:x}=h,_=d.name("valid");for(const S in l)(0,r.alwaysValidSchema)(x,l[S])||(d.if((0,s.propertyInData)(d,y,S,x.opts.ownProperties),()=>{const v=h.subschema({keyword:w,schemaProp:S},_);h.mergeValidEvaluated(v,_)},()=>d.var(_,!0)),h.ok(_))}e.validateSchemaDeps=p,e.default=n})(Ci);var mn={};Object.defineProperty(mn,"__esModule",{value:!0});const Oi=K,ou=ee,iu={message:"property name must be valid",params:({params:e})=>(0,Oi._)`{propertyName: ${e.propertyName}}`},au={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:iu,code(e){const{gen:t,schema:r,data:s,it:n}=e;if((0,ou.alwaysValidSchema)(n,r))return;const o=t.name("valid");t.forIn("key",s,i=>{e.setParams({propertyName:i}),e.subschema({keyword:"propertyNames",data:i,dataTypes:["string"],propertyName:i,compositeRule:!0},o),t.if((0,Oi.not)(o),()=>{e.error(!0),n.allErrors||t.break()})}),e.ok(o)}};mn.default=au;var ss={};Object.defineProperty(ss,"__esModule",{value:!0});const Nr=B,Oe=K,cu=Ve,Cr=ee,lu={message:"must NOT have additional properties",params:({params:e})=>(0,Oe._)`{additionalProperty: ${e.additionalProperty}}`},pu={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:lu,code(e){const{gen:t,schema:r,parentSchema:s,data:n,errsCount:o,it:i}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:p,opts:h}=i;if(i.props=!0,h.removeAdditional!=="all"&&(0,Cr.alwaysValidSchema)(i,r))return;const l=(0,Nr.allSchemaProperties)(s.properties),d=(0,Nr.allSchemaProperties)(s.patternProperties);y(),e.ok((0,Oe._)`${o} === ${cu.default.errors}`);function y(){t.forIn("key",n,v=>{!l.length&&!d.length?_(v):t.if(w(v),()=>_(v))})}function w(v){let g;if(l.length>8){const E=(0,Cr.schemaRefOrVal)(i,s.properties,"properties");g=(0,Nr.isOwnProperty)(t,E,v)}else l.length?g=(0,Oe.or)(...l.map(E=>(0,Oe._)`${v} === ${E}`)):g=Oe.nil;return d.length&&(g=(0,Oe.or)(g,...d.map(E=>(0,Oe._)`${(0,Nr.usePattern)(e,E)}.test(${v})`))),(0,Oe.not)(g)}function x(v){t.code((0,Oe._)`delete ${n}[${v}]`)}function _(v){if(h.removeAdditional==="all"||h.removeAdditional&&r===!1){x(v);return}if(r===!1){e.setParams({additionalProperty:v}),e.error(),p||t.break();return}if(typeof r=="object"&&!(0,Cr.alwaysValidSchema)(i,r)){const g=t.name("valid");h.removeAdditional==="failing"?(S(v,g,!1),t.if((0,Oe.not)(g),()=>{e.reset(),x(v)})):(S(v,g),p||t.if((0,Oe.not)(g),()=>t.break()))}}function S(v,g,E){const T={keyword:"additionalProperties",dataProp:v,dataPropType:Cr.Type.Str};E===!1&&Object.assign(T,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(T,g)}}};ss.default=pu;var yn={};Object.defineProperty(yn,"__esModule",{value:!0});const uu=qe,po=B,ps=ee,uo=ss,du={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:s,data:n,it:o}=e;o.opts.removeAdditional==="all"&&s.additionalProperties===void 0&&uo.default.code(new uu.KeywordCxt(o,uo.default,"additionalProperties"));const i=(0,po.allSchemaProperties)(r);for(const y of i)o.definedProperties.add(y);o.opts.unevaluated&&i.length&&o.props!==!0&&(o.props=ps.mergeEvaluated.props(t,(0,ps.toHash)(i),o.props));const p=i.filter(y=>!(0,ps.alwaysValidSchema)(o,r[y]));if(p.length===0)return;const h=t.name("valid");for(const y of p)l(y)?d(y):(t.if((0,po.propertyInData)(t,n,y,o.opts.ownProperties)),d(y),o.allErrors||t.else().var(h,!0),t.endIf()),e.it.definedProperties.add(y),e.ok(h);function l(y){return o.opts.useDefaults&&!o.compositeRule&&r[y].default!==void 0}function d(y){e.subschema({keyword:"properties",schemaProp:y,dataProp:y},h)}}};yn.default=du;var gn={};Object.defineProperty(gn,"__esModule",{value:!0});const ho=B,Or=K,fo=ee,mo=ee,hu={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:s,parentSchema:n,it:o}=e,{opts:i}=o,p=(0,ho.allSchemaProperties)(r),h=p.filter(S=>(0,fo.alwaysValidSchema)(o,r[S]));if(p.length===0||h.length===p.length&&(!o.opts.unevaluated||o.props===!0))return;const l=i.strictSchema&&!i.allowMatchingProperties&&n.properties,d=t.name("valid");o.props!==!0&&!(o.props instanceof Or.Name)&&(o.props=(0,mo.evaluatedPropsToName)(t,o.props));const{props:y}=o;w();function w(){for(const S of p)l&&x(S),o.allErrors?_(S):(t.var(d,!0),_(S),t.if(d))}function x(S){for(const v in l)new RegExp(S).test(v)&&(0,fo.checkStrictMode)(o,`property ${v} matches pattern ${S} (use allowMatchingProperties)`)}function _(S){t.forIn("key",s,v=>{t.if((0,Or._)`${(0,ho.usePattern)(e,S)}.test(${v})`,()=>{const g=h.includes(S);g||e.subschema({keyword:"patternProperties",schemaProp:S,dataProp:v,dataPropType:mo.Type.Str},d),o.opts.unevaluated&&y!==!0?t.assign((0,Or._)`${y}[${v}]`,!0):!g&&!o.allErrors&&t.if((0,Or.not)(d),()=>t.break())})})}}};gn.default=hu;var wn={};Object.defineProperty(wn,"__esModule",{value:!0});const fu=ee,mu={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:s}=e;if((0,fu.alwaysValidSchema)(s,r)){e.fail();return}const n=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},n),e.failResult(n,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};wn.default=mu;var vn={};Object.defineProperty(vn,"__esModule",{value:!0});const yu=B,gu={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:yu.validateUnion,error:{message:"must match a schema in anyOf"}};vn.default=gu;var $n={};Object.defineProperty($n,"__esModule",{value:!0});const Lr=K,wu=ee,vu={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,Lr._)`{passingSchemas: ${e.passing}}`},$u={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:vu,code(e){const{gen:t,schema:r,parentSchema:s,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(n.opts.discriminator&&s.discriminator)return;const o=r,i=t.let("valid",!1),p=t.let("passing",null),h=t.name("_valid");e.setParams({passing:p}),t.block(l),e.result(i,()=>e.reset(),()=>e.error(!0));function l(){o.forEach((d,y)=>{let w;(0,wu.alwaysValidSchema)(n,d)?t.var(h,!0):w=e.subschema({keyword:"oneOf",schemaProp:y,compositeRule:!0},h),y>0&&t.if((0,Lr._)`${h} && ${i}`).assign(i,!1).assign(p,(0,Lr._)`[${p}, ${y}]`).else(),t.if(h,()=>{t.assign(i,!0),t.assign(p,y),w&&e.mergeEvaluated(w,Lr.Name)})})}}};$n.default=$u;var _n={};Object.defineProperty(_n,"__esModule",{value:!0});const _u=ee,bu={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const n=t.name("valid");r.forEach((o,i)=>{if((0,_u.alwaysValidSchema)(s,o))return;const p=e.subschema({keyword:"allOf",schemaProp:i},n);e.ok(n),e.mergeEvaluated(p)})}};_n.default=bu;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});const Gr=K,Ii=ee,Pu={message:({params:e})=>(0,Gr.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,Gr._)`{failingKeyword: ${e.ifClause}}`},Eu={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Pu,code(e){const{gen:t,parentSchema:r,it:s}=e;r.then===void 0&&r.else===void 0&&(0,Ii.checkStrictMode)(s,'"if" without "then" and "else" is ignored');const n=yo(s,"then"),o=yo(s,"else");if(!n&&!o)return;const i=t.let("valid",!0),p=t.name("_valid");if(h(),e.reset(),n&&o){const d=t.let("ifClause");e.setParams({ifClause:d}),t.if(p,l("then",d),l("else",d))}else n?t.if(p,l("then")):t.if((0,Gr.not)(p),l("else"));e.pass(i,()=>e.error(!0));function h(){const d=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},p);e.mergeEvaluated(d)}function l(d,y){return()=>{const w=e.subschema({keyword:d},p);t.assign(i,p),e.mergeValidEvaluated(w,i),y?t.assign(y,(0,Gr._)`${d}`):e.setParams({ifClause:d})}}}};function yo(e,t){const r=e.schema[t];return r!==void 0&&!(0,Ii.alwaysValidSchema)(e,r)}bn.default=Eu;var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});const Su=ee,ku={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){t.if===void 0&&(0,Su.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};Pn.default=ku;Object.defineProperty(un,"__esModule",{value:!0});const Tu=zt,xu=dn,Ru=Ht,ju=hn,Nu=fn,Cu=Ci,Ou=mn,Iu=ss,qu=yn,Au=gn,Du=wn,Mu=vn,Fu=$n,Uu=_n,Lu=bn,Wu=Pn;function zu(e=!1){const t=[Du.default,Mu.default,Fu.default,Uu.default,Lu.default,Wu.default,Ou.default,Iu.default,Cu.default,qu.default,Au.default];return e?t.push(xu.default,ju.default):t.push(Tu.default,Ru.default),t.push(Nu.default),t}un.default=zu;var En={},Sn={};Object.defineProperty(Sn,"__esModule",{value:!0});const pe=K,Hu={message:({schemaCode:e})=>(0,pe.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,pe._)`{format: ${e}}`},Vu={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Hu,code(e,t){const{gen:r,data:s,$data:n,schema:o,schemaCode:i,it:p}=e,{opts:h,errSchemaPath:l,schemaEnv:d,self:y}=p;if(!h.validateFormats)return;n?w():x();function w(){const _=r.scopeValue("formats",{ref:y.formats,code:h.code.formats}),S=r.const("fDef",(0,pe._)`${_}[${i}]`),v=r.let("fType"),g=r.let("format");r.if((0,pe._)`typeof ${S} == "object" && !(${S} instanceof RegExp)`,()=>r.assign(v,(0,pe._)`${S}.type || "string"`).assign(g,(0,pe._)`${S}.validate`),()=>r.assign(v,(0,pe._)`"string"`).assign(g,S)),e.fail$data((0,pe.or)(E(),T()));function E(){return h.strictSchema===!1?pe.nil:(0,pe._)`${i} && !${g}`}function T(){const C=d.$async?(0,pe._)`(${S}.async ? await ${g}(${s}) : ${g}(${s}))`:(0,pe._)`${g}(${s})`,q=(0,pe._)`(typeof ${g} == "function" ? ${C} : ${g}.test(${s}))`;return(0,pe._)`${g} && ${g} !== true && ${v} === ${t} && !${q}`}}function x(){const _=y.formats[o];if(!_){E();return}if(_===!0)return;const[S,v,g]=T(_);S===t&&e.pass(C());function E(){if(h.strictSchema===!1){y.logger.warn(q());return}throw new Error(q());function q(){return`unknown format "${o}" ignored in schema at path "${l}"`}}function T(q){const b=q instanceof RegExp?(0,pe.regexpCode)(q):h.code.formats?(0,pe._)`${h.code.formats}${(0,pe.getProperty)(o)}`:void 0,k=r.scopeValue("formats",{key:o,ref:q,code:b});return typeof q=="object"&&!(q instanceof RegExp)?[q.type||"string",q.validate,(0,pe._)`${k}.validate`]:["string",q,k]}function C(){if(typeof _=="object"&&!(_ instanceof RegExp)&&_.async){if(!d.$async)throw new Error("async format in sync schema");return(0,pe._)`await ${g}(${s})`}return typeof v=="function"?(0,pe._)`${g}(${s})`:(0,pe._)`${g}.test(${s})`}}}};Sn.default=Vu;Object.defineProperty(En,"__esModule",{value:!0});const Bu=Sn,Ku=[Bu.default];En.default=Ku;var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.contentVocabulary=Wt.metadataVocabulary=void 0;Wt.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Wt.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(Js,"__esModule",{value:!0});const Gu=Zs,Ju=Qs,Zu=un,Yu=En,go=Wt,Qu=[Gu.default,Ju.default,(0,Zu.default)(),Yu.default,go.metadataVocabulary,go.contentVocabulary];Js.default=Qu;var kn={},qi={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(qi);Object.defineProperty(kn,"__esModule",{value:!0});const At=K,Is=qi,wo=Ee,Xu=ee,ed={message:({params:{discrError:e,tagName:t}})=>e===Is.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>(0,At._)`{error: ${e}, tag: ${r}, tagValue: ${t}}`},td={keyword:"discriminator",type:"object",schemaType:"object",error:ed,code(e){const{gen:t,data:r,schema:s,parentSchema:n,it:o}=e,{oneOf:i}=n;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const p=s.propertyName;if(typeof p!="string")throw new Error("discriminator: requires propertyName");if(s.mapping)throw new Error("discriminator: mapping is not supported");if(!i)throw new Error("discriminator: requires oneOf keyword");const h=t.let("valid",!1),l=t.const("tag",(0,At._)`${r}${(0,At.getProperty)(p)}`);t.if((0,At._)`typeof ${l} == "string"`,()=>d(),()=>e.error(!1,{discrError:Is.DiscrError.Tag,tag:l,tagName:p})),e.ok(h);function d(){const x=w();t.if(!1);for(const _ in x)t.elseIf((0,At._)`${l} === ${_}`),t.assign(h,y(x[_]));t.else(),e.error(!1,{discrError:Is.DiscrError.Mapping,tag:l,tagName:p}),t.endIf()}function y(x){const _=t.name("valid"),S=e.subschema({keyword:"oneOf",schemaProp:x},_);return e.mergeEvaluated(S,At.Name),_}function w(){var x;const _={},S=g(n);let v=!0;for(let C=0;C<i.length;C++){let q=i[C];q!=null&&q.$ref&&!(0,Xu.schemaHasRulesButRef)(q,o.self.RULES)&&(q=wo.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,q==null?void 0:q.$ref),q instanceof wo.SchemaEnv&&(q=q.schema));const b=(x=q==null?void 0:q.properties)===null||x===void 0?void 0:x[p];if(typeof b!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${p}"`);v=v&&(S||g(q)),E(b,C)}if(!v)throw new Error(`discriminator: "${p}" must be required`);return _;function g({required:C}){return Array.isArray(C)&&C.includes(p)}function E(C,q){if(C.const)T(C.const,q);else if(C.enum)for(const b of C.enum)T(b,q);else throw new Error(`discriminator: "properties/${p}" must have "const" or "enum"`)}function T(C,q){if(typeof C!="string"||C in _)throw new Error(`discriminator: "${p}" values must be unique strings`);_[C]=q}}}};kn.default=td;const rd="http://json-schema.org/draft-07/schema#",sd="http://json-schema.org/draft-07/schema#",nd="Core schema meta-schema",od={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},id=["object","boolean"],ad={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},cd={$schema:rd,$id:sd,title:nd,definitions:od,type:id,properties:ad,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const r=ti,s=Js,n=kn,o=cd,i=["/properties"],p="http://json-schema.org/draft-07/schema";class h extends r.default{_addVocabularies(){super._addVocabularies(),s.default.forEach(_=>this.addVocabulary(_)),this.opts.discriminator&&this.addKeyword(n.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const _=this.opts.$data?this.$dataMetaSchema(o,i):o;this.addMetaSchema(_,p,!1),this.refs["http://json-schema.org/schema"]=p}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(p)?p:void 0)}}e.exports=t=h,Object.defineProperty(t,"__esModule",{value:!0}),t.default=h;var l=qe;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var d=K;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}});var y=_r;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return y.default}});var w=br;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return w.default}})})(xs,xs.exports);var ld=xs.exports;const pd=wc(ld),ud="http://json-schema.org/schema",dd="#/definitions/Blueprint",hd={Blueprint:{type:"object",properties:{landingPage:{type:"string",description:"The URL to navigate to after the blueprint has been run."},description:{type:"string",description:"Optional description. It doesn't do anything but is exposed as a courtesy to developers who may want to document which blueprint file does what."},preferredVersions:{type:"object",properties:{php:{anyOf:[{$ref:"#/definitions/SupportedPHPVersion"},{type:"string",const:"latest"}],description:"The preferred PHP version to use. If not specified, the latest supported version will be used"},wp:{type:"string",description:"The preferred WordPress version to use. If not specified, the latest supported version will be used"}},required:["php","wp"],additionalProperties:!1,description:"The preferred PHP and WordPress versions to use."},features:{type:"object",properties:{networking:{type:"boolean",description:"Should boot with support for network request via wp_safe_remote_get?"}},additionalProperties:!1},constants:{type:"object",additionalProperties:{type:"string"},description:"PHP Constants to define on every request",deprecated:"This experimental option will change without warning.\nUse `steps` instead."},plugins:{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/definitions/FileReference"}]},description:"WordPress plugins to install and activate",deprecated:"This experimental option will change without warning.\nUse `steps` instead."},siteOptions:{type:"object",additionalProperties:{type:"string"},properties:{blogname:{type:"string",description:"The site title"}},description:"WordPress site options to define",deprecated:"This experimental option will change without warning.\nUse `steps` instead."},login:{anyOf:[{type:"boolean"},{type:"object",properties:{username:{type:"string"},password:{type:"string"}},required:["username","password"],additionalProperties:!1}],description:"User to log in as. If true, logs the user in as admin/password."},phpExtensionBundles:{type:"array",items:{$ref:"#/definitions/SupportedPHPExtensionBundle"},description:"The PHP extensions to use."},steps:{type:"array",items:{anyOf:[{$ref:"#/definitions/StepDefinition"},{type:"string"},{not:{}},{type:"boolean",const:!1},{type:"null"}]},description:"The steps to run after every other operation in this Blueprint was executed."},$schema:{type:"string"}},additionalProperties:!1},SupportedPHPVersion:{type:"string",enum:["8.3","8.2","8.1","8.0","7.4","7.3","7.2","7.1","7.0"]},FileReference:{anyOf:[{$ref:"#/definitions/VFSReference"},{$ref:"#/definitions/LiteralReference"},{$ref:"#/definitions/CoreThemeReference"},{$ref:"#/definitions/CorePluginReference"},{$ref:"#/definitions/UrlReference"}]},VFSReference:{type:"object",properties:{resource:{type:"string",const:"vfs",description:"Identifies the file resource as Virtual File System (VFS)"},path:{type:"string",description:"The path to the file in the VFS"}},required:["resource","path"],additionalProperties:!1},LiteralReference:{type:"object",properties:{resource:{type:"string",const:"literal",description:"Identifies the file resource as a literal file"},name:{type:"string",description:"The name of the file"},contents:{anyOf:[{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"The contents of the file"}},required:["resource","name","contents"],additionalProperties:!1},CoreThemeReference:{type:"object",properties:{resource:{type:"string",const:"wordpress.org/themes",description:"Identifies the file resource as a WordPress Core theme"},slug:{type:"string",description:"The slug of the WordPress Core theme"}},required:["resource","slug"],additionalProperties:!1},CorePluginReference:{type:"object",properties:{resource:{type:"string",const:"wordpress.org/plugins",description:"Identifies the file resource as a WordPress Core plugin"},slug:{type:"string",description:"The slug of the WordPress Core plugin"}},required:["resource","slug"],additionalProperties:!1},UrlReference:{type:"object",properties:{resource:{type:"string",const:"url",description:"Identifies the file resource as a URL"},url:{type:"string",description:"The URL of the file"},caption:{type:"string",description:"Optional caption for displaying a progress message"}},required:["resource","url"],additionalProperties:!1},SupportedPHPExtensionBundle:{type:"string",const:"kitchen-sink"},StepDefinition:{type:"object",discriminator:{propertyName:"step"},required:["step"],oneOf:[{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"activatePlugin"},pluginPath:{type:"string",description:"Path to the plugin directory as absolute path (/wordpress/wp-content/plugins/plugin-name); or the plugin entry file relative to the plugins directory (plugin-name/plugin-name.php)."},pluginName:{type:"string",description:"Optional. Plugin name to display in the progress bar."}},required:["pluginPath","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"activateTheme"},themeFolderName:{type:"string",description:"The name of the theme folder inside wp-content/themes/"}},required:["step","themeFolderName"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"applyWordPressPatches"},siteUrl:{type:"string"},wordpressPath:{type:"string"},addPhpInfo:{type:"boolean"},patchSecrets:{type:"boolean"},disableSiteHealth:{type:"boolean"},disableWpNewBlogNotification:{type:"boolean"},makeEditorFrameControlled:{type:"boolean"},prepareForRunningInsideWebBrowser:{type:"boolean"},addFetchNetworkTransport:{type:"boolean"}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"cp"},fromPath:{type:"string",description:"Source path"},toPath:{type:"string",description:"Target path"}},required:["fromPath","step","toPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"defineWpConfigConsts"},consts:{type:"object",additionalProperties:{},description:"The constants to define"},virtualize:{type:"boolean",deprecated:`This option is noop and will be removed in a future version.
This option is only kept in here to avoid breaking Blueprint schema validation
for existing apps using this option.`}},required:["consts","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"defineSiteUrl"},siteUrl:{type:"string",description:"The URL"}},required:["siteUrl","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"importFile"},file:{$ref:"#/definitions/FileReference",description:"The file to import"}},required:["file","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"importWordPressFiles"},wordPressFilesZip:{$ref:"#/definitions/FileReference",description:"The zip file containing the top-level WordPress files and directories."},pathInZip:{type:"string",description:"The path inside the zip file where the WordPress files are."}},required:["step","wordPressFilesZip"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"installPlugin",description:"The step identifier."},pluginZipFile:{$ref:"#/definitions/FileReference",description:"The plugin zip file to install."},options:{$ref:"#/definitions/InstallPluginOptions",description:"Optional installation options."}},required:["pluginZipFile","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"installTheme",description:"The step identifier."},themeZipFile:{$ref:"#/definitions/FileReference",description:"The theme zip file to install."},options:{type:"object",properties:{activate:{type:"boolean",description:"Whether to activate the theme after installing it."}},additionalProperties:!1,description:"Optional installation options."}},required:["step","themeZipFile"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"login"},username:{type:"string",description:"The user to log in as. Defaults to 'admin'."},password:{type:"string",description:"The password to log in with. Defaults to 'password'."}},required:["step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"mkdir"},path:{type:"string",description:"The path of the directory you want to create"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"mv"},fromPath:{type:"string",description:"Source path"},toPath:{type:"string",description:"Target path"}},required:["fromPath","step","toPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"request"},request:{$ref:"#/definitions/PHPRequest",description:"Request details (See /wordpress-playground/api/universal/interface/PHPRequest)"}},required:["request","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"rm"},path:{type:"string",description:"The path to remove"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"rmdir"},path:{type:"string",description:"The path to remove"}},required:["path","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runPHP",description:"The step identifier."},code:{type:"string",description:"The PHP code to run."}},required:["code","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runPHPWithOptions"},options:{$ref:"#/definitions/PHPRunOptions",description:"Run options (See /wordpress-playground/api/universal/interface/PHPRunOptions)"}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runWpInstallationWizard"},options:{$ref:"#/definitions/WordPressInstallationOptions"}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"runSql",description:"The step identifier."},sql:{$ref:"#/definitions/FileReference",description:"The SQL to run. Each non-empty line must contain a valid SQL query."}},required:["sql","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"setPhpIniEntry"},key:{type:"string",description:'Entry name e.g. "display_errors"'},value:{type:"string",description:'Entry value as a string e.g. "1"'}},required:["key","step","value"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"setSiteOptions",description:'The name of the step. Must be "setSiteOptions".'},options:{type:"object",additionalProperties:{},description:"The options to set on the site."}},required:["options","step"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"unzip"},zipPath:{type:"string",description:"The zip file to extract"},extractToPath:{type:"string",description:"The path to extract the zip file to"}},required:["extractToPath","step","zipPath"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"updateUserMeta"},meta:{type:"object",additionalProperties:{},description:'An object of user meta values to set, e.g. { "first_name": "John" }'},userId:{type:"number",description:"User ID"}},required:["meta","step","userId"]},{type:"object",additionalProperties:!1,properties:{progress:{type:"object",properties:{weight:{type:"number"},caption:{type:"string"}},additionalProperties:!1},step:{type:"string",const:"writeFile"},path:{type:"string",description:"The path of the file to write to"},data:{anyOf:[{$ref:"#/definitions/FileReference"},{type:"string"},{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}],description:"The data to write"}},required:["data","path","step"]}]},InstallPluginOptions:{type:"object",properties:{activate:{type:"boolean",description:"Whether to activate the plugin after installing it."}},additionalProperties:!1},PHPRequest:{type:"object",properties:{method:{$ref:"#/definitions/HTTPMethod",description:"Request method. Default: `GET`."},url:{type:"string",description:"Request path or absolute URL."},headers:{$ref:"#/definitions/PHPRequestHeaders",description:"Request headers."},files:{type:"object",additionalProperties:{type:"object",properties:{size:{type:"number"},type:{type:"string"},lastModified:{type:"number"},name:{type:"string"},webkitRelativePath:{type:"string"}},required:["lastModified","name","size","type","webkitRelativePath"],additionalProperties:!1},description:"Uploaded files"},body:{type:"string",description:"Request body without the files."},formData:{type:"object",additionalProperties:{},description:"Form data. If set, the request body will be ignored and the content-type header will be set to `application/x-www-form-urlencoded`."}},required:["url"],additionalProperties:!1},HTTPMethod:{type:"string",enum:["GET","POST","HEAD","OPTIONS","PATCH","PUT","DELETE"]},PHPRequestHeaders:{type:"object",additionalProperties:{type:"string"}},PHPRunOptions:{type:"object",properties:{relativeUri:{type:"string",description:"Request path following the domain:port part."},scriptPath:{type:"string",description:"Path of the .php file to execute."},protocol:{type:"string",description:"Request protocol."},method:{$ref:"#/definitions/HTTPMethod",description:"Request method. Default: `GET`."},headers:{$ref:"#/definitions/PHPRequestHeaders",description:"Request headers."},body:{type:"string",description:"Request body without the files."},fileInfos:{type:"array",items:{$ref:"#/definitions/FileInfo"},description:"Uploaded files."},code:{type:"string",description:"The code snippet to eval instead of a php file."}},additionalProperties:!1},FileInfo:{type:"object",properties:{key:{type:"string"},name:{type:"string"},type:{type:"string"},data:{type:"object",properties:{BYTES_PER_ELEMENT:{type:"number"},buffer:{type:"object",properties:{byteLength:{type:"number"}},required:["byteLength"],additionalProperties:!1},byteLength:{type:"number"},byteOffset:{type:"number"},length:{type:"number"}},required:["BYTES_PER_ELEMENT","buffer","byteLength","byteOffset","length"],additionalProperties:{type:"number"}}},required:["key","name","type","data"],additionalProperties:!1},WordPressInstallationOptions:{type:"object",properties:{adminUsername:{type:"string"},adminPassword:{type:"string"}},additionalProperties:!1}},fd={$schema:ud,$ref:dd,definitions:hd};function md(e,{progress:t=new Xr,semaphore:r=new Ds({concurrency:3}),onStepCompleted:s=()=>{}}={}){var n,o,i;if(e={...e,steps:(e.steps||[]).filter($d)},e.constants&&e.steps.unshift({step:"defineWpConfigConsts",consts:e.constants}),e.siteOptions&&e.steps.unshift({step:"setSiteOptions",options:e.siteOptions}),e.plugins){const w=e.plugins.map(x=>typeof x=="string"?x.startsWith("https://")?{resource:"url",url:x}:{resource:"wordpress.org/plugins",slug:x}:x).map(x=>({step:"installPlugin",pluginZipFile:x}));e.steps.unshift(...w)}e.login&&e.steps.push({step:"login",...e.login===!0?{username:"admin",password:"password"}:e.login});const{valid:p,errors:h}=gd(e);if(!p){const w=new Error(`Invalid blueprint: ${h[0].message} at ${h[0].instancePath}`);throw w.errors=h,w}const l=e.steps||[],d=l.reduce((w,x)=>{var _;return w+(((_=x.progress)==null?void 0:_.weight)||1)},0),y=l.map(w=>_d(w,{semaphore:r,rootProgressTracker:t,totalProgressWeight:d}));return{versions:{php:wd((n=e.preferredVersions)==null?void 0:n.php,qo,Ka),wp:((o=e.preferredVersions)==null?void 0:o.wp)||"latest"},phpExtensions:vd([],e.phpExtensionBundles||[]),features:{networking:((i=e.features)==null?void 0:i.networking)??!1},run:async w=>{try{for(const{resources:x}of y)for(const _ of x)_.setPlayground(w),_.isAsync&&_.resolve();for(const{run:x,step:_}of y){const S=await x(w);s(S,_)}}finally{try{await w.goTo(e.landingPage||"/")}catch{}t.finish()}}}}const yd=new pd({discriminator:!0});let Ir;function gd(e){var t;Ir=yd.compile(fd);const r=Ir(e);if(r)return{valid:r};const s=new Set;for(const o of Ir.errors)o.schemaPath.startsWith("#/properties/steps/items/anyOf")||s.add(o.instancePath);const n=(t=Ir.errors)==null?void 0:t.filter(o=>!(o.schemaPath.startsWith("#/properties/steps/items/anyOf")&&s.has(o.instancePath)));return{valid:r,errors:n}}function wd(e,t,r){return e&&t.includes(e)?e:r}function vd(e,t){const r=Ao.filter(n=>e.includes(n)),s=t.flatMap(n=>n in Jn?Jn[n]:[]);return Array.from(new Set([...r,...s]))}function $d(e){return!!(typeof e=="object"&&e)}function _d(e,{semaphore:t,rootProgressTracker:r,totalProgressWeight:s}){var n;const o=r.stage((((n=e.progress)==null?void 0:n.weight)||1)/s),i={};for(const y of Object.keys(e)){let w=e[y];cc(w)&&(w=_t.create(w,{semaphore:t})),i[y]=w}const p=async y=>{var w;try{return o.fillSlowly(),await Ia[e.step](y,await bd(i),{tracker:o,initialCaption:(w=e.progress)==null?void 0:w.caption})}finally{o.finish()}},h=vo(i),l=vo(i).filter(y=>y.isAsync),d=1/(l.length+1);for(const y of l)y.progress=o.stage(d);return{run:p,step:e,resources:h}}function vo(e){const t=[];for(const r in e){const s=e[r];s instanceof _t&&t.push(s)}return t}async function bd(e){const t={};for(const r in e){const s=e[r];s instanceof _t?t[r]=await s.resolve():t[r]=s}return t}async function Pd(e,t){await e.run(t)}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ai=Symbol("Comlink.proxy"),Ed=Symbol("Comlink.endpoint"),Sd=Symbol("Comlink.releaseProxy"),us=Symbol("Comlink.finalizer"),Wr=Symbol("Comlink.thrown"),Di=e=>typeof e=="object"&&e!==null||typeof e=="function",kd={canHandle:e=>Di(e)&&e[Ai],serialize(e){const{port1:t,port2:r}=new MessageChannel;return Tn(e,t),[r,[r]]},deserialize(e){return e.start(),xn(e)}},Td={canHandle:e=>Di(e)&&Wr in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},yr=new Map([["proxy",kd],["throw",Td]]);function xd(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function Tn(e,t=globalThis,r=["*"]){t.addEventListener("message",function s(n){if(!n||!n.data)return;if(!xd(r,n.origin)){console.warn(`Invalid origin '${n.origin}' for comlink proxy`);return}const{id:o,type:i,path:p}=Object.assign({path:[]},n.data),h=(n.data.argumentList||[]).map(yt);let l;try{const d=p.slice(0,-1).reduce((w,x)=>w[x],e),y=p.reduce((w,x)=>w[x],e);switch(i){case"GET":l=y;break;case"SET":d[p.slice(-1)[0]]=yt(n.data.value),l=!0;break;case"APPLY":l=y.apply(d,h);break;case"CONSTRUCT":{const w=new y(...h);l=Li(w)}break;case"ENDPOINT":{const{port1:w,port2:x}=new MessageChannel;Tn(e,x),l=Od(w,[w])}break;case"RELEASE":l=void 0;break;default:return}}catch(d){l={value:d,[Wr]:0}}Promise.resolve(l).catch(d=>({value:d,[Wr]:0})).then(d=>{const[y,w]=Yr(d);t.postMessage(Object.assign(Object.assign({},y),{id:o}),w),i==="RELEASE"&&(t.removeEventListener("message",s),Mi(t),us in e&&typeof e[us]=="function"&&e[us]())}).catch(d=>{const[y,w]=Yr({value:new TypeError("Unserializable return value"),[Wr]:0});t.postMessage(Object.assign(Object.assign({},y),{id:o}),w)})}),t.start&&t.start()}function Rd(e){return e.constructor.name==="MessagePort"}function Mi(e){Rd(e)&&e.close()}function xn(e,t){return qs(e,[],t)}function qr(e){if(e)throw new Error("Proxy has been released and is not useable")}function Fi(e){return Dt(e,{type:"RELEASE"}).then(()=>{Mi(e)})}const Jr=new WeakMap,Zr="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(Jr.get(e)||0)-1;Jr.set(e,t),t===0&&Fi(e)});function jd(e,t){const r=(Jr.get(t)||0)+1;Jr.set(t,r),Zr&&Zr.register(e,t,e)}function Nd(e){Zr&&Zr.unregister(e)}function qs(e,t=[],r=function(){}){let s=!1;const n=new Proxy(r,{get(o,i){if(qr(s),i===Sd)return()=>{Nd(n),Fi(e),s=!0};if(i==="then"){if(t.length===0)return{then:()=>n};const p=Dt(e,{type:"GET",path:t.map(h=>h.toString())}).then(yt);return p.then.bind(p)}return qs(e,[...t,i])},set(o,i,p){qr(s);const[h,l]=Yr(p);return Dt(e,{type:"SET",path:[...t,i].map(d=>d.toString()),value:h},l).then(yt)},apply(o,i,p){qr(s);const h=t[t.length-1];if(h===Ed)return Dt(e,{type:"ENDPOINT"}).then(yt);if(h==="bind")return qs(e,t.slice(0,-1));const[l,d]=$o(p);return Dt(e,{type:"APPLY",path:t.map(y=>y.toString()),argumentList:l},d).then(yt)},construct(o,i){qr(s);const[p,h]=$o(i);return Dt(e,{type:"CONSTRUCT",path:t.map(l=>l.toString()),argumentList:p},h).then(yt)}});return jd(n,e),n}function Cd(e){return Array.prototype.concat.apply([],e)}function $o(e){const t=e.map(Yr);return[t.map(r=>r[0]),Cd(t.map(r=>r[1]))]}const Ui=new WeakMap;function Od(e,t){return Ui.set(e,t),e}function Li(e){return Object.assign(e,{[Ai]:!0})}function Id(e,t=globalThis,r="*"){return{postMessage:(s,n)=>e.postMessage(s,r,n),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function Yr(e){for(const[t,r]of yr)if(r.canHandle(e)){const[s,n]=r.serialize(e);return[{type:"HANDLER",name:t,value:s},n]}return[{type:"RAW",value:e},Ui.get(e)||[]]}function yt(e){switch(e.type){case"HANDLER":return yr.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Dt(e,t,r){return new Promise(s=>{const n=qd();e.addEventListener("message",function o(i){!i.data||!i.data.id||i.data.id!==n||(e.removeEventListener("message",o),s(i.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:n},t),r)})}function qd(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function Ad(e){Md();const t=e instanceof Worker?e:Id(e),r=xn(t),s=Wi(r);return new Proxy(s,{get:(n,o)=>o==="isConnected"?async()=>{for(let i=0;i<10;i++)try{await Dd(r.isConnected(),200);break}catch{}}:r[o]})}async function Dd(e,t){return new Promise((r,s)=>{setTimeout(s,t),e.then(r)})}let _o=!1;function Md(){_o||(_o=!0,yr.set("EVENT",{canHandle:e=>e instanceof CustomEvent,serialize:e=>[{detail:e.detail},[]],deserialize:e=>e}),yr.set("FUNCTION",{canHandle:e=>typeof e=="function",serialize(e){console.debug("[Comlink][Performance] Proxying a function");const{port1:t,port2:r}=new MessageChannel;return Tn(e,t),[r,[r]]},deserialize(e){return e.start(),xn(e)}}),yr.set("PHPResponse",{canHandle:e=>typeof e=="object"&&e!==null&&"headers"in e&&"bytes"in e&&"errors"in e&&"exitCode"in e&&"httpStatusCode"in e,serialize(e){return[e.toRawData(),[]]},deserialize(e){return wt.fromRawData(e)}}))}function Wi(e){return new Proxy(e,{get(t,r){switch(typeof t[r]){case"function":return(...s)=>t[r](...s);case"object":return t[r]===null?t[r]:Wi(t[r]);case"undefined":case"number":case"string":return t[r];default:return Li(t[r])}}})}async function Fd({iframe:e,blueprint:t,remoteUrl:r,progressTracker:s=new Xr,disableProgressBar:n,onBlueprintStepCompleted:o}){if(Ld(r),Ud(e),r=Po(r,{progressbar:!n}),s.setCaption("Preparing WordPress"),!t)return bo(e,r,s);const i=md(t,{progress:s.stage(.5),onStepCompleted:o}),p=await bo(e,Po(r,{php:i.versions.php,wp:i.versions.wp,"php-extension":i.phpExtensions,networking:i.features.networking?"yes":"no"}),s);return await Pd(i,p),s.finish(),p}function Ud(e){var t,r;(t=e.sandbox)!=null&&t.length&&!((r=e.sandbox)!=null&&r.contains("allow-storage-access-by-user-activation"))&&e.sandbox.add("allow-storage-access-by-user-activation")}async function bo(e,t,r){await new Promise(o=>{e.src=t,e.addEventListener("load",o,!1)});const s=Ad(e.contentWindow);await s.isConnected(),r.pipe(s);const n=r.stage();return await s.onDownloadProgress(n.loadingListener),await s.isReady(),n.finish(),s}const zr="https://playground.wordpress.net";function Ld(e){const t=new URL(e,zr);if((t.origin===zr||t.hostname==="localhost")&&t.pathname!=="/remote.html")throw new Error(`Invalid remote URL: ${t}. Expected origin to be ${zr}/remote.html.`)}function Po(e,t){const r=new URL(e,zr),s=new URLSearchParams(r.search);for(const[n,o]of Object.entries(t))if(o!=null&&o!==!1)if(Array.isArray(o))for(const i of o)s.append(n,i.toString());else s.set(n,o.toString());return r.search=s.toString(),r.toString()}async function Wd(){const e=document.getElementById("root"),t=zd(e),s=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"'dark'":"'light'";await Fd({iframe:t,remoteUrl:"https://playground.wordpress.net/remote.html",blueprint:{landingPage:"/wp-admin/",preferredVersions:{php:"8.0",wp:"latest"},steps:[{step:"runPHP",code:`<?php require_once 'wordpress/wp-load.php'; update_option('fbwpmdp_theme', ${s}); ?>`},{step:"login",username:"admin",password:"password"},{step:"setSiteOptions",options:{WPLANG:"en",permalink_structure:"/%postname%/",gp_enable_local_translation:1,gp_enable_inline_translation:1}},{step:"updateUserMeta",meta:{show_welcome_panel:"1"},userId:1},{step:"installPlugin",pluginZipFile:{resource:"wordpress.org/plugins",slug:"material-board"}}]}})}function zd(e){const t=document.createElement("iframe");return t.title="Playground Viewport",t.className="playground__viewport--full-size",e.appendChild(t),t}Wd();
